function [Y,Xf,Af] = A40Neurons(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 12-Oct-2021 14:57:47.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx24 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx2 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [2.66321855609173;2.74985179914428;2.90256983703407;2.82119689217171;2.68015066236893;2.90783031771663;2.85686946545909;2.61603882173689;2.65943760086955;2.75116688466153;2.90314358396553;2.82251201279689;2.68015066236703;2.90898104528141;2.85752703121433;2.61653198815731;2.65938281487866;2.75083813638492;2.90289862171026;2.82185445404069;2.67998627296978;2.91111810772591;2.85785580597347;2.61620321486751];
x1_step1.gain = [5.9683402975771;6.33986345808424;5.93977885190939;5.02527002710446;4.36377240311537;5.11350543560938;4.75241041376776;5.26220346787397;6.0248093522835;6.40663337031236;6.64366733631633;5.16321939855403;4.3637724074627;5.12043898736177;4.59659887473612;4.69640964371606;4.9610734697665;5.44735749948121;5.3571848594542;4.5227053649356;4.06352525425561;4.71008909952287;4.253904020963;4.57064308262488];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.91350255310631589545;-2.9485651750419186179;6.5184637047782922892;5.7069110792430119972;15.047647642962537873;-32.539377161775817626;-6.5186279309885524214;-9.0946566313224010969;1.2896139352063422656;2.1533168500965231829;-13.570824772851329598;-1.7023161792685994609;-28.473614080395673653;-10.422918040494929315;21.755881464950853399;29.315111616922649773;2.4961401582376634423;-0.74997622234779326433;-4.7550218896452696171;-1.9063417205580646119;-14.340041710514961792;0.48900724800243822177;-0.27653301549518305436;-23.562324426685158585;-7.288560036982699053;8.4210681382347889468;4.3755023357681528395;-3.5687096436445719938;17.175726846947107163;-6.5029309446839365094;7.7653672138011344828;-10.896868085092977552;-21.799943490238426591;-0.52934797808885125647;-12.247820662038257922;1.2584890799911852;-41.145888585633592527;0.47801427703832538585;-0.46365061487846759292;16.159208165393042833];
IW1_1 = [3.8045879743274175766 -2.3433452175011320051 0.76787058818573905583 1.3323574979273220542 0.11695995416691318258 2.0026493544339336594 -44.928416308140832314 -32.889997312815999919 1.4540166652871062691 2.8113566257069626531 0.1944267305427551662 2.3603673953904360516 3.0890127828475422156 -1.9909299978813868037 64.797706721078426995 103.63526909787509567 -6.1236511926632886116 -0.59577046319046056411 -0.58155009112321276454 -3.7349366498570781836 -3.5768461368227866259 0.40843912862657044682 -19.349148376279618589 -70.713089231063676721;86.272857414130257325 -40.372801719820024857 -55.58234703726454029 -92.156685276118480488 60.734382675327061918 33.979364791100344689 -12.866429404263037384 13.560037249873875709 -52.87659076430306726 56.309483492662174342 59.604117742913821587 36.769752634141489978 -5.9197136654168458492 -17.152741705254666016 -26.735803998852926355 6.8137278264382388215 -20.485802983465035254 -3.6843539857025513484 -10.092337041210093673 18.88928808854429775 -30.211806747604999401 -1.3577446278313713979 36.630402842018689569 -1.8400002475691854542;6.1520005787782672257 -20.179253696222538395 36.715743487609671547 -29.259953914884551551 -20.019176856227286265 -36.531706456414887896 -19.280818165085019444 -40.763769678448319667 8.4027211100311074432 77.453778231853320335 -9.4550564618928305549 15.029958629700795214 -1.2219595724819523053 -58.409669620784335109 -18.0844984856001183 10.426678796659210491 64.367537951915323902 -0.94173940801800615219 30.03169173161715122 4.8159815449778058394 21.917589805897115696 30.814887720770514079 38.687816746426776149 10.236140186764011162;-2.4083101372604467372 0.54628597685708246701 -1.3055184865156825857 0.60307566118844690983 23.549553803917376626 1.7588340099329078381 -6.9559163294992867321 0.6974900655428688534 5.2894110932997344676 -0.3063614069955481467 1.8094801715627437666 -0.79782040314965119165 -79.21488852054552865 -7.2127838855657628869 4.8373185679331207609 -4.9395079931905252479 -2.9622613484840201181 -0.4195612182673866819 -0.47106051977777751993 -0.40550519469753182333 61.44036756053938575 5.5734954037007149452 2.5862922823566276698 4.640509870175970164;35.424008837484421974 -25.175680402085607312 -0.48978053004151855809 6.2563718995385109167 84.233112892763458035 12.256918432702383015 8.7929428271834364494 -6.4470664371056205511 -66.570067491246902591 25.261479702811854509 4.1783084415127174083 -9.5198557799250647093 -210.08325129977100687 -20.42140015082640403 -24.580303788833251843 -19.358894493853629371 38.024651091123757851 -4.5234714357497516346 1.6290024081053937621 2.670415534964883264 144.96686855766046165 3.9712095677639824842 18.141557144940151147 28.300296235463715533;-39.612820449815338009 -20.660478004554931886 5.7131283684593769934 -45.486621173573269061 -5.1393930521237738418 58.724283425010249005 -28.257751749845553491 -55.982238508694599943 54.724477149099790552 25.920668377990399023 6.3026993206669850167 68.108435386037271542 -55.115387039912008049 -7.3843785846777265647 17.264678895846543583 4.2284232067209961414 -41.360898946287093736 -26.718697924195137006 -38.021037913984898182 -5.2552806856939930924 31.179674296492244423 -33.450999387117519746 -22.264032793997934334 12.70347190615132682;85.423532581453002877 -11.784556738001626286 21.029256261918781945 -5.0470659263095214442 80.551168319718755129 -7.638985964625773839 -1.7111476736249824349 2.0996599968761544552 -50.113055598370046084 15.099604105824601774 -27.112201726422625825 16.956121613184539143 -62.494838690080776189 43.568281340702156967 -26.136239818888640229 45.608018712836752684 -29.154720343016361284 -16.030304762496861315 23.280676857934825108 -17.913758828419510394 7.1434287429059741825 -27.537809553373737259 14.011388377671897487 -69.112927279814343251;-31.227779430231379365 18.335212154481396851 -22.167800726177915749 -44.037807021897627635 -27.413445196128989778 20.730305820010485718 -11.852930687553820732 -26.602248455121749515 41.060390117844825397 12.376092010861412973 19.430134713888570275 19.144990664853999363 -29.689520657873607945 -51.646917480823063329 -62.449506741761148021 48.529687919240785732 -23.26132529789020964 -28.768287087270529412 13.522861372310849504 32.677987011486678171 43.758094591764468362 25.766641730615745587 62.919223273129091467 -31.564013996844881405;46.130282237675920953 -1.2104593128276814884 2.6473674266870554916 -1.7491748941929012862 5.6933618080310175458 1.3342692972374319282 -0.66721483144815219024 -1.3012108380544837871 -46.546137445551892142 -0.52447988043023219262 -3.3376021850295685134 4.7699893791330332249 -7.9848038439840873792 -1.348043181464847029 2.2628398380695493586 4.5723810432111218205 0.83380945821545571217 2.1313118770042289718 1.1821655594264108835 -3.7080905142649669415 2.5466089721904103804 -0.16207695214742273704 -1.7346665703058428143 -3.361162496356466356;-5.9079229885885915508 -5.6575152748057071506 6.6476172695237503163 6.7030195474927163346 -14.289379868413291774 -18.688097041883036553 -18.203273450272515532 -16.09256285473754744 3.7447917616109918093 -3.979298974298110636 -13.172044468871360934 -5.2447330509629415118 11.817541218445558826 18.860880768604459945 -32.815800061763134465 25.276897508295757433 -1.423678594069831771 14.32064824998330721 1.6079734632645374948 -0.62439984961950290021 7.0799668809898408384 -5.751854133759993104 60.965573589208560179 -11.368679694503876831;44.092816410528712368 4.4397856814544249815 71.764562616037210319 -11.241663823607888517 2.0138574977927845566 35.543838558527340865 -11.18581848178618543 23.638418336321592506 15.205958714303690726 -10.859408495817511664 -37.572583527525821978 15.927988509743352452 37.061927753235259786 -41.704495606894788295 9.6896203929519550968 11.581842040533361526 -61.220910513165357258 -5.3775672610863729517 -25.342928329497670603 -15.954331272307749501 -20.127084586975914959 3.9730645132461281932 -2.2911308374779588704 -38.141379553030439808;17.826462751564651654 0.21628639681963413022 2.4790178914522527087 3.2350992695169873414 2.7865522353019338553 3.0535057486359677981 -42.306798746221197405 -26.804112423018334965 -3.6290118984810941782 -0.75288425594863683799 -1.7803919802952652418 -0.86610889592414053162 -3.5943650882025361959 -2.2868657941073573525 63.605459398832422835 95.061022242580961006 -16.725470882992333088 0.16548347432026730419 -0.48014143192914027214 -1.8549261131930836477 0.88778681915077151121 -0.97444105894692945036 -21.418041400815489794 -69.134774742878263964;-1.8643784795713227442 4.6429924190845897058 2.3473849266453243878 0.38621080903188409472 -4.3820293709605309118 4.2834156765423569979 -18.783839871986046433 311.92110268982708021 3.5448228336071032629 -5.5658158644016957339 -1.98269029843227651 -0.18028783226888345226 5.6227941543691812853 -8.4638743786582075757 5.8464887049575686717 -520.81175426623974545 -2.1824421167168805979 1.1650578298497933361 -0.047851933477222552415 -0.021237283947427992858 -2.0233745123396853494 4.7218902601068224456 15.895250850505757256 176.35625672099803296;-3.2866513218424984188 -0.75090244625756241703 14.34681887918848453 -7.8776944094923013751 -17.259379980529438114 -8.6843111196281874697 18.115293587860094249 -44.874310028902421266 21.480880313221504707 -8.5515884880730919093 -5.9731586936050709014 -5.8187932562600312991 19.859275893198812923 23.624520387388919573 -45.290942009891864473 91.374657889458021032 -34.032315001792966314 11.202549846645400322 -14.805844311986987805 13.796542320756522315 -30.865392935507223626 -15.991587159218203951 23.011276854224597344 -52.28382195408555333;35.966146331931348357 16.648023936872146322 10.60300368972328755 18.06429398574956835 8.6486195156135945439 84.365725139422707457 16.160085641193855821 -60.385530788814918424 -25.812399885857285398 -94.179422875742119459 -89.85486755946142523 -34.754677101973058484 13.059823106415258565 19.878828300572230603 5.2068517896482999774 60.097654971356895715 -40.705732263797948178 9.4168912810202911601 -40.920589175492580125 4.2741504467972655235 24.428794756898394525 22.720438135131910684 -6.4346615034733485317 28.252527004985612535;100.67398386407056421 -1.1262694247770788092 18.104743902237128594 -35.959393378191357726 10.284823853228267865 4.8972057782461355657 0.20896685277027338135 6.0348229575713485673 -185.70078274929150552 -0.41116747188073310415 -29.937876845905858403 43.707186552132853308 -25.265927200708837574 -10.340808416554640559 -1.6687576571787712254 -26.32487588289674818 105.90051282148002088 1.3549396843096763732 16.340106256450422251 -9.8673063715573317012 17.219631001719776009 5.5089598663977144 1.4966578830734658112 22.192280302673779602;9.0177918740543425713 -52.924770819371325103 -17.866209497139671214 -25.020962376616971312 -38.838172919787638193 11.651746961990614437 0.64997352977497291349 11.871951049518642662 -28.762328446339974874 36.96006920065713075 11.020771795306799845 12.830713293166498445 68.495640438634950442 -19.334525226805435949 20.25537403779346235 -22.625899440695246057 25.922304367608660414 10.336987263835879958 2.9954508796605430199 13.734409866602902639 -23.337320247287131281 28.518834154693447402 -18.794833729256097854 17.822090463959909812;-0.14402797105842035652 -0.51711534022375360564 0.094569726549993293752 0.59792949261405337058 -2.4609778695896933343 -3.6919346894451474661 -1.7081327621713211506 -0.62927018301530657229 1.5593514993240673583 1.2166660388838026474 0.015750525907218398958 -0.3200772902580839574 -23.310818227756563203 9.1366167421391715209 5.9085423874658786758 5.4219175830912789138 -1.2884229664770052715 -0.49753401671704106102 -0.1748935908826992347 -0.21068700495160208597 28.747419901081251226 -6.2452948277070392535 -4.8453473839971872295 -5.1436029068670832132;14.30070714526021014 -5.2740757067427619376 -9.7843688871843568222 -10.084949944456168325 26.100954892634753435 -13.396740875861446796 0.26551131927987525749 28.081973832399306445 6.5781205497598094212 9.9893352661885757016 7.247508043323838578 12.884334177631650675 -61.304537266183018573 37.287541625693876313 9.0244942579709466202 -85.888349537498754671 -19.439691556033295683 1.9886034867832043105 -1.8340120583441490432 -4.6751699186457624791 35.331487441981778375 -26.675067994799547932 2.9086120685044201117 50.418555988157116587;-44.88652061690073225 -0.38635222679419689573 -1.4529619477159350094 -2.2595054261464078138 -6.0044575004955191844 -1.8755448018776343933 0.90098619721135164706 0.66668851559875130786 41.181709764704429233 2.0624190555763721733 1.0375538031461815081 3.4243800210091368541 8.7086492005768558755 1.6021750545074475713 -3.0160369025172015789 -1.5509389137423919003 4.1721651098021608206 -1.9953448552118380199 0.42162387770789855335 -1.5821997084912857723 -2.9841478228410345253 0.30126860645943970285 2.0178790159999238085 1.0328583753640339093;17.339342043056280573 -21.5399066079776631 -87.202245025159669467 2.95523817534704758 -48.035440352632633676 15.131975008332245736 10.228457082418646706 6.4769869813751181908 -4.3140008506727838267 21.092929358613073276 83.459051175566756342 -9.6275621235147497146 89.441840893798712386 19.877473284453095914 -4.3335405682206262767 -26.014326389721848187 -14.549836657688064889 -1.2625210998770151072 -13.589674530522854567 6.2403048492068240449 -43.25979734059438897 -19.253426931823629076 -5.4777675809246098027 26.76941173775188787;-1.1033604980948599206 5.8134541123435496957 3.4104815704550266453 -69.132761989483071829 0.24866535729259109377 0.77091972755251769733 2.5415364158709379261 0.22590573051561152473 -2.5670056550437241327 -8.4643666574576883477 0.99823383110024932474 74.399023333529427759 -2.8865378673804671372 -2.1340542027903461886 -5.2088928157087774906 -2.8626185753982325011 4.3725944252568753612 2.2955092074414435999 -5.8789119211104274854 -5.7456575880827962521 3.3235622980425185702 1.478965455116648009 2.8765310309122886778 2.8814121595643813478;-2.2452694403028261583 0.016993233002764590589 1.325265734261622308 0.97434900843395066961 -100.15869323863672946 3.8399482800619759715 0.21087213286375974808 -0.91508575165791183892 -5.0564549021252940264 0.036583067089969001362 -1.1353655988446385017 -2.3136260114434894497 153.08599538527423078 -7.8045840136673936271 -0.20533255198283140164 -1.1170528578022675958 8.999823185716207874 0.08772303664810376933 0.19741318519844580637 1.2809534426294151288 -56.820074589354319983 4.2614748649264644342 -0.19903656631079280626 2.5605900517198909583;-9.564004518884402728 -11.75607301989675868 -125.34589315488469197 -35.555582094095520063 62.578383384893747632 50.267751703577630451 -5.3027515565931437891 34.112084211745539619 55.622158989241512472 19.571683240627557154 109.02004238850695117 54.82067527255308903 -98.812721388175603465 -65.149102646735173039 -3.8363206940609506646 -113.47419232982801418 -64.243268965137886539 -16.625316157555683816 11.737625480073678119 -29.116334610335876221 36.425160390365100227 7.2830921237471093477 1.4999921669925000423 83.859400827256507682;0.078246051753273704321 -1.097921569832168931 6.3403194049583460057 -17.250658938350081684 -46.106873591656565736 3.3083930256954299232 -55.62661106982346837 -1.1474840761267486311 -2.9318580651799734937 4.9111442512746403821 -1.664582646640828667 0.2912585063258901763 68.404520874747390735 -13.310334940163881967 146.6526554569389873 10.665088336192191321 1.395156879691065388 -1.9027171615623397205 -3.5950527246057912834 18.40382529469311379 -23.611037215905980702 11.825467649621408839 -98.567189548739364113 -10.393361232056705035;19.758303228712964739 60.771442454113660858 -66.242600714245853055 -8.9286645589576973947 -51.332752908819074378 3.8267389550350277005 23.070790759889291621 39.384417365166477509 -33.111647575578047054 -119.99031679080384549 55.388263139086575393 37.888497593567720401 115.60474417901835409 6.273176705126831898 -14.41532067095479519 -66.358156788832403095 27.498573398743921814 52.457340646977947074 1.4491636468974582463 -21.749268874878929125 -70.053499346917490698 -5.5007429816400863487 15.070974507616080373 32.187277992671383231;-2.5435097802322523819 2.5227921494702192362 -79.608596362011581959 250.10990338903857833 -0.58264720539866876603 0.34263760137525051119 0.67454231203955106189 -1.5371076602689002222 3.0854544930604079767 -2.453653832073733998 109.27920525855358846 -383.18572000861962579 5.3744926335461506994 -1.0935477684757994865 0.902388712329604048 10.496052262110254105 -0.3294176101210062324 -0.89635178302261031558 -47.62755573072084303 159.69063170839118015 -4.5338746596819161638 0.87405229010291518588 -1.6967233813882400817 -9.4149230499071894229;-9.0150453934371128639 -0.55516332642992050062 -1.4761852376904238682 1.2757905860828917533 -134.5672338642199577 5.3639974953779470113 -0.62387962293119270107 2.5298660633265770414 4.0064512698836232119 0.61644710897422250184 1.5819356482090833893 -2.2192578053877207722 198.83356884550772747 -17.09921657472621348 1.9926260897479937118 -1.2535160285944739744 6.3368735185918199093 -0.17888826832030924052 -0.15510953000522978429 0.70917860832164403284 -69.146753130025089717 13.298498936212268973 -1.6067534712039310829 -1.8809146761718120722;-1.5181472986078152765 0.51082298397065317719 -14.25765040089675928 172.00544288384213587 3.179732193040199828 0.49295005263820601549 2.0519743767183848959 0.81375732566998915107 0.69345039747693526522 -1.0339631136558402602 9.2186804298555760084 -255.38404670396778329 -2.5225843382731580888 -0.77017931026600083833 -3.4893665119659802443 -4.3361507314217844211 1.0025343496779342001 1.0088222403730877641 4.5851100509819229245 100.80021718066491587 -0.95488166439556154685 0.3462352255606867546 1.593579852132348762 3.463886211011119709;-11.737477372721778934 -25.24844314657166322 36.462269505749716814 -52.531186178072616144 -2.548068292529757084 21.231889229036497113 0.79056485421104749634 -12.525137692994231742 40.815832041517211337 6.194063468021563601 -29.139564206051431938 53.017838048510135707 -53.504032419651004204 1.6555476314893473599 70.09603633465273731 22.293326209511103997 -39.095592138041865837 10.416995131751848547 -19.410543988968370854 24.196882294138617908 50.578806123295805719 -12.066998822168743644 -78.138507314534180637 -18.939974782939160036;26.125016034672512433 -0.50293349212117188785 32.698092779823518583 5.3148454723777014408 -16.525016073164195518 -0.58599032450179611153 -23.084242613710742376 63.738178074507949589 -32.845715559393930505 3.1261301117841115982 -27.785514782869888961 -7.7860723543338510311 -16.097372674663617431 3.2343597944276427647 53.072309206097607159 -269.7335662790923152 7.4001509221027861329 -0.35959543292428153283 -1.5407678718765784875 1.56305107877699756 34.680984029626806375 -4.7976819962952363952 -32.344971556739274376 208.72469844152965379;40.892385746212703168 -2.2728480373946835513 16.906976676536409343 -76.73905605724873169 7.3132344924044279111 0.98664091049786062371 -33.700350455809427785 32.388670027911274474 -24.193251347049230304 26.712931531479576108 -7.9759281579268588303 76.248032843706056383 16.538876719413437399 -39.604979859444512158 -2.7258116400549434744 -74.53140227924954786 -12.581093809604361411 -7.8624503601934501162 -18.339880180264668041 5.2034946254316709613 -4.7616653842497118632 27.198858236927954124 1.8168575524575500957 52.024970371931544832;-0.48055378920341318416 0.57124770602364582928 1.0846183390108734557 1.526471287343170502 -4.7234416533404193217 2.4198604791817412973 -2.4821963640848498933 193.25707801086861082 2.2435854032141331338 -0.11815486725635634957 -1.174394130700174621 -1.6682234361946677303 -21.392197982927566358 -1.8722845074664871134 14.963341404649034061 -347.16912044045739094 -1.8396207241189534987 -0.50257182085816365369 0.052537878227932668929 -0.098685090136503894609 29.193611179784660692 -0.10803911673934524229 -14.541691706474868084 134.51970148697947138;-74.089788002422110935 1.1595187744623647319 39.279709311602815092 -2.2822009708828452368 13.465897929534342836 28.382098339185301228 -26.871560228745732246 2.7856343252459185855 73.332689105204863722 -0.006595231802508649821 -61.94911052642756033 21.090880837479971888 31.813488907812523365 -22.250446868317865778 34.689877273420513859 -29.879182866666340601 4.3863008018010551936 -18.694444753811431781 -3.8127235137142529986 -15.927764420491483222 -50.719249013575669949 -2.8950174575389042708 -8.3536511444337300247 33.480488448710417515;13.237647669462052846 -203.95203822263044913 8.6389693026378253649 6.8413469467095762155 8.232151719618283181 1.8528789208111442477 1.6329936620344294163 -13.730223654652533583 -57.046906791218745525 278.59401980608686245 18.548852586240798246 -2.2135409609475638071 -7.7118789027045222539 -6.2841748571311031313 -2.0883619657817540372 28.038764526247362596 52.097682111065068966 -89.55304182879893915 -34.198690668576595897 -6.3863652839844595732 1.0659565672115094426 3.9788219758130756176 -0.15085013954085907395 -13.075964188211466777;-7.2907790200022475346 2.4288125698810931752 10.159170445964701202 68.363906862316440538 -9.5889262178875256382 0.75604658669193769427 -4.0899875532125733457 0.32858254700246458668 3.9860776204735905992 -1.6517594042655041608 -4.1789964532944088305 -63.06449570710120156 16.15020573581963248 -2.6273148658368379316 3.9039008261304326552 0.54411071374109920562 3.8505160345483444573 -0.63515770963392725879 -6.3497888600399452486 -5.158043413946091782 -7.1680710544730592559 2.9540170490025174921 0.79629666799231180185 -0.8232499350316072606;-21.189065812973709058 -197.25178682659230844 -3.125608692956181045 -7.9524656219798064427 1.3894010664925424692 5.3188653935598075861 -1.4651798395767232641 -0.32246271390940162149 157.31591374719681653 281.39871874698405918 -5.0568495820519636652 6.0879107737352216034 5.8488912468288267732 -4.3854198021346011416 1.4666235147271846628 -1.8019985082484952787 -167.68189016087555387 -102.40856233828090183 10.349715344395225003 4.3541123088313504752 -7.2184920130751022427 -0.52261791759795350742 0.1602603503537434193 1.1947652206544918663;71.821942256814082839 3.1496904803535428208 21.432430180190571889 -23.972786806339868804 -46.661171706242555501 8.9554322870845268767 18.387459333536902761 -7.1638813347625376338 -33.422742307750269219 -14.581739360006842787 20.37820962210354736 34.349178268163079508 110.0972666390467225 -23.68048124772945684 -30.202397834518347253 51.246384385568255482 -11.223965072647587249 -14.445456347757117399 -28.45244563945586691 -7.1832698569563397939 -47.49543562921171258 12.373066095659529751 38.564643555035210909 -59.677375669776921541;45.284046523964740061 -5.6463421976272902825 52.693140450648435547 -24.378645818306974746 53.101849032268980011 -4.7318221771601134407 -31.704074391726276616 -14.213511426937392557 -33.843912691806878001 8.3438288060158871673 -34.085411427710326393 30.874412291306146727 -90.383523235533857587 7.3112809446676383374 25.643720260703926073 -7.7608805488653676008 -15.587748407629774761 -2.767469494064304758 -18.358702391603582527 3.6138676853719737814 45.325044103782623495 0.35610040256927133484 -1.4434338219360847155 10.874464849088449014;-34.610388399574659957 6.8474185361522472704 43.771364927184016835 -0.11135475053247145816 -10.296403863103035903 1.5473177665061372821 -33.98168986146615822 15.097213551170247214 5.3789827462990782436 -10.357899657021087947 -23.052444658265212496 -35.79333206465147299 29.991503423936251238 -6.5557070149309115692 67.75316368137212919 -20.371372715030108935 39.364662772414938274 4.5932687636934961262 -10.845453715529455252 23.749933548069190437 -17.397889404966061733 16.119534668141568545 -34.628343802723144051 10.654407633053899929];

% Layer 2
b2 = [-0.20542981498228038428;0.2524743306331312942];
LW2_1 = [-0.012769850003602593175 -0.032981577357911337489 -0.030246133647253183041 0.039762563019348266813 0.037792426461631438428 0.019790259683194609541 0.030966641407862607882 0.020200927072654452366 0.30030066455993259522 -0.022892123976764801319 -0.035230429728832765579 -0.0029410053587232073968 -0.0093955249748608540838 -0.038703330137539321276 -0.021572838608398394594 -0.10952170493682859831 -0.037931624141291857277 -0.049210313448189171859 0.03285688252238311291 0.30876773129380952199 0.033762071251369776825 0.19242863717714453475 -0.0075354393721051900895 0.056404104432513368916 0.038474900608064507845 0.017910183472492770262 -0.28476583144660277958 -0.017179024555808445479 0.31627577627312464248 0.028333462631791563741 -0.028460685155796052598 0.037453392177496352966 -0.011058480123279616422 0.015214959982087154777 0.16016749134439089985 0.14359238990576597694 -0.13312835552566298913 0.036457004567826190033 -0.037959041152379871531 0.039309401005868736811;-0.16919558753995342371 0.025159207576039569615 0.01389937579802625299 -0.1869088163036032868 0.024141066717915281997 0.016132791677106416567 -0.033724472910531440306 -0.0096705401075132483429 -0.020671344911009498224 -0.044502925563470144277 0.0066677829097781908529 0.16315044448539492428 0.30997604325345201604 -0.016536402286192693201 0.0056055730909297689021 0.0034030471320807237183 0.025280802972569366843 0.57249649318348505567 -0.030826343437763525923 0.044479800667901664424 -0.013861567394593122052 0.010256352445040795712 -0.25633112132641394654 -0.023706238013478993232 -0.042483148687925353926 -0.026380739619442275523 0.012872654890517391466 0.30179780422546104157 -0.0067534501994069790279 0.0081142356625380739066 0.052791923117309756674 -0.024024605722752501169 -0.31914123795939297601 -0.021749996618914097662 -0.00033714342959105135164 -0.0032404330247379812234 -0.0065773528358742238548 -0.012121489002840289684 -0.018106349404153444099 -0.0099305074237373749252];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0580203972083526;0.0579930615306445];
y1_step1.xoffset = [0.0277036075441027;0.0018311594452593];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
