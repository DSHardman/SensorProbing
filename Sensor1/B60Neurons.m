function [Y,Xf,Af] = B60Neurons(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 13-Oct-2021 11:57:45.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx24 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx3 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [2.68524673386582;2.99314871776712;2.88021282102574;2.79588112427484;2.8060730339926;3.02668430577179;3.26800948558642;2.74914254946245;2.69445254160432;2.99347749507623;2.88119916078485;2.79620966219352;2.80607315529021;3.0266843060025;3.26998217447009;2.75133130469005;2.6816301669079;2.99314871567896;2.88103476690423;2.79609800320815;2.80607316798478;3.0289857694349;3.26850265648006;2.75116691520627];
x1_step1.gain = [4.91762367688358;5.53510098847241;5.13739698110513;4.58325968387612;3.91572950029497;4.16791200433099;5.15611889488224;4.13912274603117;4.83169072646509;5.65663128860184;5.26506004685958;4.75613023615933;4.00071531096501;4.24492717324758;5.31270763688594;4.11369551925013;4.27098957700928;4.97796570982053;4.69554843668877;4.09128687220232;3.50610054229561;3.74657864442045;4.54977320355665;3.54807300765043];
x1_step1.ymin = -1;

% Layer 1
b1 = [-15.087829174557265688;0.06659244583449336341;28.724379567815923053;12.559827851870730697;-81.10280951738030808;16.583171287426473839;4.2328175411024426822;4.4067948147552149507;13.050849721974577378;-0.13791467429609216566;-2.988030283276526422;14.042664160963472142;-4.3286985775877946381;-4.2434517235294535453;-2.3252198567986104294;13.377326159815584816;5.0433540378230068413;-115.45932481077294085;-7.4277374602268979586;-15.092396136588812183;-18.217018917259910182;-20.562521859553829273;-11.090370098877048832;23.693006745502643184;11.302221303550185283;11.669400188182969202;-17.312586868782471328;0.77910395630139073209;21.990535963089961058;-3.7564310947635037863;7.7191550988932009503;-5.4720305451215986992;-9.006774329747138097;50.425702830704913993;1.0777202888830541561;14.395252538073826543;2.8162390939581567473;-4.9868448672184264581;13.209200629922733583;-9.8766194813290226762;-9.4854839203165486339;-12.268051973520178066;1.1002774851846659487;0.18832144077239140745;-9.5404281094666441021;-1.963366163121276653;6.351115947115946625;-5.5895214516688724871;-0.7028088115515120915;-8.5638589087187479976;-2.386477546464710997;-0.9618817111053061808;19.723928793811456472;13.878550669166818565;-1.3545364475955730121;-5.7256548728208933596;4.3471711749234085431;-27.500120446744514169;-7.9378441199539633288;8.2317878061203035855];
IW1_1 = [-4.8019413582236269988 2.4987618654054251088 -7.8909115498484121431 -12.602501577400943233 -2.5925400003515490788 -0.10431175632626818461 -1.6159087613968317054 -145.07797887942655279 2.852029551198532964 -2.9183789036984357779 14.338133809886370429 10.881216000947913969 5.6096788995788164911 -0.17737636584376986759 11.856267696197308581 227.80579788141082531 1.9067323437678893594 0.29423381443824192516 -7.7891145968977166802 2.4818514031808525111 -3.352038851820767551 0.65626873130236984544 -12.273684519719029851 -95.664224904247902259;-4.2996139135724620317 10.368872585973042177 3.9819559575379934735 -8.0566007045629355332 33.027140213418206827 2.5580399810563982932 10.053582486990473299 -0.72125425190466629921 28.376590161747298424 3.3364910935765763611 -1.881244579177649312 -0.68421445009254799885 -22.23686309053686827 -8.9595045749031019255 8.0459872119207993535 38.43186388431715983 -19.95523640677698296 -19.054290692356872228 8.8570631805515436241 -9.8082775381587499197 -1.5863836951301237832 23.024338767536676187 -4.7266697290907178086 -27.729355551740919594;0.80770181412125641174 0.34729747930988535964 -0.91272813363969840239 283.37329184374488023 -0.95299382998074910756 -0.27452828778561855216 -0.56376201214066390399 -0.98015431309539535754 -0.35128579133285736669 -1.0856855954346464888 -13.402054935828514814 -369.69872678938469335 0.81238480772340770919 0.88056692817463244616 0.086461230932685997908 0.8435015610600041791 -0.14389664005206836972 0.97024461080001189739 16.67488705909938318 112.23004823670997609 0.16047569622218377239 -0.47138116912668803771 0.74107748090503455796 -0.046388448798932287176;-171.94615519092613454 19.450518481571197782 -9.1490129529644494966 -39.993055524713739146 -58.353401697702025785 10.949513731964385599 -16.291979122888722742 29.436585314153216331 119.23285737435018916 -30.148198601608772407 4.7917640830565089161 38.395879947858510661 103.23332230950742883 -5.0937086635286537017 32.102930733827541587 -78.475020857639051997 66.912987573837199307 12.584041640571587806 24.794235894250782337 6.9201405167909744165 -41.200628431629873205 -10.247185700313448109 -19.603247180839510122 43.311797323232212875;528.90396535444119763 -75.125073006978652757 177.57469878491187387 -526.30995153841956835 -326.09993655355822284 547.0838246614473519 -53.377559833517629784 44.079835625773668539 -50.127521052002805391 -159.46431123374804883 -256.67159418507662849 463.11970525546109911 631.46498044392751581 -552.59398307395099437 156.08125035638607869 -88.008461921529985261 -435.8484729266301656 70.379993742469849849 70.022876451887782423 66.016794849475175511 -424.39957503187417842 234.68249064589429054 -56.225780440576166086 238.74982645748471555;-41.852831440206784919 -7.197035926015972862 10.780335635234244762 -1.6722223256205583919 6.4294207151794484645 4.5932552674316662333 1.1266652250211435238 42.984912477490915705 14.08313365988895427 6.7749312028230486149 -19.419127434426744827 -3.558396469880141133 0.83852252879542721331 -4.7013137361708858819 -3.3881718885145972742 -112.52330306723919762 34.456723620138618003 -0.29333846059932461303 6.9888201783972467851 7.4188917521720618709 -4.7248621342917731525 2.3726225918990202501 0.70484940729495215717 79.175305459942350694;-101.25554941511381912 -1.3509464217285893639 1.1488817777815265586 11.941855293589851428 -8.9471868886593703962 -5.0587461654444441095 1.7128609863743677888 -4.5580684927643249083 101.15179187687766671 4.2198206456648303941 -0.84719557686945756725 -13.732528311019546408 10.943594670290719861 6.1123109770221635273 -1.3464387977816918429 11.675107311333723814 2.3289102463688506894 -3.701636938984842029 -0.26978868900153379906 1.8387940556395911962 -2.8865221313057496388 -1.7670421824706070701 -0.11123687233100117144 -7.7186347944090716311;-12.169461757432367577 45.337401836956026102 30.495289797813910582 6.349788753100169103 24.172580324821296927 1.3980990236882184785 -18.925078742756081596 -31.062529551269278727 -8.6695089532206832672 -63.714412380591504359 -46.666434426334710395 -7.0019198695838857915 -36.492660657796193391 -7.7213952614337335589 -5.8864826290943419451 59.421243872516171791 36.665715029423502358 34.27101839001372241 4.7202512002122212209 -2.0205928383522677727 18.507919815715972334 6.2639920664533814687 11.949510643285707445 -37.763750482781247797;-96.746801144203431022 -11.141002967247427335 33.504640648252120627 -2.2053565660944989268 -43.032422240201178454 -24.189411458798165455 12.286001597532550278 3.2727306471346269134 57.842030366261731444 19.634762262859517534 -47.682490169452421469 1.2161160371255077539 49.780030924295544992 11.588509821966232138 -34.238494833553701824 -45.30068785196741743 34.547839747036007907 -9.2874880378258914959 22.219261244076694339 -1.3396266694654950236 -8.6309085501574891452 19.160918193664809195 14.949869088822172358 46.340143125376030753;-4.3818750018503473953 2.0599065983988693596 6.3459134452183514341 -87.571540498452279166 -1.2114112580683982223 1.2402247837771176453 2.3843030425264672978 -5.8144787747007287138 1.639295487891320624 5.1283089018335976661 -3.1040539475124320212 67.590847865752053281 9.8960041246819265837 -2.4449953516064222292 -4.4175908313624141499 6.1387102112697631284 3.6142754903911673559 -8.8663075952762326892 -3.4889095868160442393 20.979887163982695597 -9.7250056211443371978 0.96733253112692063613 2.2726932918019526753 0.80953166150184341365;-113.49153218673994559 -34.925607886781023126 -117.82709024419756361 -36.482562308808844875 11.029270906025937293 24.197542812201493945 -25.562471646216884835 36.554624365225258487 191.61519114110453188 -15.206034847221760131 143.67388663848063857 62.514858944567947674 10.686587482429944274 -13.540100841455183556 -12.495584617435804731 -95.566840894989496746 -36.323712351525649922 14.458687163931140063 -43.989166184233539525 -22.81609891531082468 -38.322508320531071035 26.652573206552993668 37.246704724811067422 66.360133402856305906;-5.008391383406956443 13.705637851363134061 -17.896129105430986783 6.4116212612989453845 -10.758985695410238748 -0.50712204452943410171 -17.065596426202152003 12.613104612182393538 0.86228795787974754639 -10.587193379211200295 -14.346176789245838279 -11.733486342719421813 -19.203883785029006503 8.1917112513813226116 1.1893216468335534586 -22.29805181971711292 13.056488315813119527 5.5341902568625469527 -3.223603557591751656 1.366832950990520601 36.512998536640701275 -9.7905502703204501103 2.8438664220309020081 27.31786311460390948;43.275655366153486625 7.0985779156594537298 19.388745321327604643 -27.951282847901222084 26.687951465059047251 3.7351858299381333062 26.691972936465962363 -26.948150691736795892 -26.938338970244029014 -0.45029589640508033144 15.714485939901011946 30.280869624890478065 -18.816812684578941628 -15.473897919309404614 -53.690064094536460004 22.006010494905002162 -21.935646527433682706 -2.5760993757164403206 -21.800503520054427042 -4.3042788548615291688 6.2158708690553172715 7.9804436091782253726 22.162444782180497072 -1.1883965874763731119;83.665870622987483785 50.970669246238486494 23.999565327678446636 -25.22834062500072605 -25.936274602222866292 16.762141858361193414 -24.604303510439734737 -35.118477790283719742 70.181744946524602824 -85.778323493362833574 -26.478427532760473895 59.987833545739214003 58.865700356109051938 2.7379178941832966743 -10.49214068638952746 -3.1788018517293545884 -165.87940753483727008 17.590109470750405762 14.532027752819880462 -31.39795855899804522 -42.505766993436004952 -9.9361757217629094185 45.893532716603580468 51.671895143193168565;11.338400644960175967 -5.6600796437787819215 13.029152066351180395 -72.240293426079588812 15.509164856114070474 -0.74582441450114222992 -0.9380052939066561013 -4.3882195397824466099 -6.0655870521420975905 2.3245225971181344704 -5.98645120501953798 65.024306407806335528 -20.084986078915473939 0.1363055314214147995 3.9287312093106292465 -8.2964145972223892755 -2.6729233589497587431 -2.9695445080217561795 3.1168561493127615591 -3.3251941443747869975 10.428797298038386288 -0.086627689448731448607 -7.4088932120612600585 12.053364364085801697;-4.4531128668958643857 1.2752117743507920267 0.84095090657794069333 -2.7526925866368423534 131.52021822173412602 0.038864024440334599131 -7.3472484154400321543 -3.1598885513142351833 5.8023836562112141024 -1.7351916094955686098 -0.73085127549296879934 5.0657298094570419877 -195.9383797141776995 -8.0669930127886413374 10.857678015193421572 6.6270695697400165969 -1.2427270530248288871 -0.020995023892075147937 0.098571712277111589451 -2.7473732313295053942 77.662760783135396991 9.2459806914956779167 -3.9535916204478604996 -3.8459483009901287431;-68.254552693010211328 -1.9749797262837758272 -3.5605161388310997417 -2.2088874367734798732 -3.6801141528535450398 0.42462249205269353425 0.3955063670716177926 2.0575164082839068058 67.033637959720920207 2.8554654783860207168 3.008337648414551424 3.2377515750032737074 3.4960215110827652651 -2.9813652831622516892 -0.6952261303426754413 -6.7403281297000692263 2.7769281358536512805 -1.0314595447664989258 0.72843526394602897689 -0.8767619328163699377 1.0225505169261115412 3.5951512252008388515 0.47001206257057825955 4.1660723936146508706;-126.79636164902946405 226.07925601108971136 -237.70362603478136521 224.78369051699900183 -83.455865153614055885 -236.14213478839195659 -492.65022789748110199 60.188050079597942954 423.16317392772128869 -334.19474328208787028 261.49059486856396006 -473.1797260775099403 282.42118693419291731 211.82185385831687086 743.28870357364883148 -155.49627033229882045 -258.3945535306978627 -49.799077217491444003 107.7182694521976174 265.74034125939664364 -442.18657009835180816 -189.1359200157683631 -302.31395228963248201 169.88878622288277143;-0.70507654578221168329 0.62341417349248473556 -0.016773720927253904511 -0.30023667478671306474 0.29606944261754580827 -0.082236643071537801619 0.49602324409775727654 -74.222579542606965219 0.41097951155622941544 -0.69307003894507401842 -0.40306608815403638379 0.079297035703569801468 0.16117757782718539206 0.66097390846116210739 -1.4159752388465696171 127.22736556266302443 0.38912078299490110433 0.10007745864038154748 0.46104876574268272016 0.36625685762439613713 -0.46602272246653736465 -0.55760547640215096798 1.0707515920159103029 -61.365615082331217423;58.479259491901501633 -15.186399953390926854 -24.441441879342502119 -24.294401780194984752 9.795696737770189344 13.492308441642880013 6.9177062560776203526 42.735714750275462848 -38.147937852905990042 -35.354699097013345011 4.9726402636748696651 8.9099669281370932339 -1.1376174071067666205 -13.613694582334623817 24.92414134471044207 2.9215417603367623833 -24.099036014052074961 15.930195433814274608 9.8439313602744000775 -11.886734957412496527 -9.6336512156796683115 11.481359335261018373 -22.312153055083932429 -46.103607794764599248;-46.662379257010648814 31.158513945707881021 -63.622543626710502451 -170.23411931861969038 16.995753139639774076 -49.781560504290233382 19.136993351556377263 -2.4941199902300397184 46.280713613718354793 -27.598546563590151237 65.130260422673501353 182.30501714605350116 43.911160429658963267 97.880179192312311898 -23.209322826222948066 -0.49704288222572462486 -6.7427870289080438226 -4.3277753136826868641 -3.9728275852637118248 -11.090977663987629853 -65.89914879518022417 -56.906656489728369763 6.1866136987827733407 -1.1359758446836294432;123.28831621980596367 -39.897049019041887163 -15.725647436240642207 -43.552299207822308347 1.6978588245420396241 -0.55195922869363889252 7.8721326999536085367 53.433686691038971617 -78.461427106089843164 48.892575529100184895 11.581463869710669101 32.950070819870695971 14.492752283924925649 16.398342432776189526 -6.3828521317782387356 -66.053221361240062492 -56.54982064534933528 -6.595287422241996822 4.4274358864479514963 14.349096945218610344 -28.514304280756526566 -19.212921520568112754 -0.088776585604840571597 11.261287420828949735;20.256438570558280787 63.876564995162162575 -8.2899739982674542915 -76.875191308891544395 21.554906773069262726 -56.544520175437376963 -43.422104336081801534 -38.322043620444340206 8.3038369796817104174 -36.641252032354593382 22.721522511892903395 55.807722237294790091 41.938126311027666304 124.85335410075512641 37.795899503900415084 46.928369007930079704 -27.348705903252518823 -25.086941805878762324 -19.588371948696135405 32.061071571819027781 -3.9489333274818578801 -42.222859427044404868 -44.850643978319872929 -25.268914140576260507;-18.525985804539271129 69.723816760841543783 -76.026946080954971308 41.689869835781600216 37.201712567496365125 -10.467404076256489276 -9.2335465342481359841 -52.920019050360778579 -1.370239652689209997 -32.980234414910114538 1.2808463766361020131 -76.062926643775526259 -106.01132373887577387 -55.067526754872595518 -38.464597111295425691 53.849959213460934393 3.6083058204509006472 -12.247472628252651816 55.967481706956405674 19.149240712227932448 58.501317010345275094 55.475569890440056042 31.185615926972676704 11.664144922661938253;-1.5743498272957359152 5.0843021127018106498 -54.882730351266538094 392.04238059336245215 1.449822264132031302 -13.114235099107970584 -2.2649124036825143413 0.5637228062464552103 -4.2801133610376966843 -14.006074484130696334 60.184132326949665526 -363.48593267972773901 -0.21984870903149197896 12.389638365620443849 2.6489425053946478172 -1.63216152823491778 6.1325054712839621729 9.0216022881385384835 -6.9797351439201626988 -19.112450973768794427 -3.0012132736942196409 1.1856048962927869805 -0.59348321676690096727 1.3501397411921758351;-37.74414853766875666 -17.134362947993547976 -40.659701227461475526 212.04895421252652454 234.07437086599674103 -23.204412263571963848 -18.490091646353981503 -38.353592982349603346 -39.765851733190949346 7.4527202278598325691 115.20760895461427253 -180.0912561092617068 -272.59185350324503361 136.85648569740533276 2.7436283841828998931 164.93321688334776809 -9.3746003754752695869 -9.7763671830716365463 -128.65054439028162392 2.3602184981040053025 99.316946151827053768 -148.48547399218523424 -45.059178800212208671 -60.344784364566116608;79.709297722713827739 -102.60704855566410743 17.90063999853228438 -55.544643022400919108 -3.9957348688313656382 8.27066296245734911 -42.255640673574809796 -41.193526170764251049 -93.750799820865651668 141.12751812839522358 -29.82678506485473946 11.472264228864908375 -65.620181569638305064 27.790344154544470712 26.72800201031410694 15.881079406545602239 15.50743971561260004 -30.021818934160666714 -2.6160202592040104896 3.6082936316085856276 81.664379338026549249 -11.206120395111552668 -26.257269500774185644 -24.321683053522864526;-65.47895459398560547 27.131494001444501407 -27.445950205269490141 -25.466100029956177053 68.806783495524854288 -4.5965677595184946114 -56.435226256327290173 -42.535851232694788848 39.205185420819276487 -27.54499653844050755 35.576408660350800517 21.187316157122388915 -114.57801899045502125 23.272271677470275364 59.787417741493982248 106.4982534046166478 25.501624709794246115 -8.4447190362367656746 -14.132687456714439378 -4.4712551376460369923 71.52749794887908763 -23.015461149756735182 -14.693361729019063233 -63.108683022660912343;-123.75761413890299423 37.771154601903084824 13.006154290830412634 -15.823861010700413843 -78.563271039872816459 85.945678839734583221 13.880234449667280927 -24.256765400151337531 112.51704819290775106 -55.518613676194831896 25.930615219133859028 7.654303503430051947 87.016749198313846136 -31.850835938990801566 -16.953333320088916025 69.200907536834691314 9.8688665293446007354 28.618113034875733547 -9.9731631384717704947 -45.773554209903515755 -21.697146860095394061 -38.377146211780242879 29.43161564950975162 2.7737519308552034403;-4.950342436806288049 1.2097873103707139641 -0.60138940356162173817 -5.8494073613619290697 4.1852172337704391936 5.0585014059072328507 -5.2517070914861117004 -9.3336069632617935099 -3.2234220596577070062 -4.182268372194806183 -17.853867042077805394 0.63790901000372057794 -5.8980942118130164076 1.6989371044191898807 -2.7635046027468721519 13.939977633224550857 9.0474882451309106557 4.6073155076207656933 9.8773247758093773996 0.25359577452115933394 3.8918492888833862153 -7.5301392731508833833 1.7295909065607937283 -9.712412438288794192;-5.3755524592758794356 -0.53839510471123164237 3.2436069431595799806 -2.1430873996559034467 -6.9174023092133669621 -4.8228767786083279745 25.793119318281725327 -190.39100145951164222 3.4054392851638000117 0.52477166369728722728 -4.92329566259581064 1.6914476306456058818 11.707925375412559177 11.109966116260540758 -63.675795051229975741 196.80756718841752217 2.829871975657159755 -0.09648342260145310878 1.4416483848069738816 0.63370806590173434092 -5.7634361961031643773 -7.2369997265250649576 45.891565471078969551 -4.7488952402720006063;1.1851203790987774322 1.6584342142373511564 -2.3889836136679232226 -53.384766846059243051 1.4722267817609253626 0.056706903412146035526 0.52681267662444997146 0.2427206954501162639 -1.8164046996548592894 0.59288415802339478056 8.1309040626258610729 72.60606714383293081 -3.1669455930266523502 0.0070866266841702225954 -0.73607645686001987873 0.33308560506415574309 0.54424554704154337603 -2.706108555937718485 -6.5962603622250561841 -24.128030999022158198 1.808167360736856466 -0.14921547851294489351 0.0020710324550236025587 -0.84057060456275878302;-0.51016867287920575347 0.80326365901766805244 -0.18411650273338528438 -0.31547826831207587128 0.134284661033007513 -0.069121946714806939416 0.88017146491248587914 -88.249799536807401523 0.3786590140005128835 -0.93925853911446099964 -0.29083335259755971336 0.10465582802161767229 0.3839116269957346117 0.59588528426599807197 -2.2718048209554262407 151.41827964985026256 0.23466477344061448251 0.16534382156369836769 0.53540918727214437123 0.34158123875771040368 -0.54330189734861211726 -0.4772640287774924106 1.6441012170339401877 -73.128002290802328389;-6.193205770666367016 42.08752950364304013 4.1859825873009395281 47.22966702639456571 12.657233020253665146 68.616228598378100401 -140.60586219966248223 130.89901452728057052 50.420780429178066129 -54.348247988622226501 -7.9438556031203972907 -26.454544560866587233 -51.339992943387514401 -87.364031724541135304 188.76218899168571852 -223.80981998436593017 -21.322626161055342919 46.897842611079788355 4.1205354622144554355 -22.495824420015821943 42.255387385616870688 69.905844489782737128 -24.485941861656517204 141.55956806855036234;-11.642579220632393699 11.023761968100661335 51.8656429045781735 29.109634073182970582 6.0958909482998118179 27.948002428954513476 -36.027231345069154145 -0.79011319466420093516 28.887380239642581614 -2.2678662215168010619 -18.624934475535376066 -20.097726640582706636 5.3686220902066290606 -53.854177900373173316 44.554582642779358537 31.381751871899371764 -7.9379245318899078754 -7.4438303764523112704 -27.184351582093984945 -16.094886723917735338 -11.034929186375130428 31.561259672814795607 -11.144147058961058505 -22.891764924376605705;-0.73365773520111488004 -1.853400267789561795 91.155645169390069782 13.375874506590628599 -6.2105995553832471501 5.3297247969431866821 -2.15347989865323175 -0.63107562285834950533 1.3276793426423079136 5.1704572313565178021 -127.23000703488385454 -78.050517991373610016 10.909924145679848806 -5.8726616928746162571 2.6896237523633685917 0.74625744858323916908 -0.72575731106772156664 -4.1232355743044211138 42.292386858323091303 76.26238924387030238 -5.2381590432731739426 0.80868881655229196692 -1.4365895871036278297 -0.5755991498263676176;-43.785705527639890988 -1.0760083196856959908 -1.4326489316781492178 1.7516323222468035414 -2.7183913097996459385 -1.1415250537859169544 0.79810390752483817423 -0.006834016389092983576 45.430785059595052644 3.707359930631298095 2.4742954524536906469 -1.5119754363607389447 3.6682338312947968539 1.078634796660341344 -0.91495036654804828835 -1.4950432562130688829 -0.63428738672429507695 -3.018333727809846323 -1.1867038670840088788 -0.052026791896355395473 -1.3480872441373361603 0.076692612698373824331 0.16879137170496461007 1.7749325359813628022;43.557402451212432481 -62.224161989788328242 -15.140328448222875934 -3.9886707893180326501 5.8858965901336937065 -7.216591234609836647 59.116545137784939357 42.544711553012312777 -41.020489865386274175 46.400606958304926764 3.9295223339484453007 2.1741637142514611547 -22.630426092605564037 24.76783274552121128 -74.821423631991123671 -65.5925347950781088 -6.8461673356058261319 -12.695532980659589128 20.059056225363942616 -6.5504328317831213013 15.951700052206630787 -9.1798240876949428468 43.096438625477027529 14.547730734317946499;1.4524752814018579983 -1.6017515196619382944 -0.99781299754270191826 -2.1915661860631994173 67.47928770576093882 -0.13621431884199672324 -2.7142812158956237667 1.1983373441569467044 -1.3808835996030270898 1.6505472063763400037 0.71394870588077763429 2.9746674803458872383 -140.20083205274502802 7.9351498740427759415 2.3839933808117739211 -7.0716977042565449807 0.2991816177471962046 0.20061834880209772347 0.80787785352969754271 -1.0139067574868187993 85.567917993095718998 -9.2206067990748881158 0.23264838434768278508 7.1551585233758041582;-138.26958826809027414 73.508170212460910875 -35.444054575185603539 144.28490640337182072 -105.73992166506803869 -135.25311417285763582 67.774348679075359314 -11.749973829592505581 143.85782090675769496 -133.56063033294094566 73.619695042976488253 -110.16140317359548817 185.18492084559764521 131.44793399353329733 -115.92892073871212233 160.69205697477963213 19.150636221080020505 46.576004288104101647 -38.944941017861452792 -43.118032886501168832 -34.469768734953724731 -27.388156306517615235 41.850923584128508992 -189.65843691550733752;131.75404547777117159 -3.9015395041132858722 -18.663374768125223113 78.131885760944754793 -16.590441888484622979 -113.81947865531154207 27.673317006038583798 -21.78521497283962205 -64.025467506275077767 15.254589802022987755 90.468256091416648701 -4.5473379702915410761 78.828137885068429114 11.076344273328183831 -3.611605112637589432 54.428704620632835542 -11.998781350058274953 -49.03081972568533331 -57.228424817335785235 -80.176322395108812202 -50.496364717133559452 46.210686156290428528 22.106823354619240973 18.153375141584497499;-6.6153226019699440386 82.515837284020918219 9.190196016303573856 -4.0282331862182694238 -41.937366841256697114 -22.542333679763302712 -12.796886569270487399 -26.169321574100152361 -6.1971333568034427941 -104.50376346618376999 26.511063949382403848 66.167148307834438015 41.183325154753411823 21.497672462692435147 -15.11679802521192606 27.589360082519853279 -43.869286639625201474 -5.57306327460143347 -19.930809839980661025 -34.757257222035967459 -24.924115018821467515 -37.804782208816092748 -3.5408847162869019343 17.540740984205250186;35.414762991446828266 -25.659199593417284291 85.363447343387107935 2.7711835662503103705 5.3855863731592155119 20.266740963759691141 -17.923260538819945964 -9.775513368418033977 -21.295575665352075134 36.569333692565272997 -90.560842997450308189 -4.6109376378380515504 -14.795226731874075554 -53.7036934862754336 38.509481550532349559 17.891135168408084155 -20.24290730456952403 -2.00147614961560949 13.238748347380868253 -10.434047805810594767 7.2988241800979682949 20.932748481014037623 -20.650765235160655209 0.047870318725936902848;149.20063144965098445 17.851799842494294523 -4.7052135575155471514 -6.1924161162005209036 7.9680239150659097902 -8.5043138744421415964 6.0283583033935617124 35.429898166083440003 -143.59789499859081729 -21.724333545042370019 -4.6918655452177713272 0.74558369474580921121 -10.253278321746014612 14.735104006817715927 -12.777546820728041155 -91.257654860821872944 -5.18073980399767553 7.5478420032229829317 8.4327267142424364721 3.0004855188969807855 -0.26670549869039578139 -8.5861390681926437196 9.9627794674791836371 66.926892470433756444;45.566977898331202823 -13.891416850980444764 20.593371294781920966 43.608897002125210918 -84.057117519932191385 75.666469192125347831 -74.38660281652805395 16.869085699728337602 -97.766691997487257026 25.758907209105714742 44.443387060688280599 -25.987716059072418773 174.48149063158155059 -69.248306136146936751 86.379792492037225315 -162.49481173056526018 47.101506055932965467 1.5790117282984890146 -77.477401603838657707 -12.899131863272979004 -112.4107429080831082 10.463836461305978887 -48.285449616051494104 140.63848835514369284;10.147010288801588729 3.5668745958457725997 -19.646469360054918951 -3.1975749877369952223 4.3965409546503364524 -1.5514229306230298278 -4.1528737506601069995 1.2965567545318690268 2.035188165175438435 -1.3858331277494828626 26.847409868520347942 -0.073768810185359051657 -8.2503385371586581698 3.0677042853076406104 5.8174099611518341746 -3.7115875221259604366 -14.075101068591557407 -2.6960742273894715559 -8.5268024533352928529 4.011709616056693406 4.4357615495760498447 -2.0194018528159993764 -2.181998035303612582 2.506016151066687403;-18.318596691658125764 -4.614298712095543209 -15.035003206792760366 32.060450980860828452 9.8249024218824843047 -2.593613582213808666 32.559036240990849365 17.706091067060583555 19.814479368743469934 1.8285367441877269368 17.239794553944502553 -34.434050023241802307 -18.319640489258656402 -17.048632152100768877 -33.02474131384586542 -22.100338051177555343 0.91430601896036090004 4.0188850787914232043 -5.1418022582801761189 7.6399571778509978159 18.385125113968751265 19.119353412435856399 1.0689818330128493251 -2.5608844301663995502;-6.0148699941748411391 -43.239369745794022037 11.180211622721783371 -5.5230554389565016393 -26.392649329330147623 4.4329405612620327304 -20.681192955087670526 -24.229383068827168302 -3.6501326145968060466 42.24481761281812453 5.2911750320042241214 8.0855845425240513435 17.477266707382742794 -7.0368439473342849766 27.819554770376786479 38.656326474646661495 8.6446983496735807506 1.0896110842390571705 -21.809109349696104374 2.1600847389074635529 8.6671067979211855459 2.5343405297893624173 -13.872761056799674861 -20.320038661227460608;-5.3598449512802561756 -35.4430288626415404 28.650107855998236062 -13.281711733736738523 19.309615978665206626 -6.9222619934661331342 32.105957335728497526 58.792346653040958415 33.417050579330044968 4.0863349235647739022 -7.3417238371440971534 19.897033293830372003 -32.977907180085658467 27.696869050590766648 -46.583587119620176509 -95.018892780283039201 -41.746226858984037733 42.170599817666882814 -15.074482439636385678 -13.23590458257410063 5.1241085098594725267 -26.13755996114537794 13.068911717751358736 20.185124495283194079;-23.838120044524821139 35.659811085692851407 -25.946075536413541585 -53.850611390547378221 -89.166596919776353047 115.32992517184793257 17.686195855174823066 -29.002813330281785653 59.047134191823992921 -78.537591047378782605 -46.484414553355108524 33.163609133515905114 156.99148304487383143 -99.197566590776290241 47.480796700440407676 -30.011055096077129178 -6.7267431215344881679 -4.4348219974705083146 9.166194184255745725 43.453103672813256253 -62.194380379339378351 62.161146241577270644 -35.104662164325297624 22.06323190273894852;3.8296911076787480965 8.9591616690187159122 -3.0988821735181608652 11.531916108725633663 -0.071109932528960917431 3.7793350315156724051 5.6275647550984526646 -10.918938875792992604 -4.2400275290562960961 -11.103312660116083421 -7.555733300469658964 -8.2769392130413965702 18.182868265936228624 -1.2669754183246044743 -6.8099572731565345407 1.3112136185804486033 -10.009242810095123843 5.0740304902365096495 4.1800860923835978511 0.27052040706257368674 -16.404923006780293804 0.79796450742674329693 -2.0833691683727137978 7.7289570295380123355;45.763888812984689025 10.083014640147325736 -13.079519771022200203 42.03909615084867113 26.952175681669789498 4.9769013892408766608 3.8989286247429841836 -7.6794558758563367107 -28.365797677635896434 -9.5638933972645663317 15.943419846351806868 -37.640339560734091151 -72.771523908909557576 13.421619651130859197 10.195895621387224494 -19.674903897657312513 -17.940474332722374129 5.0913025117916532736 16.824970722478251872 -10.928242343923967539 53.988971311368551653 -2.5314778455405808621 -13.817586480172012742 20.165007833510866675;93.057845105724794621 -25.781373041644862099 -52.027680759042823411 -2.4813398780310227387 -13.749197211036284116 -35.926948094755012164 49.939377748654656841 7.6855414338398349017 -42.937032519952410325 10.835368352218756272 51.16207796742618541 20.377521858318981884 14.690648876263708189 -38.716490876352452233 -104.72906109779086137 -20.006909724426417796 -40.317616973933347424 24.839371333006013742 15.160553674034439098 -11.128458684085154928 -3.4471284492525415821 96.672704261755285415 59.66831794144396639 18.836606722533279168;-111.79528464251279729 13.210020501621688283 30.540935011999341242 -33.349538321437776744 -28.329271626882238877 18.338991834879852405 12.107113335749859928 -92.27106235859432104 109.53649585364605912 -22.125386826402134943 -38.833421505214793967 37.365730889260738934 64.101179278197619738 -52.999159754992540172 -13.551398536350193424 87.381751406697205198 3.2428722987562461633 14.769065377276882955 12.570045573045240062 -5.9522520123118649593 -46.393772165835478916 42.329266364849971183 6.2916170072095418675 18.556315473134894489;33.230378749150183637 -15.428996607006929764 13.229664317019137698 -5.9219096998196727455 2.7854784137087222895 6.843258472330727038 8.4724042131835446412 -3.9284106353628849284 -19.5514742445546581 23.080767131935413516 -8.1715452666162029516 11.146814656999712412 -30.747266484682288734 -7.0054108134810624264 -27.401685320108654764 17.563651125091940486 -16.683244913906946749 -19.447340684300453262 9.8927208264081123446 12.129209785309999603 21.594825948594341014 9.4356016295262428173 16.087719368998897096 -31.363107003983035526;10.602652495678766442 17.194748520342422182 19.636780316477530306 8.8001947136050286957 -20.640631031329796485 -8.3484703285785961668 -23.440673896142399713 -27.297045530210532149 13.785711864322623299 -3.4691192022719454791 -7.7408801254444030704 -21.554129355692467129 -1.6063571991308216447 18.983579782821308868 31.774590297623102941 47.898170834797461737 5.2563196560669460666 -10.93447247226187713 3.8235126229701492662 6.6099320268608758866 28.566265188815989973 -3.8333436729591809922 -6.4618520085864128433 -32.188104404237023459;6.395760424927274812 -15.656538424186745573 78.644205087762756534 -32.630854647614356168 -17.578082223526315886 -70.234669900879978854 -54.246996043426285894 66.859653682282086606 -13.47022562672592727 7.9014265006970774152 -61.870886116579349334 14.558379605290330261 -58.683897652448358429 37.028172810903704715 49.843135121274421806 -114.34121356908228506 9.0859887335437488076 10.056156117485864243 6.1233895072373618618 24.473399940585998991 83.443170146220865036 9.5605513862071642706 9.8864531142985576651 27.838199224315037128;50.812991124753885686 -81.855618938312275645 59.336982352617098968 57.415921858299711289 -81.137811664618283203 43.023572949244375252 -20.165792238316484486 -13.991661312125584615 -12.480087511418409107 93.798633971940972742 1.2289061343368852253 -48.128077293359517341 139.53158718655748771 -49.94742248972150378 -5.4996072503804240839 -64.806889936591304036 -55.09211300077355844 -2.8567229071130992857 -63.083464364149136827 -2.3098800649892297088 -94.821247096741089422 9.8361992365096657664 -14.133817339216742326 85.644818129592579226;-14.064461019331281122 -1.6746421403816971196 -0.64378396241731727923 -2.0293356862211613389 -41.829315028007265198 -1.5086198333408904482 0.28348535985979061991 1.8456116185004112218 6.4918616048923398765 1.4954079619311950733 0.64395612590007655918 0.038360987379254737895 114.95356094378790601 1.4625362905134773328 0.66065331303176899613 -3.680850827392911917 9.1395966671601271969 -0.20709165612224075814 -0.38141877881064129019 1.8632394858955687589 -85.38903093975231684 0.49143796482947682547 -0.96847612489160594951 2.9718024564726639447;-23.804171564974865305 -10.592444346704901648 15.869809433694785028 25.009320246369178165 -26.543101758618583119 -15.697631273242235395 -8.7130565847586005646 1.9091597645247617709 58.162861936916698369 16.913294079511576484 -10.131984409746157993 -39.866292630483648907 2.7431996744227538088 5.5451426653305562198 7.824415507443348794 21.651898025806950443 -30.513910506491509267 0.79497263958266284334 -5.2168801607148287403 4.1511078533172121041 21.755391542779054959 4.8588820541923922747 -2.7000885577714788255 -2.0512788710910578871];

% Layer 2
b2 = [-0.32025475367900269053;-0.15180902608875834758;1.0391464142278781235];
LW2_1 = [-0.0017612260955794636821 -0.015891241521074246645 0.44941901263556960355 0.020947017428706672659 0.014918609727144042237 0.0033306810867490634943 0.20888586302650077875 0.038411981900887626207 0.051782186778252414783 0.082511296441302187099 0.031612116345863992828 -0.023092992685416764698 -0.053361749557413899747 -0.029629823258465168984 0.054047241467750382904 0.02599240683110890654 0.13529386052723757494 -0.004105294080087913515 -0.0030987483509022813177 -0.029245474150356949583 0.045292388317920595497 0.052890143382027202112 0.024962705612977698078 -0.024851434607769503499 0.096048248046459561156 0.0066642268188413259986 -0.040190279804694147014 -0.0206754210215774753 -0.031987166641030545522 0.018949844470673393032 -0.013790980382790049216 0.37193926829834411674 0.026315937584114421077 -0.0027645053587050296556 0.0429543532962785371 -0.23949925755321602172 -0.3518189651351962266 0.050804335934831683363 0.052130621894348035117 -0.010461006428991934114 0.0089325940332654462511 0.018835698610151916516 0.031316273813522740865 0.056403257634148752653 0.0094862898969897621604 -0.22104578942045674528 -0.016789981077191526437 0.042536959234085972015 0.041068842856474351011 -0.006811355766905007221 0.042548003307372996018 -0.01837975953694880385 0.0023229326439025022727 0.012301877079185560143 -0.028036726454546363752 0.03802021663349182401 -0.028247257746258143396 -0.022470663874257466863 0.019579531864701557597 0.041833698699509154484;-0.17115224516624422124 0.0079582950765247056218 0.0065294883502063031516 -0.037183602073224242268 0.0066560800152340232269 -0.067008212660784022274 -0.024247357839572360183 0.0006866002379886828981 -0.0069250127213088732286 0.0206398632147837581 0.013888912223947145336 -0.02902628116636139094 0.022918054406957356905 -0.036047456034446236084 -0.013846921155114181798 -0.15432620305139913008 0.12621954733928769654 -0.009342327465999781394 3.3957880237921584943 0.0093196172483681581633 -0.027945114685125883175 -0.042208686687445581831 -0.0007875731130516112205 -0.029980137997099202268 0.023013592022783559143 -0.021248060426390619898 0.0046999961228273903074 0.038231466928976422237 -0.0047778837697603458723 0.051019350706472267609 -0.16130380202219182784 -0.0060713151156176602824 -3.1695513702364865871 0.0097768348376497046792 -0.026222668324661448092 0.017646307110318067146 -0.044983660341019526818 -0.021130120515389438224 -0.16555687550528164209 0.0030887148217773508115 0.016939843959346129881 0.012580326008007720537 -0.011585851403440960636 0.044494018465608527191 -0.023255673274816653084 0.039780888088737767494 -0.048044755164606836595 0.045698463228393410018 -0.0042321344926906550102 0.0053978949508577825714 -0.037437698401766777989 -0.020224633754341251463 0.029038942422880659189 0.056870404122311563055 0.028198096894683735703 -0.0020424369621014877921 0.011038910584669527071 -0.02739618989460064491 -0.35733825398135543594 -0.008289058147799224438;0.072516812841765657116 -0.02460939807831183726 -0.13883140792046827494 -0.035518849115823945828 0.017961160186725760174 -0.014485035091637029833 0.30526873875288501603 0.033332546908165151811 0.10794615261861247035 -0.011092591784558077095 0.062738291370209753328 -0.0083881218053123516448 -0.0016449725885819234047 -0.0079081356983148453493 0.027671932787305345697 -0.049158583498051890148 0.3745772193406584627 0.0003274710611328086364 -1.3152118951546576398 -0.066761286584151979806 -0.013743290236751026789 0.055473280912914188501 -0.0096276254321147232418 0.06630149246590515133 0.012428427454454092985 -0.026800117449961878557 -0.0050820016232473071149 0.072034103050558975778 0.048380745043732423238 -0.014349585157472597233 0.088723910715371764879 -0.074976639492034063972 1.190921881443786523 0.0074762577086516304736 -0.013549288106916133542 0.063676122827467068754 -0.63395226069347510034 0.021314873695295569189 -0.15940786440844204042 -0.032752297046220922583 0.048047524587630230375 -0.028057458700683601815 -0.10093591756221829969 0.070640662352476582542 -0.049604338516653745383 0.029116243442650673046 0.034509082197251961244 0.099957264048074423446 -0.075444780913477671458 -0.018975979182109692367 -0.030422693801248307938 -0.010914164621860370993 0.050476686442698773249 0.13214526067995044367 -0.038551185095163177652 0.0077092632277166329297 0.071127032825667582672 0.0021834207257051497716 -0.15425403907848880825 -0.0075852910878883503254];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0579764877829954;0.0579996479572353;2];
y1_step1.xoffset = [0.000124857619797858;0.0149896864439588;0.5];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
