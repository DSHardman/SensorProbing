function [Y,Xf,Af] = C60Neurons(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 14-Oct-2021 10:26:40.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx24 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx3 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [2.74324441590927;3.03736966914116;2.8601572641501;2.78667506560042;2.89204888768865;3.06120625025987;3.26343821056319;2.79045599681823;2.69543887744707;3.03671210738224;2.86501837331965;2.78683945309531;2.89254205894505;3.04829657148566;3.26529003242687;2.7905499625969;2.74261865957547;3.03687649805281;2.86952748281293;2.78683944843519;2.89270644930876;3.06252137104138;3.26718750947559;2.79045603066602];
x1_step1.gain = [5.33375508020093;6.68837265126621;4.43373473336413;4.6748474831961;4.72839658732671;4.30029600384873;5.43418862126463;4.09084581797461;4.88809854297538;6.88130687766081;4.49030611302868;4.91761683012387;4.78606031299686;4.21685683832427;5.61026674032536;4.19606033904922;4.61364776228668;5.82949014140829;4.24121907924902;4.31730961546303;4.10470086448161;3.75864760768;4.81253778935692;3.60799833921081];
x1_step1.ymin = -1;

% Layer 1
b1 = [24.600046254570163029;-9.151234085780529881;11.638501760312363942;5.2125912234953162283;-17.416751636083027677;-6.0481006592878525652;-3.0505719580157286686;-5.6404245354024098447;0.75284800085427094896;23.179183552205497421;-11.088072506739779399;-11.088694120054078951;-4.207141408261043658;14.504401386388385831;-13.917197167868014418;8.9653966658458248418;-1.2370039916299888638;9.7076213645027280563;9.8903478549360848149;3.1138983282724006507;3.5574239149319342168;9.2513945573078189;-3.531966805868060888;-15.5472856303931799;24.720561734633584194;14.656796335030319867;0.68553211575441397319;-0.15429754336054185559;-11.648013680988894336;0.65358928788501713392;6.6681475310678131052;8.9636999299823028053;-2.0847929092594159606;-2.30289180985225439;-3.4098731578620147253;-25.329168806174919837;-2.3537158651109773011;-14.722523419226028807;1.0561046969116720806;16.347014092152114983;-2.3128739808623186569;-2.490377885057972307;13.842112684666204814;29.608663658028078203;-13.057595864348456871;0.85686557721061729076;-19.316424161238941792;5.4112187808756315732;26.698402922162536299;5.6054317404469031771;-7.9960976908499903359;2.5492505404855347884;-8.983664880209033754;-9.9019505355976811245;11.908098799738239038;-9.5048501243306695585;-9.148861229187582822;4.2897180239807024549;11.989337125649466742;2.5896195721741741558];
IW1_1 = [-12.518281293827611123 8.6052420228170838357 2.7181736938667642178 1.5879891695404517726 -9.6756393837882814779 1.9289789360235043425 27.858351075335313851 -2.2984188379592702667 -1.3647595262931928595 -6.3718492732276166279 -3.7581653660241767234 -4.8155641852678634507 18.500072094347405738 -10.251529139422160597 -45.44957427371895875 -31.981116234320445813 19.735557328566272872 0.55323892698112309141 8.2981253083963348871 3.5068099414577633688 -5.1511899250594526123 7.2218205551213596749 24.984822115895628514 39.921234983017029663;-9.5841376314252837432 -1.0902399559947784091 2.3496477705005811565 -2.7631531551935264446 3.4792807742107987323 6.0556403541765249088 3.4556095382317937315 6.1558211267451357074 3.8733511295929710094 1.9453331751493507795 -12.431769863970577816 -2.8925444038875656183 1.1014850417844046504 -4.2043269200748376591 2.6607855767440211636 -0.10085149128733283952 -0.60173874459995324582 5.5447114420749192831 -0.46283863364342148206 5.547834046628394411 -4.734269906474668943 -0.19084862956226639197 -8.7217469443477568802 -10.955923559576895343;-0.49946863872004465534 0.3475170185273053769 -5.7677239449382531333 97.252506933018835866 -0.67573595863660251837 3.0415261149482897274e-05 -0.12683735579171506735 -0.29890822274478423548 0.050629135778607059493 -0.40560962198948441459 5.0118920401264599462 -141.55512589291274139 1.0634534853459980397 0.066336471992382212148 0.21462321399049413828 0.67605671355613261575 0.47108501523090623442 0.019266871072306530205 0.81386089015334039942 56.112959542309376104 -0.55999187275246342654 -0.019363767953583438386 -0.047777202942710136901 -0.43109542083874535789;-32.225855896682368495 1.2349746574263960053 -5.2104902904418972653 -13.848783752996780549 -19.733827109060996463 7.0251598726728499145 -0.15883108929390538089 -5.473698813791477491 32.365568721774224059 10.008252854122718034 7.0403491808335250113 19.569807387485411709 25.640851354298533238 -7.3965688475519604239 -1.796575505447362886 12.812021615365567939 15.834156846833726817 -4.0045762189113602858 3.8721522895116260443 -8.0798100563205874636 -6.7986554045188052342 7.1198381105937214031 1.6036144294993703863 -7.9308252458908352622;-38.096642329856692299 -16.277187213123461618 -27.505032032021805577 -26.931627936339427976 -13.303461081286975798 -13.729851159841675923 -0.17488846590951850901 -5.9342086763950563366 36.924843933035184307 21.461767628860936696 9.4768306890611420101 24.092680539236361881 18.058988051046192425 16.644636705383899056 -8.0937350497506841407 32.142414492826922867 2.6820632463746640894 -1.1698303762970643227 24.574080189751633441 -0.48572777945825862389 -14.988211661755778792 5.7627036357152769952 -13.324988790790534665 -25.899898809708137293;1.6543989578676669971 -3.3052537043580239029 7.6761745712661557661 6.6189959211279143503 1.7886270280527241106 -4.5167266524005151851 -2.5788375251240398534 31.848571944825543767 -2.33378665140920738 3.2519738045904444945 -5.6600046081967638756 -7.0229097925407533154 -5.8651430576804219896 6.1746386965222122001 24.007115181514688373 -33.027633354258895793 -0.32175796621047558776 -0.28563292462494999091 -2.426886090800741691 0.56282691643408555571 3.7046893944131373821 -1.1348981859921154491 -26.320216692733829689 0.44276182078954567922;1.7152893745495154665 4.2758179635762445514 4.4371907282685718599 2.9369859184324944579 -4.5069195399165460358 1.8543458266348211705 -0.64764873745014550632 0.09535312763098011124 -1.6000736679012328434 -1.971568778318791848 -2.8062189601190867805 0.25260857771016909101 10.426969715562913521 1.9630157720637617658 1.632701137315661466 -1.1826182513998553247 1.5734990092996461453 -1.9539279931334219143 -3.0273769386199123055 -3.3017393232813931903 -6.0897856419184499543 -3.0584427220253727064 -1.5814213448684648622 -0.069066080737143542567;4.085278808474024359 3.1470167558218831161 -1.3031409198920156367 -0.27481422171573960389 0.98252335484280250988 3.626636493874815681 7.11422683279932766 -6.4456495361070649253 -3.5328339339528671559 -0.28059073875118800689 1.6249580913334868981 5.7554678492644608667 -5.2219787650438416193 -2.1263119432735906322 -7.0748647707384035854 27.317838641720886272 0.61849488195675872415 -0.44429889799952981821 1.6478348502795177044 -9.7929322235580080758 1.7055005479675529045 -1.7492207091667448804 -0.41635281750991387506 -24.379048772073641516;-19.272895713649255356 2.1110250366640741504 -5.8459167207600266636 -11.993060675594810149 8.344103277831205645 1.7535816661018777118 24.710376416862750659 -1.4673738401982201474 18.644860029118504485 3.0844807765113535503 8.7191965988980619784 -0.47467292712597686233 -16.620419000336767112 5.2762103945259219984 -30.176308202056354446 -2.2867719717646863842 6.1863080010635282946 -12.962781504016833267 5.5439622448622474238 8.335728037116933109 10.18868806055398224 -5.9766439047374460003 9.2906535681264692528 2.5069224184897418439;22.959295002171888456 -13.87379427996978265 22.295992463696045149 -39.993256044192342813 -12.062888298194799575 -44.786602116360256787 -15.667870664056637864 13.95902237086869313 -29.29695393439536133 15.36140728832039315 -40.041335827628870447 9.3770805471816629506 -35.86400753320611301 8.1585804058167497033 -19.7080335277266947 -17.578045905065991406 -3.3114621987125394398 -10.339642242206995348 3.3810180385759327493 22.000945006207693666 60.194288439759745302 18.584063411496476448 25.417989710581892382 0.63752001569419514126;1.6826803914296180054 3.154033215275274582 -164.15598766934164132 -38.839530258400465357 -4.8463761911100604607 -0.57219688431869997203 1.7414320317599543131 0.029133235697910181417 -1.149586482242795249 -2.9674167560045794367 253.23946267545565547 65.236931314853379149 0.5971042654025113805 1.2097357383248352747 -1.6137067668037863299 -0.1142287211628018051 -0.89858754786131389558 -0.091704107145708230187 -97.037686273158314521 -32.536959109651149902 5.0785738320775308807 -0.74108202226121477896 -0.31872580348322215871 -0.10753651616291781679;1.7165432198497128091 3.1335961537333774096 -163.61720053637844785 -38.758427850234859591 -4.8092394747292690482 -0.57344085278016643237 1.7096309331502719253 0.017265050563409101159 -1.1175590305244629263 -2.8929618923036448663 252.51146581499858712 65.20911989043055712 0.64342442650226905343 1.2308936150570000123 -1.5796148890192511782 -0.098532323175159364226 -0.96958476539371996061 -0.15888755802741613699 -96.820264787639302995 -32.606287798038096071 4.9812884437649591618 -0.76702068220199637327 -0.32691548923673813265 -0.1157869458053715217;-0.41771755047249614634 -8.3922370331381976882 0.52489712190729043151 3.7735770476348218239 -0.51772460709790313338 -2.8610481933087101858 0.36392455337097545653 -3.9224819230615906029 -0.79414397932838021177 9.5772076072413359071 0.38051426276253003111 -3.2561824626337489974 -3.854089922835276294 2.4746907544574043847 2.0403919854432013281 9.2926780604740724101 -1.0274734255960942253 -0.91042847005485971756 1.7645247927440961266 -0.71680463814255590549 4.2728189610188032077 -0.35859494944516567827 -1.1109268454253564684 -8.8468706397331402513;-33.152893104597453089 -8.2889198926273266466 5.0595473111212969641 12.676242839762446479 13.314577666751290508 14.657959219069137902 25.721869147227970132 2.392348873249110941 20.866486806538631527 8.0521293889997274107 -14.026508127179319274 -11.500237904666395394 -13.220666990553507247 -31.069138082209640572 -33.59097273174543119 -12.672492571776970749 23.312107709044436632 -9.0766617084223888412 0.14348061360814656773 -11.61021593900254345 30.94824227867189137 15.747292379572009224 8.9664354038705003092 9.0075845047850915392;-2.5454192023290747038 10.393231316718331669 -24.802187575526609464 40.387694421663702826 26.387538049584328803 11.274570411842812945 -13.572632919102082028 12.048859152857097854 -0.4493580664555556492 -20.292548523823224826 -13.712987643488128597 -54.919987611129577942 -0.53136083566794400923 -19.108107501289953944 33.754569242377449712 10.783504104947089886 -18.086743902635159742 1.4987079706627342013 12.880664684963672784 9.1188730122568451009 -7.3789368893909514924 3.0911931147706996903 13.831782099346225934 -32.139683659442731312;7.0905580841684088256 -4.0677914056907287232 19.955256714769557647 4.7672330439373675759 22.246710009749413928 -12.430747707814164826 -1.422038470957860179 -13.093788036129605956 -22.706384263348098784 0.35275758118746924907 -19.534222974303162346 -4.3161743096248095242 -52.781181384400142065 7.3149586932118184635 14.566074445966856743 13.034373504771840757 0.83661641768252725804 5.636790000966941605 4.16870154035194318 -6.2169929358211426518 29.301319474432638401 0.6159086101992714557 -5.0974988636385143437 -7.2579926884914769403;2.2610533695584731362 -0.45353558037991847929 -1.0280243610618753358 -0.53354548890927233629 1.0782827636664158444 0.98016303438269780646 -0.12515531380461120126 3.1078635935308742688 0.80297762092810032186 0.54180997493959637268 1.3525672357727793749 0.68285836960377299665 0.7592964517846241268 0.031260277642780553986 -0.13015293796392279901 -3.7747766887926914592 -2.5012520748634403667 -0.2335670021187895018 -0.35213858398279768158 0.54813279427400107835 -1.6464629391097713729 -0.5097312592447651447 -0.055743081365019708784 1.6103870773500610358;33.364758420517297566 -47.009409491618356469 27.233261324973295103 -24.456977271191750134 17.708808863407231371 -15.919152591951741371 -31.251490242845097356 -11.053357035591863777 -36.349956393365332019 17.469648039990882893 -45.0468651699188527 35.038075629481120643 -28.901262880247937659 12.88493463762473823 23.504428198059102328 20.173771998173350539 6.831046867784378307 20.899635138448619642 6.8514578569812032427 10.817687241980026513 -10.480839730614187388 3.9627678645065103069 3.5277824841416758339 -19.048792645093616471;-8.2062945362490484769 10.146457644199351478 -7.0148219703391960778 14.654027773467666051 -6.3121919829551949022 12.635502318644773467 -6.4685613239954742326 2.9460428919241699042 12.895650400880285247 -11.739237465444020359 -2.4703536731125232961 -15.538370509359079819 9.6311932530385053752 -2.3037146286062255562 -8.0879319630128865271 -14.90947031846395987 -6.7193532595025411425 3.9141804293725490638 3.6784478591548110948 3.7078251401458519609 -6.894241242506864431 2.88273912421363665 18.422705682128420079 12.715572464090399762;-0.42743842614807298075 -0.48981903639029800157 -0.59580793498981821088 2.1724731635620231351 -1.2311266823363824496 -0.46493535927844942268 -0.93944384381017964625 -0.70020772191121216643 0.018529040503960758635 0.25786971689825638476 1.1380306049386819112 -2.3519556294598471524 0.33664582809141807562 0.10721468633271111215 0.88948949713214442436 -1.8793432332109247795 0.72539757379537306292 0.20239857676389072516 0.25769023710405503103 0.6345740583251439082 1.0003729908612242205 0.16148139014246998268 0.49173879591542801748 2.9217028355772218795;-18.539781354213793918 4.4314725484191956895 5.7271256423861487406 1.3997547211625036567 -8.3584250256359986508 -3.5703629084383403658 -0.27548846981808727818 -5.2969970271771495973 6.9713535449739136851 -5.9155914687631465654 -4.3397518376495236581 -2.3493218393577190994 -3.3432799116710385512 3.3644170355558236096 0.29493029647373403268 3.4827825104380845112 14.56627410945466039 1.1313602688004271712 -0.18594538509535321613 -0.34135456200375668967 13.490161913857157572 -0.21750759163484706393 0.45339941733581407002 -0.68708662896021643895;28.249623235730688009 10.168070928076476278 -10.432764020727654852 2.9072044305789273011 -88.396399385135225657 -3.7210903157191150825 -14.778073110450529626 -11.968135683201037267 -22.790232298312105286 -9.4416194752289719361 15.485672752735224478 0.94364270817938944447 15.148613672018230503 12.848831310442935916 16.425943584506605077 19.175736204790222672 -6.5717722813957584194 -0.68374157512800115555 -5.4614402842463878329 -1.2886295532196416769 84.558071140081182193 -7.7051019824717421614 -3.3875853466359471255 -6.890834062809867433;-9.1424970018180786724 2.9950753292897687174 3.6160979473965748632 11.835151133390017009 8.0664429591722299762 -3.3386864928874810943 -2.6385317110813932828 -10.667592761424749881 7.2119012538940845403 -9.1267487355847265462 1.7877541955768825321 -6.3092395261949061336 -3.5256351787449133894 5.6593829159791573247 5.334105769722446766 14.551736316505911262 -1.0990655485733058505 1.7011859349782236794 -7.2524382020576450003 1.5191062286357790434 5.0386619564885108957 -3.9421981780431374354 -2.276042451142167522 -5.0603276189099739568;-30.309041272804034151 -2.2322561826448690248 -0.6553354853942421343 -0.5360009138880442725 -1.4477941517314936171 -3.2922862241606045686 -0.62590177949198766427 -2.0097330686920802378 67.484329414370535005 4.5497764779335323482 0.78596003494952304536 -1.5302214567604370821 2.2820212718324528467 4.476430677692309068 0.83457820345468969325 4.5536793210542283461 -36.827161169327816026 -2.9199300736301712078 -0.24525519666175052413 2.2999104149308395861 -0.9819102805699246872 -1.3132458400533753018 0.023814135664443642632 -2.93612221594960765;24.020899573403220018 -7.7617631932614798984 -24.816998014348889967 -15.940683589528395814 12.0412320135410571 -1.7552595068891949648 12.781675210366774564 -4.7305475412314104133 -43.085326449138804605 17.56209641997435611 17.262793937763632357 -4.6607618128161281135 -30.743571724245509103 -29.608817932399816186 -5.2319657540899182635 -47.664418580287730265 -4.0394649558903097386 -6.65308295494464641 7.7966605691263080047 -1.685957003886467076 34.360806779424599711 14.928294332607588757 -3.0369435777059292647 61.968798858780594685;-0.42294382078597220209 0.37636839245615721916 1.1600592948477419508 1.8192122404769714983 -0.35277807720149056969 -2.1135268483327021016 30.565519686357802698 51.496175788523188999 -0.17383064428495387244 -0.17969992433286938183 -1.1140264560626715884 -2.1395977644494568182 0.94318219622260801582 2.4886929775765880279 -54.339244813815412272 -96.643125803463618695 0.78345076530212653942 -0.060935748312140464167 -0.19281248506446219126 0.35517987362733527412 -0.70341387407577427027 -0.30117944111352590308 29.200470735945533107 54.326560689969355167;0.64676315501710890388 1.4322665745400642301 1.9084782435501996822 1.5655681262288481115 4.2190397288164156464 2.6575098255303748473 0.59054285982503285091 -0.068036966352766292676 -1.6624531893294354212 -1.5828002692069955692 0.71268588559244872016 -1.265477856616749941 -6.0298544450418658514 -5.3867899456741259456 0.78692468137197968403 -1.3273058907968025011 0.95810977092527238597 0.57076581832107220471 -0.27764444865965187681 0.40013668085883558057 4.4704483732875788249 1.6061419258149678413 -1.7991787986287579582 -1.1105607741900263008;-12.199075370444363742 -0.76655835848856845871 18.969858127296387096 13.018241701656387832 -19.600518833483619119 -18.63804771989551412 -6.0765847261715109084 9.2483073194563321096 13.811769186904561124 11.10504118623989811 -16.231609823244490087 -11.211876254667231478 6.1175825782972772515 19.281614330203780128 -11.532469179416521499 -25.984105433315853873 13.962666062603183548 -3.4459445997828890285 -5.1668433012818377748 -9.7565749462585902307 -6.9799616229492986719 9.9788883399988961287 17.031549778791884364 5.270732252201913326;0.44503386894786212125 -0.33734863338988707593 5.792510788947373257 -97.859365518603041778 0.6752186568300317937 0.021524694695771281333 0.15010725178902836752 0.31210687456938374096 -0.05038319012695596788 0.40018477389281764678 -4.9332987293014944896 142.40480406190997087 -1.0693985064261353202 -0.10171305900774524344 -0.23815460895624379623 -0.69574970534137714484 -0.40917999966455265159 -0.027784836149165065972 -0.93767225163300926827 -56.419597794140393887 0.56716006335686131035 0.036663395226365219637 0.048907772583480897677 0.43991230733703967637;-1.5154236813910744175 -1.0718709078310444394 8.2115251704858671644 2.362201215789138331 -7.8305951132932491987 -8.6353163592972990159 -3.1209756369249839203 5.422227230612315374 2.0223358310148342731 4.8386072774834891774 -7.3452436801504399355 -2.7547023059662656408 4.2764921574908862922 7.9858887759224206349 -2.4415247874749557155 -10.776052658230565129 4.8820181731732175123 -1.0607715496683089995 -2.1575383053956724844 -2.8083368851360837049 -3.3441033698810778141 4.2230306885463901878 5.3265135627360162829 1.8593153754710567416;15.899650073290283459 -11.326646834753177018 -23.134832229143775351 -11.450891560811705006 14.023118251976665505 12.026567962852496407 39.500037367231804808 9.0948605794257755264 -16.708661866082465508 8.3216890074018046164 4.9466677873590150227 -1.6913297323832854335 -26.071916405090533431 20.333998079558647021 -12.930304721889221753 5.6550561604625997347 -2.8644607155292742817 3.4483152744419669489 26.936953972023125914 8.1191336791589687749 11.659865832657018814 -19.90599575413480693 -6.1162096874001807834 5.8560659980268878755;20.577254126419727953 -18.350654652489676977 -3.404098727700864746 8.2124504889323759471 -13.591187159592820421 -11.339528245807159124 24.911972280575106709 0.65152010499450918601 -14.788170573009255193 4.1167775237993717852 5.7363179420555914234 -23.332558333271361306 20.88533000266677675 16.097022527460595143 -23.95074737950903554 -21.227124017369760622 14.281805509732116377 0.20847842194103927138 -22.984384482234865743 20.827065634576015896 -6.9347909611046931744 -15.076890937585821106 17.848900725479317941 14.960392240393373342;9.7373365430485776528 8.4507527502598769331 1.3000533921786379121 -0.13405045446670715847 -4.6427319632819274986 5.6028150872575022134 7.2202114055070047982 9.6286131220646087314 -1.8525032422446614522 -6.9884974923529394886 3.9037025384637735748 -2.4371782852900594207 6.8707089241361360976 0.32215044960406524766 -0.079351496861589154719 21.670870185380138651 -7.3076787651509409471 0.82500801508198695622 -5.7564194392586127691 -0.095858145872624200834 3.0474809209312709868 -3.3962781536628745549 -1.020420549461587223 -26.779788029786331549;2.493902479871494382 -2.773024084913104037 -1.9865242830937253071 -0.72977961837080118634 -0.2167791922444509134 0.66423777011531359715 -3.8143847609010057553 131.25984504457468915 -2.7124425650833892121 2.8130448050076140021 1.8502344865749531522 0.33088874882603591665 0.96087850946515995787 -1.0781427504838949627 2.295014236355006787 -94.848919932289959434 -0.12112600623627801932 0.1142776922951899421 0.16531076656490023558 0.34119549578099306331 -0.4926551141657749544 0.64540128112537353822 1.6980921375492419312 -39.453771490185474136;-40.394457668545889817 -36.697337585625668055 1.906732912965874549 -12.993590237830424883 22.429247886044691995 -6.2735694579899590195 -7.7825707427517532011 -51.479793905725500736 23.928444927044026258 28.902480397647615007 6.4703214111244662377 23.035792831535587766 -24.754156864094621682 -31.119048638394538386 -15.626705127655116101 3.6319242581841071349 23.092569009101353572 -7.5846550163061481342 -5.2559164849144295317 -6.8554380376715702283 -8.243112769746966606 33.632857359968070909 10.179547521010958278 16.681128356712008554;41.773916335186015658 5.3567849706157693035 10.381487988520197163 -2.7591862942728280217 1.3943039288547696142 -6.0918985297705745552 1.982306019717118506 -35.501703885012098283 15.673164804913463755 -9.1828974032171579722 -20.692113223957807833 6.1785182055998983941 8.3597116084802944869 19.066382840700843104 2.1395722648246953135 71.823217962776865875 -67.476196567496600665 4.0619741765935719613 6.6501838074851633564 -3.005133010615202771 -9.0496997132065057912 -9.5919265021971487073 -3.9988401283314924939 -45.171894251505349871;2.4907752969931395981 -2.8379492676683755192 -2.0256824623861371393 -0.78747930241014274522 -0.16889378039677954702 0.70377462153824510427 -3.855981212476525144 131.85677451523471859 -2.7087684337467985429 2.8537478543233456563 1.8820214146632836538 0.36580095479017676885 0.89065601976005548401 -1.1872244082191050207 2.3014110888025078872 -95.136943144292544616 -0.12488672823734664474 0.14383193140863756443 0.18252951400844313889 0.35804877542917978861 -0.45026034585425389611 0.7182057666488342873 1.7405936677476745444 -39.801584491069228022;0.57301092628139216334 -0.30141263171668564169 -0.97871579618226234309 -1.789136650397146644 0.41065523207945164863 2.0759705091946365485 -30.379181399886057591 -51.828554190344561903 0.0046977555377825871985 0.09976101696682959652 0.94661848123689218415 2.1173095852069092615 -0.95794229941315967025 -2.3663111837054424669 54.174496838862197023 97.455726290033382497 -0.777882689541554595 0.054641189286411012693 0.16540389617888040519 -0.3619055081765070736 0.64386408607060596765 0.19594266074338292927 -29.231140218831427546 -54.904919932662451743;1.3891855679970066539 1.0483763142647684052 -1.4926057144691036171 0.0089539708572292375788 3.0680726662335988664 1.5424198071640837782 -0.59234635762092813227 0.50372135746944135537 -2.4005474460794160585 -0.90614893938995422218 3.4843320975905789361 0.25584445731149352277 -4.8736901715853759853 -4.0931251757344986331 1.2308698132030799766 -1.9220932616468271448 1.3408712513594984728 0.15139095025196916411 -0.8341512697455613079 0.40918006669724860114 4.0360688204234556054 1.9663607408802712406 -1.0064497863658368182 -0.062005852506149317094;-21.301160325492780601 -3.9868702279049132997 7.8801237900431146954 33.960091173563945688 -21.894619055331713042 -2.7272748256823406976 16.337899505935492783 10.146842972629457336 -12.678040730422646121 -3.3439467716324848823 -7.3120604448358550442 -31.291316638346433621 27.293737430325915483 -1.5896298835340623157 -16.5347750161743825 -24.316714468427704787 52.485887426271773393 1.7583941889611480747 0.43451606786094476575 -0.2248789131417727738 -7.6731572867110440228 1.9776437614753090699 10.204633732182877282 15.842105379590643466;-1.8160248401216578795 1.7098391993564323599 0.82184466209556616967 2.6945305063732698514 1.1258757001055939018 2.7231454825398540009 -0.062758398640672174995 1.0882067004617914652 3.9241653669349854106 -0.3624555206586743128 -1.0005340638202315784 -0.48837046804449663062 2.4345055196868621294 0.93387901551369134623 1.4298180737861461154 -2.9853163271315033001 -0.79850651231091740456 -0.72075794520180491709 -0.34402215498118732251 -2.146608831098709036 -3.7935202443114910409 -3.8189893560729819555 -1.5206234132468365861 2.4042478633725750115;13.272058234631938234 12.043763166785518948 -10.896865223580256554 55.58511154498628315 6.2716480975586996749 15.207383484706038956 -26.736709172211302388 9.8745887870579345247 18.043479822744082242 10.00553055086015064 -0.4783230902924158201 -20.798099247148108759 -16.207560760763303875 -18.609773846524198859 44.069773167247710433 -13.932578280240404567 -5.7677806862838316704 -11.241054551045710497 9.094442750695177935 -26.606795699216476692 16.769823565044756464 -0.95003141919041200758 -26.373713770746395113 11.933450169720295264;1.8847148581589927563 -4.976725142256462675 9.9055915395420264247 -3.2083693417526188973 -30.174224303553312865 4.9356197080943680078 -4.5074878419272783603 26.044306668230873925 -2.6425049262515818427 9.7796659470545730386 -8.1676583980743515667 4.2974549042337386595 9.9663995286486706249 -11.001506501081275147 -0.55329666926789644599 -61.608830433377292479 0.48867913516154715126 -0.97145971625877836075 -0.26409320627298127349 -6.062270192961205062 30.601783272712040684 4.6306355343934146873 7.2063754600762948144 41.926092575614966051;8.2125962564387489095 -7.2182286560682591414 -12.813365016907157568 2.832445982810053664 23.168165646328173324 8.1954936821242938549 10.647997270239530465 22.628665242522227885 -5.9509413505275903233 -2.6838927739029028174 17.123216586569647291 13.399281299539156365 13.788367383659656085 7.9146015047911530971 -6.5116596756138021007 -19.332033534425054455 24.209923056739679481 17.472828982106147322 -6.9988047808257531912 34.05843519892821547 -28.298859898289396853 -7.7128207894170106584 5.6310004841727749891 13.416459255000939166;31.961756542217223398 45.047696533642614725 -16.04083013902178223 -2.0294677968957142156 14.361641452243347317 60.486021420637527513 -12.345064304522034959 0.50543607074765928289 -25.601814914200083706 -4.5468854225859676177 16.371757444919964541 -5.2570535453062392506 38.510055968527026948 -34.11669865659192169 19.3432308439792493 -19.362985590086331911 -28.487480677246846739 -33.802895020763095602 1.0454606655710962926 3.8039291854264467574 -25.852146486008866333 -3.9459913784380851176 -7.0312487383038035915 16.105809277870527296;-1.2910232277122364319 1.4941591550232109498 -0.26523871974965368414 0.4269631356476558115 0.12052498188684465652 2.3213496607991062071 0.58189851929659630603 0.44754587280767532675 -0.17483113165438057823 0.007637193634802252884 0.90545752102693644048 0.2024350663613225243 0.093923807521697072476 -3.2035375620892949655 0.1013178289848411795 -4.3924009796159815266 2.8723820427407509293 -1.40765113881471704 -0.29054320118375120963 -1.1746411405901646674 -0.65752561421694766253 1.0352237915146038638 -0.48996172448993152715 3.99346241599740015;-1.0589443368542585944 34.064278508196494499 26.049010639548537682 23.430855865140905792 -8.7463274638690791107 -5.6869174648999560873 42.168556558611676621 -14.303816698316762057 10.540771550240576104 -34.708643026025676193 -25.139042921903971717 -23.845781444236639146 29.216991339809428752 1.8812887391775485746 -13.817696382313325643 -17.259759861505870049 -18.603859012076821244 2.3002302097129216918 13.990547684632371528 2.5651552077179915479 -12.592024957267893726 0.8627468379040237334 -42.617660760361395944 23.329334578642669129;3.6027511164885872574 2.4364682623524833716 2.2172726587188549274 -0.91680310964685562958 105.91213223929280218 0.87444601215563855234 1.3837264988686426292 0.96554560626039864779 2.5051555216726160147 -2.5859149841345749898 -1.3869503736565389485 1.372195885307347929 -158.66974707382499332 1.0752672656299147036 4.3015164313541607299 -1.7427870288786810882 -7.1858638628774311741 -0.0151417132090358314 -0.51292262280101119654 -0.6074581391342093184 62.636505209417308038 -1.7881753007241869557 -6.6188615915488133723 0.59772176407273713838;52.168660190667246468 1.3161006744197747409 -1.1586407203041728664 29.209581970207256774 6.46559741400340382 4.5772701405292286481 2.6711610233958373861 1.3428307757496633634 -99.295343004585021163 -2.5254513688808017946 3.7161156798294494585 -47.287934080338615672 -11.340315062025933202 -4.6211784189397882017 -2.3481697273238042456 -2.772846538253668669 44.933581624537247023 1.1224654039303421094 -2.8304748463821471915 22.625408110247889226 5.5234205616786216098 0.23814839269001389366 -0.74846932779548525083 1.7934379264378932373;6.3464604513472018255 -5.0774042798006737698 -10.641266250207619848 -4.3008327675766366838 0.83168506263546659873 -14.248436265069409856 -7.0491126760052971179 0.090356063636336081402 -5.6834240362089527565 -0.4057297849721093197 3.9948293622754147414 2.3298947526905720018 -4.7552026378720277933 -4.7506701773309805148 5.7124049841339763489 3.1453681782350226825 0.36752500370305996036 1.4993985432488150522 6.4525284296876321832 2.2363146939611118214 0.84159932626895050944 19.43484041148910535 2.0486779736410887232 -2.3795769866892371169;1.349341267951431389 14.10842416750694106 4.8289002162995648959 6.854725249435616341 1.8199001318245628944 -0.93127028791477739489 -11.078070946845244293 -20.681896462114575996 -1.9970812663110271146 -14.540623627776589899 1.8069055129224382839 -3.3779508416803811777 -7.0169954590421372842 3.9065911015238032888 14.092188321375392235 43.759769594189542374 0.85680083853158672813 0.96606623589163043153 -4.6515181795389590746 -2.9076760777446488682 2.2151745912787528248 -3.8432684168536535019 -5.2249064437891714618 -26.887448914795957222;-4.9921587713685200427 5.0953046697269925858 0.74328414716877899693 0.35141397792948059209 -3.2301005484296254622 0.64965562282014721607 0.72550921996851580609 1.264860516719012562 7.4449493790315912634 -5.2008767338612074127 -0.96136929142292826267 -0.63587691974326732147 6.8748383042275547083 0.36547185756780070642 -3.1062994745326637513 -9.7484938258369879804 0.17907196503353192685 0.10231215211015057265 -1.6809688702852443321 0.6976070740492985589 -4.2557204410745894663 -0.28645501275385931716 1.2394475921050991385 11.998466845388923829;-12.553247909110417879 3.2539756387933254089 4.8757740044267805501 -18.484321329585991833 -9.6266506103145630391 5.1539960296981979226 0.22200473950966981285 -12.041848016007769218 2.4208482812798477468 -8.4736831013681843672 -5.4074571409639338171 25.991069504019833403 20.864707840581527165 -6.2373206836069829961 5.2154938842556664014 20.176809479324049335 9.05343265620173554 5.0390726280087640987 2.5214976580382240101 -9.9675882758944869266 -10.141005682124861309 4.4023449750164624916 -2.9496109344815302222 -13.663069561799375151;8.389522533558805506 -10.476654906992994398 6.389170495357232582 -14.6028609708882815 6.4389525285783761888 -12.628520396227917999 6.527152379560778428 -2.9057985372698045268 -13.106853900341022268 12.026104694006978235 3.0782500415467093369 15.474228745952984809 -9.9272975969249781514 2.105921246473296371 8.10949531342988017 14.849845110275083471 6.7452564546955384728 -3.8486780096272128482 -3.6420611181350306396 -3.7099086007656580932 7.1248151783830646622 -2.8344070075039127232 -18.554395199189670507 -12.669143594514173046;21.932091048116475918 -1.0214727006994235303 -1.7628615384647476905 1.0924374488752008894 -2.3420723863149581767 -1.2246560134797694896 0.48368978896587622174 -4.7488289033697110852 -48.322698527512187638 1.4047752191096536389 4.0226979860472251715 -1.5323219042616871288 3.8540075374699163113 2.5842730332209109534 0.0049795547869055933887 7.6681765459811597196 26.645252246919397976 -0.86608638222361289394 -2.9128287862381432305 1.5332518606191272159 -2.466761017601700523 -1.1412233704739953577 1.5334011202530428708 -3.4879707861722195616;-3.9201946994732632668 -1.2669868098954528701 3.296576548330738099 -0.97162656282255677187 -125.59056103356194001 -0.93242955802999305526 0.042091300349261506764 5.5569311961243696985 0.32336119993786266447 1.2589949068992689618 -2.1732955039092969329 -0.25263798197480397123 179.53508928103772746 -7.1082255082609426822 4.3122131803156884544 -6.1864034599327117903 4.1941055972585656875 -0.036387271110043944988 -0.71988621702237842737 1.5956911401371629555 -64.6233063599761266 9.846825154432847782 -5.6010379462962429642 0.9001232860785874923;-9.9681219455124185913 -0.89617392709605891987 2.1557461758157785425 -2.8485088664223656707 3.3474870288762765824 6.0008221748883556756 3.329042055427889224 6.1999593228975369286 4.2724892465608093062 1.7770677041571780741 -11.947423494791948428 -2.6950565379630972984 1.1929362033075054939 -4.1602094286892405961 2.7662462680444463992 0.039274514274358685029 -0.46623555555877044254 5.427508180817783412 -0.64223268888858631165 5.405071088156143233 -4.7754880661602499003 -0.18932367935442806495 -8.6855992228636669239 -11.080332920311525058;33.100917268833740081 -8.9903025831516423239 -2.879762030494882552 -28.032903638594586226 -19.726804495775752457 1.9002980103614812712 12.552702051935039407 -8.1436065044043282057 -34.971690874488352563 6.1142734483793761413 -14.672115562697420899 25.589913431259152077 31.589126648841855172 -1.0849288169046718 -22.622915492357645206 6.3418521665835934087 -7.185976160523151357 -0.056423181538006308977 8.4179178177508262593 4.2321188612680407104 -13.116626622592308493 -3.5183357846565117555 11.159119457664067099 -7.0510542476049282712;-1.856371866592897657 -13.619087664019364325 -17.266528762243130046 11.473886962570906789 -7.8117155066641341676 1.1369487832873608202 -3.6659115854752148955 -3.9388777011543778528 -2.0668068029548112285 10.777870310952602395 11.818215399251059239 -10.454144962369761984 4.8394582189562518337 -2.7759261577188181214 7.4001584900935259981 1.2540847009756874719 6.1295098067145472598 2.8486047683337134551 8.7374963623412931213 3.8836734433795969679 2.2820797885675396799 4.1387727503702409493 -0.1033304239052070389 7.299026883599140092;-8.1720054549593132975 7.6121380954714048528 -2.0908382212119462906 10.320594716719046602 1.8367675695146266079 -2.250570083779561692 -4.5226196779058458475 -8.8495515992237923086 6.0938178941101082131 -9.2866939532649972477 4.84028922051806898 -11.83999776272549731 -4.7603523960209974675 3.2431629839766622503 4.7291429683367560699 2.2859510921662886673 2.3932711238539039478 0.54916338224878080698 -0.36399035923193162612 3.1784614477966144364 1.9883922989172178042 -3.3460582265251774814 0.56140741989746267837 7.4551047785790727218];

% Layer 2
b2 = [-1.0486076259011800627;-7.4992543932333060042;-6.7600258228734961818];
LW2_1 = [0.039345373237018109458 -0.64558800132905369562 13.616432454805844188 0.027375965778215757829 0.042773797182783040993 0.033404110216865262606 0.084108813089741454871 -0.026964770897448222392 0.00066022346553143949899 -0.029527758162438869083 -11.013557647063604961 11.010912071848448335 -0.083304331353898170009 0.023225992249230591885 -0.016083921670592495751 0.0016289100699358822957 -0.20302617113107457314 -0.022788969285494762446 0.45092132405688434282 0.45031829837679870909 -0.11073627098583491146 -0.013775802238383545728 0.038435675436126880145 -0.32556112707445761245 0.017635919319721447135 -0.59294139743484675087 -0.037953208267565152756 -0.094028031722428032091 13.514798545266252461 0.13735143919157233316 0.043853151554837689619 0.021585917980331905536 -0.041117751734270388542 -0.66309014922054254626 -0.0022036270769373303077 0.075113329991228758309 0.66559314138566993968 -0.58192926793517851802 0.0085360812351273941678 0.037201242585846699962 -0.28374373912796518882 0.047127233447802487076 0.0003949537672281759268 0.023834956848747444746 -0.038302101839663628413 0.0015635865933170210035 0.0139621715671743446 -0.049702693886597121287 -0.22321373175118236487 -0.056418383837927889302 0.049155091753672441879 -0.15303836420074598546 -0.052907982373480752503 0.45449861429193527673 -0.12336151274495221752 -0.056756343014725790797 0.64041085869508362904 -0.0036008890133083200705 0.064872636030825894804 0.058602991228063998352;-0.38780736325872694481 -4.0435776102253413455 0.38202839877343658381 0.058779893354271410544 -0.032171073177218401096 -0.24654783445166236766 -0.30297836806728989378 0.13514554056371777535 0.063192517356996116829 0.11454814737264748525 0.40540025490226000437 -0.4036023988890055092 0.30654204856678779478 0.052672658513968406702 0.062121509467957948536 -0.15141266475837017458 -1.2046878675447998397 0.12190461727935963943 5.424944046210631754 7.8351444702499275508 -0.082144008206814611572 0.15831462854579486654 -0.10447530656976369845 0.01507574996904100656 -0.095269264332840261633 10.740594967802072901 -0.28823396062039141619 0.18368586202001277452 0.40150166454958219342 -0.293519136011460402 -0.0468504955576288587 -0.046276251615187453947 0.12383760996949039201 8.2086334155749742791 0.099747303471247675266 -0.044352866118077517721 -8.0114946765492689451 10.707285440552173128 0.46858064324810405621 0.015956563794152424374 0.53828041055423470063 -0.078062027197520714172 -0.058386418906689871444 -0.048821618386294007852 0.064008431803465395959 -0.31017006027996402162 -0.083079527808907469022 0.36653973427317199096 0.022565709023033068276 -0.0035354381060571380205 -0.15022746064762548812 0.28496261087363167208 0.14760194005730667421 5.428357029986552007 -0.078038829029389938929 0.33130427520982919098 4.0778764534208011838 -0.16732461630464215419 -0.20562940858961012425 -0.19876713741111876055;-0.091570365782919660447 -0.98579481917055689078 -2.2576149613043949849 0.040863408419398665472 0.0028386490848113783529 0.024182859128050453179 0.074029616624267297054 0.02952352159524418429 0.036298689356777352755 -0.073452438101939271364 7.9223536596503665308 -7.9640498393022616241 0.13822241085607678279 0.034783959944503117789 0.040758109392706909357 -0.17520015083458220784 -0.74100475635309437372 -4.1574537526850238733e-05 4.6864884130268453788 7.9236138702705627423 -0.14573010581772563587 0.075970625335369343367 -0.036661175119652875121 -0.35584169032066603755 0.033604900866375221613 -5.8289153797999793127 -0.40703161574265955824 0.12284123761337102654 -2.3444280470887344237 -0.14591572095684132715 -0.0041551230007021155988 0.018758521389523927225 -0.051187558269109541265 -7.7273931917751772502 0.037001894091558240607 0.058640410212959792613 7.7243883946323892431 -5.9429995453867965338 0.41704873483233401155 0.031618460946346016449 -0.41797649604806746959 -0.0046155577606455822776 -0.037320524399268042992 0.035501874916370822211 0.021083175461360289388 -0.072361717180414314443 0.0053724994849213185757 0.12200575999810807371 -0.20424283721042502115 -0.005041875107550983226 0.0072582898895153470306 0.14958825082519139338 0.095684534619430494651 4.6849065741473499003 -0.13166455274917931995 0.16166165096119841649 1.0437425424377666516 -0.044697751192209707327 -0.20334513168579779196 -0.12246882103121183027];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0579753468433118;0.0579849454384164;2];
y1_step1.xoffset = [0.0013069296719323;0.00083532556752941;0.5];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
