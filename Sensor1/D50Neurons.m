function [Y,Xf,Af] = D50Neurons(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 27-Oct-2021 12:06:13.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx24 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx3 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [2.83521284773058;3.08487845497184;2.96684631258337;2.91555663600156;2.87314405865057;2.9985735950825;3.30631252305862;2.95254437798033;2.82579985969189;3.09704332895814;2.96701078395509;2.91572103312021;2.87314405850797;2.99923115531801;3.30680571131936;2.95731169526278;2.8506968283177;3.09720772251683;2.96701069894902;2.91572103072373;2.87330844834688;3.01419066847263;3.30738962959272;2.95747608077218];
x1_step1.gain = [6.08210291845553;6.74398105491891;5.55278724701663;5.3336976607284;8.38189114807126;4.95733395138554;6.65541535692648;4.79359921650602;6.05282877727111;7.15547852684516;5.60394284653227;5.47261046382726;8.55740597622678;5.03357382798169;6.74998418665033;4.89139854924798;6.00310304229402;6.39649727767494;5.19858057666164;5.01490615866299;7.74234099710903;4.83928038179185;6.03342945294224;4.46464240378634];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.3966210658930446886;-1.358963152917221473;-0.74546915123122703406;0.82686716867492404681;2.2378692055095390501;2.0060033580903184891;-0.95728108482372120669;-0.9416950141292290688;-0.75229615293238016882;0.79703876663195993846;-2.2511238006499603159;-0.5397327467890575825;0.68989674344871076972;-1.5818413932331354399;-0.1533748276680167999;-0.95334864685166709197;-0.82428151896625001527;-0.13763257786620930467;0.64704028633405941129;0.37343412328614661311;-0.091113835871355172702;0.6511936564899390989;-0.45797910116670004221;-0.09488022682729677082;0.27689776259654547141;0.48834146281502038844;0.12937739900317393738;0.38325772136572044957;0.63654756099225173749;-1.168958373083080815;-0.8089501990907334017;-0.71701218005558864377;-0.20816622823348190918;-0.077728935190584089177;-0.90820118233288993359;1.0272856317375880231;-0.45895797579114927522;-0.23004349354685282858;-1.4272496949652162535;-0.59973643640965623725;-2.0768698651278603151;1.4938124233241039107;0.83725310351255011199;2.3319251527011899405;0.58202436223991738107;-1.3004122410096599083;1.0861159748943922665;-1.1884922897372303119;0.92140878110568535941;-1.9767089815104879058];
IW1_1 = [0.26937489343189979785 0.096223165194090382046 0.25095630307000665882 -0.22775107287459403493 -0.21799391093440165235 0.48214139135192340957 -0.13631700877538299732 0.15809337598462325225 0.10853786348983070209 -0.03084279444205838272 -0.45178164885435589948 -0.55002509471583449496 -1.0176117936063984182 0.57339776998378433337 -0.4188369939867703784 -0.015529274401832902919 -1.1028830999248353528 0.042520728160848487998 -0.97234658439332055657 0.055994828436219300227 1.1254912377479986407 0.53351040630546631149 -0.77294526005232655486 0.0063875015088929315565;0.40646945346711071956 -0.12744196222788300998 -0.53023010944179005399 -0.50258842059539399205 0.016749853600049251917 -0.045550066653806786654 0.2161213827929685527 0.44355815819231653174 0.14447247089444592572 0.20661035423357954066 -0.39651845593163792536 0.32436991414570115477 -0.58951236440345389234 -0.230795262142443669 0.62174458292706968887 0.73992229690404576203 -0.32421624230521467469 0.13848763897032309589 0.485987008453395819 0.063421071232810682927 -0.72231324183409006956 -0.74224079050510860522 -0.02437655478977027515 -0.30547728573732180202;0.55148345140967214295 0.38249630564825609635 0.16767558412852920369 0.71299853943487057073 -0.68003318473497520458 0.52092227886199671261 0.2465700954078061391 0.3789981783623881384 0.70542365371403481511 0.62261120481214182742 0.5839089693616875687 0.51832371227194318219 -0.6454420123414947863 -0.47437369990460753755 0.49029183736622850009 -0.34010472874855163239 -0.97155434333473500441 0.7171119869301773031 0.14929671568699492967 -0.21422876907153173831 -0.22158782472836865973 -0.36100065481354010055 -0.5300204027113439853 -0.2571461605894792557;0.15293546744912120405 0.05299702143519022246 -1.4198268237368545375 -0.50562400338507240694 0.50152371996825662048 0.74961974038591983049 -0.30822008325175598298 -0.94444752556213040773 -0.023594643285241093111 -0.37734530443675512457 0.24051805886205449014 -0.73658261040073846893 -0.43984295509685472636 0.35413339046812913891 0.060888971749202575046 -0.34925634694194318541 0.046877983500176280407 -0.2170310030977176674 0.81545549015649854141 0.75246425477658063219 0.62554503305942898983 0.36816755349544549869 0.53756572409474123742 0.97019329853170721556;0.058696440031093935485 -0.25317897343558726231 0.043759465776952208294 0.16434312481449780963 -0.308057224755065584 0.33022126761885345347 0.0080624091619573394485 -0.1983095065866962714 0.78385332459122369908 -0.84470084012911317295 -0.35629926169219394705 0.85734732648592704152 0.097958849018835780775 -0.92218632620246876463 0.079336866793864452285 0.68543333339446532726 0.59453145641373972285 -0.59626313417696041874 -0.59973973091401722169 -0.28687790642321803203 0.12607815946330030998 -0.38350244630901347831 0.44700208914067868227 0.10873679142290279542;-0.32366361207304561454 0.10851032082608813578 -0.43566743877281682851 -0.29143969716272466464 -0.49035583501894175473 0.18244667818743398602 -0.29530734241963080278 0.20358294266351179003 -0.3984331989221324144 -0.54156661796602900694 0.61626123805983945569 1.1251711981412124697 -0.44922460099924571564 1.3054987003045543936 0.038120253869905584843 -0.95148009682707423984 -0.18895317471405592702 0.20748789036622045101 -0.6523957312850188206 1.5446716254404904145 -0.43640737832202225466 0.19342576001043057521 -0.58295198718321095122 -0.28706671192028748729;-0.14343969660622996054 0.34244920291152503022 0.87893228907732590116 -0.99813013625073276902 -0.81646126216092673733 0.45729580121640778234 -0.18739963711384791112 1.259756592530949515 0.93538461272467410268 0.5880893056098387417 -0.50733653975553383297 0.88454515298178604255 1.1672424839179640355 0.49118412164045777146 -0.12307154638462583507 0.69958895779183849495 0.34283049390027220404 -0.1090147123472742785 -0.61064885216796849221 -0.055129208486845049375 0.26650735514351409083 0.50083780275538081206 -0.03250748101856165001 -1.1598528971223243111;1.2865212268673311691 0.31558671207561972416 0.31798985740016233459 0.95244636437834118148 -0.67739175230245751713 0.6543572051702728487 0.16762070873312640007 -0.55683906932767857079 0.48746309471155763182 0.23372126102400692105 0.22357920730447816693 -0.55958715873442621547 -0.18346582227370816787 -0.43632044041229117726 -0.109945029411126452 -0.33020242903222757347 -1.5766766849572508846 -0.63066559689888102014 -0.17685637804758086444 0.30373170040115793356 0.74443932089726627677 -0.0055389791820409095546 -0.012721281146779284121 0.34315551888841211436;0.28554289292340612194 -0.011278701631440651854 -0.20002347415484084125 -1.2537037505630375112 -0.53757157433827218451 -0.70148467612624032519 -0.13762073830153215281 -0.47838105448114537355 -0.70513084889568899971 0.037746551916491455358 0.24193636808175428277 -1.2258603045017919531 0.61993795974432897022 1.0254964235911927517 -0.11073675295139401298 0.26681920661988062227 0.33661311250723779942 -0.62525822621362681097 -0.54820880802003690846 2.3894331463839697527 0.18270151716555160792 -0.79096595397761915169 0.049135594829471190836 0.43955469926136414571;-0.62489354640116734352 0.21039803997830661131 -0.56713877209514784727 -0.43193131413282853659 -0.85468651752797519805 -0.27323764189199317709 0.54478713479439100364 -0.83510595448714119993 0.51220633969676820918 0.39125673929324678024 0.84926637893269696367 1.4586282922093227743 -0.47884816290841664133 0.12935743235338151291 0.53489648702379977152 1.0292412089764992889 0.092665857746488028424 0.21290406669363282077 0.1453713389462317207 1.119846708140133984 0.32094259868185459617 -0.68568581668598627132 0.72625637041766544222 -0.58738908950049928404;-0.29334681510850596498 -0.51691038068966110863 0.18454499460429338309 0.22817923997076275389 -0.017533144087262614308 -0.86078600821161388446 0.045300402906522471702 -1.0089129598469950277 -0.70792452770557745545 -0.31085812142517244006 -0.29815445019526165549 -0.33113532201187767523 -0.0025125263076156145736 0.090445711355402524934 -0.47342072195982159988 -0.34955503458784303872 -0.95809959174357217648 0.79525478366926016793 -0.34253914555146430798 0.081579330405904065815 -0.38633265908540620481 0.40079483151655193041 -0.59392251377463789463 -0.36431962141139018208;0.41437091357154487437 -0.21444007108047374865 -0.50652346132216541363 0.08939277086743593892 0.14745000890720294517 -0.35264480324318470128 0.068047837158221935461 0.7905319129716192883 0.12099735843406127234 -0.10854806981971507063 0.22060623573441845435 -0.12114229367787694713 -0.52508965453514211408 -0.18133101996904885111 -0.19454778884800993932 0.23519285356404595611 0.5450345454273488599 0.07445038708488826984 -0.14521997592862015414 0.05821070046925724828 0.22134929946732084804 -0.054678189933683570001 0.23959380719396006221 0.29840278766825589774;0.087656643468199263447 -0.21858808442021537832 0.34233712198361815338 0.69131754242617171613 0.1431236442132761133 1.0613292932719047279 -0.12344327379517429366 -0.079807133096975749198 0.092029924610723359835 -0.2426788096899700764 0.7384324923275912278 -0.11922021404843026471 -0.68484865882432732764 -0.41379271944156625906 0.047489473267630935571 0.33464336065254562946 -0.44396955120199899092 1.0164779938281682803 0.77727190419765124219 0.48648040488414623361 0.12405548980525424319 -0.46172225195212068805 -0.25771677288337707656 -0.023780740666126815031;0.31471959551001560396 -0.9314146155930221882 -0.73324514335840795809 -0.35938472065012361245 0.068284513785793185536 0.69816447013627092044 -0.2401361783051836063 -0.75571184960846138345 0.65309320182370966812 -0.46081338645209174443 -0.64025646493494714484 0.2409700022029793165 -0.14893887937802785526 -0.40448711707103340851 -0.3066770946619422622 -0.79158258029390604626 0.17631958024820831854 -0.99008763710072134057 -0.68027283301560637074 0.3027711129836968551 -0.33183475547167101682 0.10088808307990584923 0.096699120826810452956 -0.14665888420746825416;0.91745866153585242664 -0.15825689785696681056 -0.33619320675173075541 0.83645669042990511421 -0.32994919140676870484 0.17959354119473194822 1.0305477590315923475 -0.094860849236222635761 0.23475681914438512043 -0.028674381757844133456 -0.032144392883099573432 -1.0551007008043848945 0.75231417140761402962 0.85152990749939350135 -0.38968259037333258243 -0.038005090008532527168 -0.53575356308297161778 -0.18809956530682794829 0.39227350088047208132 0.44153913668672373216 -0.51956851114459290386 -0.020807994187136774622 -0.60995411227165441392 -0.50783390790615812183;0.26333725707805549776 -0.33477233910067710765 -0.13816529308332767267 0.13493149778239399428 -0.50555422098841340528 -0.40250117674292779091 0.28989946960742690729 0.85854428527611392763 -0.78727731423529523358 0.16106214194611825907 0.58952005958103870231 -0.1255472521778810413 0.69408467605772306008 0.28583438866277560697 -0.54692338691811137608 -0.17561454797177999954 0.14688093562010909321 0.16088127416753902899 0.15016599505586092356 -0.37170448533845512618 -0.55564429272971549434 -0.050257926582969486562 0.46347499351196908002 -1.2404149673652926644;0.67460135962478040561 0.61044107172873796063 0.048647304605979616032 0.7269144893073380409 -0.26997676505765777488 0.65156577868648679619 -0.1827392231185722693 0.19407238525832951059 0.39757429807690675139 1.0479499362062931755 0.068771496868953563286 0.083972241992657459253 0.064659823267933833058 -0.1727157226977877047 0.0016326868556692519796 -0.85564108311159137177 0.3908987145944872732 0.6435302630430999038 -0.35655774856450506149 0.38623327744154312136 -1.3675232190355657291 0.35665464758561010727 0.88351781789477534801 -0.090952580549998829351;-0.3290342362709508528 0.095479696886029530312 0.041532705431947064545 0.75466580074488642804 0.40181653189111526947 0.087384576090220641986 -1.4819009457349907599 -0.094024261724902899462 -0.47531119698332535695 -0.069664189067048465365 -0.061432736734906859266 -0.24350773021603663859 -0.6100415518351534061 0.91089626622675168299 0.51064543386891092513 0.26279702170006002948 1.1194240048312880109 0.46540656245514044898 0.040922276180309129223 0.077678991914680889375 -0.91397716532332384798 -0.4000290137755447839 1.1017928513275963009 -0.35021476392111172693;0.055301792629332824358 0.039567389283800477595 0.30544281982087156946 -0.57391014616772539902 -0.13497232799956618288 0.52204071600714885282 -0.32848003730906949471 -0.12680788643003060301 -0.1418650747983189464 -0.34816624602648477138 0.34021600407884894368 -0.067593783146553121366 -0.35056442727106851276 0.46179431318274116736 0.12239487308749613659 -0.28259484765591558197 -0.013463736738331871789 0.62636831902323009125 -0.19387723474504442445 1.4157200131441869395 0.35503998714336038045 0.039145142847336160397 0.46875225962880867625 1.2762833138900315788;-1.5061097893382986435 -0.095916934733341396857 0.32555000791170468633 0.70385879047090238458 -0.23990581562593896181 -0.14285026865525429773 -0.28146467017479998018 -0.12194804067297675132 0.19509371456326785044 0.68800553972494904453 -0.46865914238392963886 -0.28816231905778988409 -0.85981019643650524742 -0.34758697671915539384 1.1272259098943917532 0.60089652963838724453 1.2615413841858160726 -0.45778924674660692595 -0.39941894742465172685 -1.0306421727920500597 -0.249706366593087703 0.34849461735809778018 -0.42306372987656892803 -0.67616150817978892817;0.81581348516589369257 0.38241967150076539017 0.070930044003294362431 -0.92091193625537248746 -0.6567811148350165551 0.83188303971197841147 0.37260235737932173583 0.14734857089760838855 1.1786023027572447575 -0.011434108695617138662 0.32707131402974093382 0.34557575975053511641 0.10879308303913956535 -1.0354698239572985852 0.24389591332322901884 -0.19550260499743191134 -1.1677967382054807999 -0.98532004000976214364 -0.50509975699750209177 -0.0059189375447847268619 0.14848899896461062453 -0.68410054322453994757 0.46756289536404804785 0.74804313041008840823;-1.0781192074254148938 0.60725687074789769238 -0.30233467103439326529 0.83683529687301649869 -0.87515206918666499369 0.26632953417947047292 -0.29620374056631099124 -0.010292134963826443661 -0.27197132023081410646 0.67991439177248624848 -0.77858660451211181286 0.0079312052484052444901 0.11755165384991161925 1.2589927689742816952 -0.21312474404084852386 -0.8768887729099208439 -0.4077094499673721284 0.74305668141719516395 -0.11595517862716177293 -0.41432158873043495317 0.54810024787125488643 -1.6657375839031249853 -0.17426579458538632439 -0.44578300784777247223;-0.1454585739782381093 0.46107001746582015889 -0.1037789816378466845 -1.0463789007121366836 0.4265794106475473968 0.16917333252373423225 0.11217283465480894222 -0.13866577539217536663 0.10411183796569084548 0.11876319177313138242 0.21060049024698554443 -0.62865849089034020469 0.25347491576645569955 -0.63961585437956869349 -0.49861073099674751985 0.56129661074058867509 0.30846291649371493371 -0.20154816963820304521 0.5861732402050245927 0.099305395926334444345 -0.86485667418441347642 -0.44767008659072105026 -1.1998711073283723216 0.12762060393469520925;0.31314213045069494434 0.64467854413297620564 -0.40195731031081016749 1.220394999081167553 -0.12177773105355062244 0.99494097376058332483 0.016021118248647964188 -0.051062626788890938534 1.5466484681470127338 -0.11771275180198842447 -0.70668729224937876232 -0.62191656975581188771 0.1301758776340029844 0.55505211749906990804 -0.6740483238864227733 -0.27532746320084322544 -0.36254883437516061129 0.48297294979944160875 -0.17343384335050537892 -0.29396145621855579444 -0.60733344703447100787 -0.28401486261902586516 -0.03133241025328112328 -0.34079247154931258112;0.31289067376620488536 0.18678742370727263733 0.63411677719953618571 0.36260072294683765026 -0.13821363490530000351 -1.1693739630080919323 0.71491717991678160882 0.59090996660507955074 -0.48696937829048364543 -0.67182431098727712904 0.29760537300876027667 0.28634370102947614978 -0.71368292421338097586 -0.43918540140721601395 1.5351672471007908882 0.25937421217879125246 0.44029330176306163969 -0.63417308548995776629 -0.48206847802864444263 -0.23083991640453044303 0.031661118515659225636 0.54210424538837576058 0.13900948374482716141 0.19117822595066358282;-0.5591469912489048788 0.88718514442747797855 -0.2515916876799893509 0.042837457576230669742 -0.56107082373131877961 0.91315076068905087769 -0.14737168620910887085 -0.58221195723451402149 -0.25980638107445497287 -0.79161202189899404491 -1.2240704476060288997 0.076565188004675668876 1.0056889496915446536 0.97439893658327780823 0.47742236209715777084 -0.27010958767783893597 0.24033654973044993319 0.405758803283691738 0.68955073125880450569 -0.27043059883617881489 0.93168335589033934863 -0.051556821090064236524 0.12297235261385285054 -0.29177325050750779756;0.058398692551401468198 0.39555217799682546032 0.19828412955076882285 0.33133075461538280537 0.50468738424432846301 -0.4118861525794371703 -0.47219727633835661962 -0.099303450717764682465 -0.42619213070135547605 -0.27239204141953166083 -0.47710934131005428016 -0.78461371363492327102 0.14038050130519799663 0.64576632623118690457 -0.44009383947704422413 0.62195602488317203171 0.11045663538604907905 0.45482755206488467703 0.37952437690346180199 -0.46019243874266396732 0.41386593763249718281 -0.96522020753912252111 0.5311763058935803361 0.43553069907631719593;-0.96831601361744612522 0.73247099990113917478 0.46231975528216140425 -0.25904300396556695363 -1.1388587576376829613 -0.4862520639579069881 -0.42867830606959839157 0.51889396627639705617 -0.75705930365348983457 -0.083558459197598744517 0.36267136790778159439 0.69124114555003612903 0.79383283915703839462 -0.050258408556651312793 -0.28951012619722921171 -0.088179453189496367904 -0.5520566953816919975 0.22025083227722730417 -1.0762033406105819822 -0.37769705764144134719 0.24732536215913358824 1.0905476835890217657 -0.2031062183064774318 0.18007144889627571538;0.21962644858519592139 0.15885362357264373734 -0.019953410805844999654 0.10265669947896408076 -0.26096206225606621842 0.097004885624681791434 0.1543754567372981612 0.38189890314746133271 1.0973274880476981963 -0.3553847656866371274 0.101965285510553616 0.49659259934996669017 -1.2926881164509322897 -0.14750724189800326624 -0.17546870502019173976 0.61609061401581843853 -0.90914956949673908504 -0.3606177598271179674 -0.90566656323841199239 -0.68685043786177779612 2.0226753081736124074 -0.059954485759168174575 -0.3588430411966289646 -0.081320839248754911432;-0.099739265390323600391 0.25436681908361258309 1.1488698515806234912 -0.16328169423609109612 -0.30412473894613450964 -0.099211029300098008132 -0.28478191293957338948 -0.49627815390438012599 1.5021039555576782831 -0.32978244427089553614 -0.43138195281947411264 -0.12325591762399004669 0.98189501785233723741 0.41309214122728865615 1.0811141669895911743 -0.19879778493332816991 0.5177163771500120637 -0.46341365346532698011 0.11814196402495789895 0.94232167806363631435 -0.29258428869654218296 -0.21243775582684856773 -0.45927892612255305504 0.30571658605368123851;-2.0687419927061934111 -0.4108047779322681059 0.33247976612971841259 0.25741482325587039526 -0.40047546224416963323 0.38795063090621789703 -0.056786461420546510692 0.28588891784959097331 0.74238468229188558922 0.48751730373579094113 0.25850514023342646697 0.015351679034565302029 -0.077865856671992847438 -0.12790237744457189084 0.055393489016265541613 0.4157077240369280724 -0.14668907920825369207 0.939043180751317208 -0.50360371258789971005 -0.48144832467352582928 0.030428550249076632972 -0.012023762874510013354 0.72419737286866103787 -0.10949842062816261823;0.16241237658970744673 0.13011825711879676515 -0.36743086659380813641 -1.5254117751084952381 0.1611388203848634626 1.1302808672696698089 -0.77771126006156543475 0.54362970919392383795 -0.21787420785180547367 -0.40407265735746428215 0.0010428232433044165584 -0.067862826974276577174 0.29244581649604217688 0.62061617871760632603 -0.32019620382105706824 -0.3933904227188335101 -0.46648617448425838683 -0.67178298860380547541 -0.16273993316109769403 1.3552895852162778478 -0.40269333840160748128 -0.59691453469427280254 0.095378265979178949996 -0.10108771844595880463;-0.24088070141351705655 -0.13730173700124609359 -0.79668258435437044884 -0.38672457337379428921 1.0363090456270738215 -0.1458017026802205518 -0.016799984864772299353 -0.18307426399138318485 -1.0899759658139074325 -0.60595913842997928267 0.41271596170068075571 -0.0089926271894314596667 -0.71045131025442465056 -0.68375174949833206206 0.23741417685771806778 0.31208293140387760589 0.97547646082481009877 0.27898369072604767283 0.84917298394509321824 0.52954939683269297568 -0.60214895056498485282 -0.63441986766112434815 0.062275820805557491333 0.1724354045143815517;-0.092824842143448410559 -1.1003679717420615791 0.81618311962314249453 -1.2420811208369824108 -0.45201728337914770517 -1.1932767976253486619 0.94374970183217721242 0.29402882794242973796 0.57108944835893427072 -0.17325925475706166479 1.0623399294208630828 -0.36565107956022957492 -0.27884883138277666292 -0.74083279122272505113 1.5450408718124446494 0.53812249003476508857 -0.18288810387364540233 -0.31073860306778927631 1.3886072677787075769 -0.42017463038930230601 0.79148150068679257174 -0.033317964824049403627 0.53003487016230055318 -0.89374020246624175101;0.073790581808402977426 -0.25986829323698956706 -0.15571468330726248586 0.4546935667723752128 0.13813605923232152861 0.55889434284309214007 -0.28426420113162881309 0.32261422058529987122 0.80943609297766550004 -0.486390241775385479 0.1114713033165063566 0.028969263203280207208 0.69618303025664651784 -0.44956189105551763729 -0.18750664462782995479 -0.86982066928242107728 0.081753144231711760703 0.25113416697970653013 0.83334060421078737235 0.83929076976804617427 -1.9190196075354957195 0.90188759853652844534 -0.28573388065945404257 0.24735150394462498968;0.2750751083487830706 -0.55263586955245314059 0.56411677915808988715 0.02568341148854433667 0.15842835748449635158 -0.66336363093554107095 -0.60769133810897846271 0.95264496935652553944 -0.36768875175623189078 -0.070814776172027665835 -0.60370386086115113145 -0.20785251743899829657 -0.25472579917223664436 -0.72675828095631056502 -0.04801037217234763177 0.94948556940523221037 -0.77787226451747959466 -0.84251098975631300014 -0.44796596251309989123 0.24195662485377339435 0.37779664101876953008 -1.0160869905797820234 -0.68437160401982266578 0.33619957733713584647;-0.75083242438972952471 0.31798573219872172668 -0.42020512914056740161 0.27806559359972166101 0.24991711264061960973 0.082729314127827802139 -0.61210270939286837155 1.6066196531678822446 0.96961865409051051223 -0.1193564189208303622 -0.83461299285922163627 0.10896807015214612924 0.53589370751990328401 -0.086255956969617339491 0.3185794345797104965 -0.28258430643094878398 0.31255400884608625089 -0.43869346259184005543 0.64275105848849189982 0.14222323969550496048 -0.28698322713961266217 -0.1093846645664235534 0.81885134896755629175 -1.7631893540380698671;-0.29781035728719995603 0.17578329000557996187 0.058356866208345514746 1.4580852501197250071 -0.40012567087870232196 0.59972862446428598648 0.74592901369118891353 -0.011766974271412988795 -0.21857631552431674993 -0.55781067022459929206 -0.27921110233073687112 -0.31010474861098352717 1.2594808171927294183 -1.0471827104234223693 -0.55881454021207077609 0.63733850829985572162 -0.069745694510178340986 -0.43171854190400882345 -0.25739047478498783272 -1.4778180508238618618 0.1557269645015762205 0.022045005615469182025 0.29273900106386996356 -0.066805548328534164471;-0.11127223104468061954 0.51845588116162044656 0.52062680563503960229 0.32263922700398611765 -0.8459669142161720945 -0.093505038475856186442 1.0949066848774247074 -1.1037304007310011489 0.39716809873280017884 -0.4383696679041395039 -0.3721749682107861612 -0.19556128238799588837 0.71284410825388344612 0.23498073949484635237 0.30837501712765597039 0.39439617601022763926 -0.18618741554442208574 -0.025013576616399496588 -0.41628362698986487445 -0.57870374783702016597 -0.91406807870163020446 -1.1140925645596173599 0.12927481628671722014 1.5608506605987069182;-0.66286401537337125145 -0.61012185129419127527 -0.17254540495578143955 0.87572727171565201143 -0.28255992011916475359 0.79715382684987989848 0.38276676886711080705 -0.31436755515103798064 -0.26252182380065913758 0.5862441930562057868 -0.66754004995496230013 0.25700823184901100404 -0.072713658014876683677 -0.40813898903409046026 0.54440886514860287182 0.71294065571067555265 -0.018303147513335071145 -0.57861389342423896753 0.10534274556606969264 -1.0528825473359677556 0.096386504556844873615 0.30795942376081109071 0.96799638900049944645 -0.21566654859502490393;0.28645604586570688754 -0.48702409342384139768 0.27774895954298334244 -0.29899906512615992416 0.0063935013787519007211 -0.1978380696893607682 -0.46437006836970345924 0.077748777311669764467 -0.10911041026485618355 -0.68541142839456981051 -0.11644244018980179356 -0.83953379609261602479 -0.32190120726857041067 0.41055841236361828583 0.54865794102062148685 -0.89700491557254280472 -1.0427120492903039217 -0.067185372325337125443 1.2600811422174071907 -0.42276301945350119871 -0.32074231686623011495 -0.35725686516726862241 -0.54377448595110666751 0.026154404122406181565;1.1031344716797333305 -0.25255655630091788932 -0.83739384771554403741 -0.610236578756720216 -0.12240834390151372757 -0.47196716281946804461 -0.51641529762203908227 0.68994081505302651269 0.88891693092477408467 0.54064411042992277512 -0.26658577258037613467 -0.72045944911979487024 0.50024951759837910092 -0.21671357509350991366 -0.49069637503397411926 0.54849241633310730215 0.28036204701506017845 -0.079200108966194185389 -0.29057336062072769423 -0.71108801035578361738 -0.079256709206630721054 -0.23491933039040779896 0.16535209506082473863 1.0296959754327876801;0.42849394612891378298 0.29652887003142835987 0.33129444767779386849 0.015894811974363771967 -0.39049802865125127216 0.69543255692005556678 -0.1154606105519231235 1.5982818103220512995 -0.55593201457990482073 0.68246423143045764625 0.45748972835014944938 -0.19898162643156697138 0.090310913735901027222 -0.25962968488702575787 -0.16865030788230422898 0.22321423233108714235 -1.0508686764010048975 -0.64658099989421702336 -0.16664436897010700966 -0.20726636669480522079 -0.27314847704842570852 0.30406659812943814813 -0.27317462076048465436 -1.4652628693167872864;0.90240508190664525667 -0.9999713927939888336 -0.55652537456903417024 0.91581972823672053163 1.5717682731012363462 0.70057066621942365447 0.89752878482908615698 -0.53212014101411064804 -0.20747513902206210501 0.30250204295480792593 -0.48117222898129363706 0.073290704867342862383 0.70377190551427504239 -0.30653564019605772373 0.10167205333549841906 -0.12767510756718947196 0.96259521686676685626 0.1262984678801949423 -0.33585876479126075544 -0.28048053401415035113 0.59962440470101441292 -0.51537436745611686639 -0.012390198849202709724 0.35870029372371747822;0.98391455848666398154 -1.0255587933104828302 0.12261341826706177727 -0.62403395589279719857 -0.49152554015870020265 0.009687726709678004533 -0.3357155954866476999 0.45593714519872363677 -1.0016391047486681298 -1.0626010104390877231 -0.081726814152385057755 -0.4943210486058409181 -0.24867573474093873642 -0.039276557863989126906 -0.31528340723388581512 0.38565244452045854828 0.1146683771396333068 0.10579088742180506322 0.067666978204248717788 -0.63617025893072587373 0.44062221710770244076 -0.54166373098562958788 0.40294134308890522389 0.83198411317434206591;-0.30907560255550420303 0.63741974463307904397 0.23919721114606923296 -0.11387437935875274753 -0.10984694022672097935 -0.24746656908298095279 0.00950072760109563208 -0.5899636635608072055 0.073942750151170660855 -0.44930652154226413675 -0.45561033648448701072 -1.1010137715963446148 -0.1571017301494295193 -0.075268695027062779146 0.35990505450963411471 0.082736991697088105302 0.082874173188571709225 0.4861831905268551024 -0.27256950748988317823 -0.29145925676260064918 0.70815489145124221881 0.50765173037597111083 -0.46688953828482426811 -0.61380544916399504274;-0.07833265047180765217 -0.069941671713962136336 -0.25585723277518179763 -0.39086178543877841962 -0.14808754395402357051 0.0023813680746996995774 -0.29618241174292431195 0.45764276542047727103 -0.3668405176631197584 -0.16852730093771597919 -0.6277908096906372748 -1.0081546012735511653 -0.1767561753822680104 0.98645126253210857481 0.50742632542196053347 0.68030662453322687799 0.037334928658870156215 0.72568413910750029228 0.84672894751191252194 1.244264114545416966 0.13581543446269941922 -0.49331197011525818041 -0.68303392663389339567 -0.30844530078877213652;-0.80751003966981960147 -0.18192388373335877105 -0.14686358320503672958 0.044132060858450603003 0.39841814869435498991 0.36427515000318411165 0.4623109551340294221 -0.41362981674437870883 0.9906517787888837745 0.57866286070383554652 0.30682935217100687497 0.12793580149599875773 -0.75618969332258345606 0.59097293845386855704 -0.85234881127706141335 0.18803143528476551349 -0.22354940612690943347 -0.32259780041730012901 0.55475139939880446782 0.6105809965336632672 0.14467642119844537074 0.12254774652010022584 1.0616657484960869695 -0.77315883550734421092;1.316737242106373218 0.45957442002691017979 0.45810911020818184669 0.0096687998330267400926 -0.81702164937644827791 -0.093077229847150541597 0.63638401315340797915 1.0076023351748770729 -0.034862518394690726609 -0.47772980889255967085 -0.75836930590759721316 0.58755294254574030877 0.96658433296643364585 0.8926219595494138126 -0.21738347526065149307 -0.32058143048245252293 -0.28694547804717568384 0.03557712596509903652 -0.62700491262466684361 -0.54424114930009415136 -0.14641223811943243627 -0.6969982623263308863 0.27141937996365034236 -0.55905833911678959325;-0.44463709460154721143 0.42929470683244985718 -0.16826963277370679539 0.038897890249889058301 1.036124178542223051 -0.27169453785117503308 0.83964507132090748787 -1.513784312414593769 -0.37180709486578333856 0.20484122601675502917 -0.049044061168349833979 0.00021623164082566759259 0.26047649685017232324 -1.0661179471665094276 0.65105198926205909427 -0.8323255021350790539 -0.1191376030657648466 -0.13674065456693276777 -0.088843898605378154865 0.41417948871536180988 0.089156883325471183999 -0.14994517302329876673 1.2746361492480666744 -0.45063341920635963112];

% Layer 2
b2 = [1.436214293463988767;0.15075874864670268938;0.14741515529165680198];
LW2_1 = [-0.16903939902200126877 -0.095600931485555651346 0.42280547353690772772 -0.55177576112775617023 0.09018027260683630919 -0.24405274690500133872 -0.34225700578028878107 -1.3058766260143137572 0.70997381054962471758 -0.24051547693031924413 -0.5895994514453353208 0.18897717474068895238 0.65433460741150084594 0.57073157306778710129 1.1774424688187732357 -0.17088685977790293857 -0.5768767445453581999 1.4180263049575518863 -0.11502854092010056375 0.74241195278701876958 -0.73949559585184876376 -0.079259601343868002488 -0.3535693342765933167 0.33105980247479871448 -0.083409943010272144526 -0.13771100637012079204 0.63866967510643479766 0.083151378217726112929 0.57333996706644019259 0.85355908723592388565 -0.057409019327647102526 -0.58137066629583100674 -0.42513829514826539935 0.038819100054229289942 -0.77141814013176523979 0.099892058491697827138 -0.43921028139478879293 1.0866563325441696009 0.59483523059485787776 -0.29708580897357672601 0.4212188859951301878 -0.11166691774475251409 0.28918495899883228661 0.47356175801085148569 0.054378019395977125749 0.73408418948453491026 -0.7848096319255577491 0.60570978714302348145 -1.2583788181372821402 0.1650138932557087823;1.1810197217591760221 -0.38125906610224868931 -0.22808468535614837003 -0.85090651274265727277 0.58035081855005488105 1.5446418283671223826 0.78996116987869524628 0.19973038590866692976 -0.09738125024199342783 0.17079704840262371901 -0.4846907701566769977 -0.35318816477194614478 0.71341403688271309846 0.26474168544524562252 0.39572313556802518608 1.6218814386069864142 0.13577493764500206397 -0.34169399021335622457 -0.54314556738051678053 0.37134605932148073704 0.58407920895981568776 0.41573694559120050185 0.23999059466057343082 -0.3273407473627834019 0.051939223985555289798 0.14812503635815393865 -0.51970752778162843111 0.80431532558001639366 -0.27430982866678937926 0.7933488015113417946 0.24964454388970527821 -0.60239916477265498251 -0.87081772314797356582 -0.023837581402344810294 -0.0057006783696723489774 0.2057945550727206252 1.5682455645764719065 0.37461814064903858901 0.53026415101776602778 -0.62900207148112396993 -0.87908781066716257246 -0.17312450939128637417 -1.2850377443180600601 0.47659735636715822027 0.67656501531226531654 0.77683548327051021865 1.6290955724039013486 0.13807077392962271989 -1.1288035413010064634 -0.017849453814480914504;0.40973845979255762995 -0.76261781747630452699 0.13127533881783062797 0.99710846358486382446 -0.20012679477121114724 0.33877242938696150443 0.20816997893722360979 0.44236628617593132251 0.75823901184524566954 -0.57486058676288864788 -0.81843066509084705373 0.92685887649381770714 0.37025155477469612331 0.81783123450747752248 0.064053521930646506455 -0.76694808825419791276 0.81373455431626862122 0.82114206407152501299 0.69552708066334578696 -0.12511033053151382477 0.059299913836989778804 -0.46842891561624572239 -0.64700527549758590773 -0.5023610075470059666 -1.0377781119718889613 -0.44748713686086294405 0.55173260590320327701 0.014199037088193727785 0.31227090561584813777 -1.0108174367453004461 -0.86971025231795906496 -1.1404082542159421632 0.52834990398570580439 0.29338947406671705975 -0.89387682240907562203 0.41745340486110238398 0.5827213667056366786 -0.2244640118032237841 -0.46954359556067049031 0.46307204676625501882 0.47902122198432578459 -1.1035309874336207692 -0.62217330454416674979 -0.28099389488643589097 0.24631072510667312292 1.0898431433513964262 0.37602634362979231453 -0.024494576672855407351 -0.038655243454156322513 -0.66291869909169764963];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0347902567774207;0.0347885551526823;2];
y1_step1.xoffset = [0.00856972368563774;0.00328247583666202;0.5];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
