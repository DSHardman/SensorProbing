function [Y,Xf,Af] = A50Neurons(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 12-Oct-2021 15:09:13.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx24 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx2 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [2.66321855609173;2.74985179914428;2.90256983703407;2.82119689217171;2.68015066236893;2.90783031771663;2.85686946545909;2.61603882173689;2.65943760086955;2.75116688466153;2.90314358396553;2.82251201279689;2.68015066236703;2.90898104528141;2.85752703121433;2.61653198815731;2.65938281487866;2.75083813638492;2.90289862171026;2.82185445404069;2.67998627296978;2.91111810772591;2.85785580597347;2.61620321486751];
x1_step1.gain = [5.9683402975771;6.33986345808424;5.93977885190939;5.02527002710446;4.36377240311537;5.11350543560938;4.75241041376776;5.26220346787397;6.0248093522835;6.40663337031236;6.64366733631633;5.16321939855403;4.3637724074627;5.12043898736177;4.59659887473612;4.69640964371606;4.9610734697665;5.44735749948121;5.3571848594542;4.5227053649356;4.06352525425561;4.71008909952287;4.253904020963;4.57064308262488];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.4664998776566142702;8.9393592649524027394;7.0750535999090722328;6.2805375394274483014;18.610090969147655926;-20.410525079448824215;-9.7691614137162137155;0.92761241797690041633;-2.4908219682058936328;3.8487459306973965667;-4.2266311582433537808;9.4026122857968950086;7.8092365968239487728;-7.4048893838077747276;-8.9116609788353553512;3.8037821449539750418;1.1818672236305038936;5.0289531077241331758;6.4067588135179232012;-0.92521300085318280981;-6.8810405560106149281;0.65136725759597946528;-5.2310936999738819608;14.413089492473430298;11.53654326143713682;3.6129882575980420967;1.5161704859403926093;0.27427293554327730751;-2.9146990828002738994;-8.8772025355639261335;5.4163560794502645379;-31.867968056632669516;6.5679280546839446941;-10.576697101210777774;8.7534662995169618682;5.3971197645421797873;-1.2107625935060053468;-1.9184655563662387223;5.3636272616825300119;9.3265240639684598989;-6.1295658283253047216;9.0732777299069784505;-0.21462553357106745056;-2.5952718890582304745;-6.1074577619508714221;0.69769177009808869272;2.6739173388887316207;0.19960040854142258038;5.8804287851219871897;2.8324103663278319409];
IW1_1 = [2.8777767537797314112 -4.587029977728518837 -0.59801080363526604167 -0.69221403684748017415 -0.24669017036360302297 -3.466540765827595294 88.65270134152954995 0.89926731987596209006 -1.9702896599386594545 4.4936206178950266477 0.84114715665843287073 1.3124617399626290482 -1.4989877199271526287 5.4541174552154041422 -163.55810218623253149 24.920172864504696264 -0.96165735244012717775 0.10522419894193597856 -0.30398111673051508852 -0.72515097582901943962 1.4226914599268127848 -2.5878120346166664234 79.516437383636187519 -27.511685044971095238;3.6802819234420964811 -16.224592275669902364 -5.9313489032800905676 6.5781567811215726493 40.589758852158887237 -14.505140311628570871 -5.4918866028439783378 -13.643408336795324942 -9.5658925112267443325 1.5208072117333852891 -13.256802317782913292 -7.419870364779460381 -32.48360754976055631 43.026077339147377643 34.620806438977645314 15.083850882924622283 14.560100790230706025 9.1373821123130358757 16.794573766424548467 -3.3101695516819815701 -7.2597703989631243715 -24.684415256316412979 -17.873915708748608466 -12.346144972057407685;-10.66955978098289215 -5.1870519584696133109 49.451864360351692085 -24.806341885811303172 -7.3328784080452340532 -5.3508878719947992053 1.3362953183238994725 -40.259250613605495062 -22.348527436101342403 3.1516528776363395004 -61.322284756984011267 17.645078031102791272 39.323258033451473636 23.862116907046633685 -4.5986525004779084114 11.207759392100797413 42.26937482570115634 -1.8264902409480987533 3.1287444450639187998 -0.10857855025278589922 -12.026678591089117631 -0.021254264484560372872 12.730991095277127911 29.647340090730729401;3.711680740662193223 -19.459226822019200398 -50.003964117873117345 6.2554012575916724259 -23.407187893422968017 -14.250383472184426026 -4.4052598073568347559 7.6025436259188579058 33.139934979842728069 22.687588489003097436 53.625907696848166495 0.19942599220108336855 42.792784119654363906 26.655168857764060419 21.138364228634621611 -1.9769058659557685598 -17.403076668469772414 22.019121018778076149 -31.368180899020106978 5.8409704864292733006 -7.3037491306482600351 -7.2378222988335476629 13.325962409930566466 -13.429386183555504175;15.010331974645762187 7.2427215234978801206 -2.0456524522026358071 15.323133465083852656 3.1592910604430763932 0.11333043524082148101 2.0930756170378241876 4.4112716317322595572 -83.250498089920412781 -9.0921998199543274666 3.3322973134207813928 -13.656699822315946591 -12.123146825854199449 -2.7621901068295371395 -3.4686460004789236855 -24.387133370096801599 83.387339171497444568 2.1920342046318719298 -1.9082264695965074353 -0.67598450303301027553 9.8108655480373201385 2.7134008141544119219 1.5763526940393530751 20.475784733655590486;-15.930131869135919942 -11.348497338684374824 14.500218203876384493 -7.805585548298835441 -1.0416414976719148289 16.475208380113382844 -12.796502882679101631 -59.813352221988445478 -27.613240969946584613 -25.711760344433717052 53.325435746564416206 -13.753168810163943547 -28.077829339837979461 -70.326593932472917459 9.0587939449578094298 -14.3600595485362863 -19.990654565060228975 5.0652878568844004192 0.3633409541529028508 -12.548877821231210206 -19.650936185105926768 28.713074751866535905 20.350206144885930826 -21.119641409084994876;16.622334432210394084 3.9389209479123823421 11.808353023742601096 -18.662144761425128792 12.213669017106226988 12.807017569318556838 16.088058793535893187 2.2644788770373813769 -0.89020678527015018044 7.6046152450726216543 -22.878586538417401641 24.700188949722534204 27.754731422756378834 -8.5075445092154087234 -25.719904414780366153 -14.289298765106769551 -25.038963389079810895 -3.0433088840389710406 6.7170205538344447405 -3.7702751438891071167 -20.976773984716626131 -0.9247196242357937912 4.1514922954756707796 10.481721959592372073;2.7644897353740214285 1.8051420733179874833 27.983305966043570123 -33.963660643698368347 8.6896948845112191862 -0.11623565751655441647 0.51511921856479359061 3.4836589852890242902 -3.8932110070827623538 -3.7758373223446368705 -27.037376787227952235 37.693436773598769207 -8.1202526935995109625 1.6051555596026261252 -0.93763377410184045591 -10.364814958310715198 0.65300687151318803636 1.7743393853735178745 1.7669850925375365502 -5.448943807955716423 -2.5169076633508522534 -1.5149097334354630906 0.50390209646950823164 6.3119470395929369033;2.4494439427023646516 9.4658463725388450882 9.7503891466062366788 1.0769956195469334581 14.39212866040471539 -4.8760903340736767575 -5.989438520782814912 15.134478491794185473 -24.87990320682973433 -10.618944593024627565 4.0604280902474556569 2.458300086581374444 10.643320724057113935 13.155916079736163837 8.2582781253764068197 -38.108286187407379941 24.229229662998015726 0.63261156140916108281 -15.232600567670383285 -3.6982057952082350027 -26.539684642457352481 -6.3598353779879337466 1.5229530825250585657 19.067318877686680878;-1.7271517428715004172 -1.8426208288018137704 0.011943689981428334823 -39.100279020863709434 12.943595117334698585 -3.0446063990196186033 -4.8082677772672246519 0.59731036324555075723 -0.12631916435132850562 2.8571949691726370446 -0.49365967700018953401 13.353828764526733508 -13.946759832996582062 2.1735163639445400641 4.8594563460748965156 -1.6929533308799831204 1.4529401054739632393 -1.553711116410666282 -0.050667536721159645019 29.291616115339174087 0.59013053445334051617 0.11537490327191403383 -0.74519965421811629191 1.2114571614802458477;-18.763612927121737783 -18.304996634744092887 -0.61219767544311709528 26.040409887164006619 19.724612330201075849 -17.848991004222384049 13.272598332893657869 3.8796895471213543871 -4.8792161544667065343 -25.342126310059928329 9.8496410238223468525 -16.236436797212455474 -2.9821286484482998347 -3.7932563828874110712 0.6544380155389664111 -15.448860474343021565 13.215410031075045083 15.044463534068810873 4.4789255323169960832 -4.2629755515180294267 -18.256986697212997939 54.625642621787505959 -5.5512800917949096657 -6.1975859234053363167;15.722763340768603157 -7.0707733350554384799 -5.799791563943943018 -3.2010931965189652892 -3.8826586052108909008 9.5395437659395732055 -21.966542356008051939 43.835065249582051194 -4.4264080306878401672 8.4599872707297869567 18.541456035270499569 -32.839893189620028124 14.05698579642406898 -17.080926749758468475 25.355414530852286248 -21.645014333398478357 5.5918205415998931684 -9.4373436291135881504 3.4443226955293040348 13.169142502081689017 -17.13270487590389024 -6.3071254056861523196 -1.4970594627089708339 3.4271845769079392063;33.212838879823010529 3.1524327887478222898 19.497301617212634994 -20.78135888691842581 10.704611728698759876 8.9693248119250466033 21.803376934992879654 29.274576235412006042 -12.909453668474132115 -34.481688686338067384 -22.409834800513365849 2.349489897797575555 -19.505058062989576229 5.5273760491351930924 12.427170198845749027 -45.614035005551620827 -15.653082982368246689 26.450070457105791633 5.7443828441764486215 37.673233722703983517 16.388994197382789508 -12.318903973949838715 -21.632797204275512115 7.7084186624781736441;-13.866928391785238617 -0.71292760802113719354 2.8739040199707819312 1.6329082102666008236 17.687121210783146807 -23.020428863638130679 5.2614819242720640702 -6.1460290291052031009 -1.5102889555412180034 -11.976809235299089806 6.7397598572846071363 26.458344580732749307 2.6527028757533002157 60.748644691107493543 -6.776124402281776149 1.6483648712208460729 39.980519521316139731 -22.341890450208143903 -3.9347696835408818572 -5.1302566502982536178 10.461060272195012999 -53.458180442223209639 5.3227479010738276699 -8.2712876639588177596;-8.9696594213179405841 -28.354197330378482889 -12.251320774163811933 -15.724123274358884572 48.559128190965083149 -13.391728136086010537 -8.3475442205009890984 -3.8018937257670515351 -17.703312208211404055 -6.0729447081515663953 -41.880964080138596728 1.7884793815088275704 -63.761988903741617207 1.7644975499431612143 11.718438448558865517 14.470731062737463901 -11.37063868535139477 -17.705265625659055928 35.188139563939387244 31.943908025546928542 -14.379879568503032061 -18.274124225646211528 -5.6832378923107311763 18.159834360974969059;1.8460702528819192825 -3.3303360143978313346 -3.8628709895234449867 -32.124456729010972822 10.102153818463770918 6.1205429597666665131 -4.3143691362964826652 -0.48919681978712481474 -2.2584193153738292281 4.1942235763775972401 3.2824517068306851009 1.2608939836382901944 -16.586759754039952952 -10.116397805905570806 9.9730736053997315338 1.0050065392998843716 1.2758621564224734701 -1.3860735191032529379 0.26720421171703057084 34.599579245956746831 7.3880622447372124029 5.6901340260080868205 -6.484143550487388552 -0.41101328453951452291;-18.200028005070674197 0.76316891831795541368 -12.094994837143433486 17.286309874301242218 -18.572468511361442722 12.284666223973164989 16.477246160793391994 15.610551931978886131 15.796481673587017269 -2.3212652711599459643 7.8469001808567027112 -3.461774256766262603 2.39913940478619514 -2.9575130199013277554 -35.108296329663993163 -35.962244663623323504 4.780312429312410849 6.3746501953038343657 2.790057175078543672 -5.4770578330781463094 8.3658867602515165629 -9.8228125251222007108 14.321325449882083447 15.716006041397800885;0.80883876421273226409 0.76665948221001012364 -2.4123886595555519285 -0.52593154944259001837 64.54499514584050246 0.45428967897588967695 2.1350277640795574108 -4.2521484195254526384 5.8542251499311239726 -1.0800119036638082815 2.0285532090030984342 1.7939629601426998473 -130.75689865484034158 -1.3204113652855007377 -8.34100465254756962 6.0406904308114137692 -8.2544650210697767534 0.4356974251156189859 0.08838573563773581554 -1.5285213018537981977 72.439268992799512148 0.43061402332407627824 7.0009092909769874424 -1.1224899465824351719;42.15958487331089799 6.7896711502435342922 24.924307822462758111 10.28914926405923147 18.018320086422104254 13.020159727189383858 -13.418284233650410897 44.539825228090201392 -52.341393294434652717 -7.7173493083007933535 -37.020187843436701769 4.4243594927171026043 -27.285348217540676075 -39.228895829964095299 12.334649626666136513 -54.9546265630019235 23.733432852551395342 7.4882431358824259604 11.210306664284033218 -19.311963365687383032 10.141404701423866186 28.100244279553951543 -7.5316790456027247203 12.307852545205495431;2.7163384199275375508 -0.54983594692736148524 -0.66196200402651583783 1.0873080726968815668 -40.480998072702142565 0.31465771310810092265 2.2417982623276531129 -4.6336613800205661562 -8.1187000150318677782 0.51378420966429527716 1.1425491219756511718 -2.1244638543119869212 88.183218382829011261 3.5592927191827201661 -8.3555902302445588248 6.5402853409168324461 6.565202502958541686 0.10196767382661087176 -0.43483441199552974599 1.0713756546398474079 -51.819367771325211436 -4.2661508224694157931 6.818410593926898855 -1.5538066976985998036;15.645947015064173513 4.1647336284164397924 0.33199087925090525752 -0.20718316038374595678 0.64664762434941880365 10.465442737887327596 -22.677809349018058782 45.641594647903289683 -2.9313223688716667503 -3.2764479239731318927 -1.2755230487222781743 0.28821896734259710993 -4.1773276888497399284 -15.009807845190064057 45.16446821799711131 -82.971696437776259359 -15.446325101015027315 -1.0586062342325495145 0.86011526321642606252 -0.28870612001163065141 3.4840150611298490446 4.8367023304083618385 -23.594742224513055362 32.945981952778545576;8.3127748266290932833 -8.7485675619693417104 -1.7145035276264302126 3.0836124181164534797 20.15141288895729943 -2.236265854155989885 -0.6540709555844229639 48.282247809353187051 -15.152344509860084187 13.930407601063432566 0.45777511902741657712 -5.0066236659193767977 -42.459825573138488153 3.9654585801165231906 8.9037753753457735684 -125.25758516764229 5.6871766519851485455 -4.1255555178550666895 1.1338186095455029534 -3.4916640350507561763 20.338295069446630237 -1.4024366371643426366 -5.9793619023001971513 77.985519367274875435;3.6464153473801226291 -1.002933426833746644 -10.053583331895829645 30.4507014868601118 -9.1060302351428763501 -9.4308881186352824244 -5.4758137530138144555 9.4574677792698853551 6.4732978057698780106 -5.7122102228226037113 4.3023044451448413383 3.3286218476859001925 0.97293069905926743424 -2.4943755448297135757 6.1584902742591447478 -40.018168019407866609 -20.268196287921963261 1.8368309602767143307 6.2997304656537576051 -31.035593412103104072 -1.5533979954835992476 8.9535311250994134014 -2.9323180049310191286 39.040738208424173195;12.17559112016364864 47.649092460131527105 40.015318593743330666 23.867112074628085594 26.408089352304177311 9.357520512309536187 -1.5041996003006410376 -9.1122463075681210398 -22.742112168863702237 -43.732645012310534582 -16.644871055629085532 -32.691479802116944597 -7.4506877031248155419 -22.889047326483595413 9.8964387216086944221 -12.7947487174996688 21.664910872055305191 -4.7700495517238827858 2.3638449604726763376 7.4701718275350073029 -10.214701392794291124 7.7631665125786222248 6.7217611091253095523 19.645784880584578502;-17.983600730082102359 -15.016960390749400034 -11.433548495483666585 -8.6354624630029785948 1.2976802792560182542 0.69857118497492431963 -8.7525927661757307874 -6.217993071569980934 -6.6707074291239969455 15.048522805184747497 2.2210447537914799199 11.23574444756159707 -27.672616500633736791 -13.045362699857655286 10.154091698108475228 15.633168153205618367 34.024266033368427031 -1.7542998596258587707 9.3663854574076292892 -3.4376869138232728496 21.274200890859614077 6.254643578991633035 -5.2766939832436223767 -3.9713319005950005192;2.9073457730947964706 -3.5786872703392829109 -4.1770019638630584424 2.0302220686318968035 4.9289233646171464187 1.922571166757660821 2.4488098574539463037 -57.245367256937512934 0.77606930186490297174 4.2777652025256811541 4.7872485940036284546 -2.5838286522256987965 -0.79303879903251384142 2.5497583680678261864 2.5094797552763234982 48.760455556640337704 -4.0817646727175738164 -0.33253503990649768696 -0.48308307751579532274 0.30006272669668687669 -2.6253779212895995698 -4.8670225233128086018 -6.4743564323176929776 16.667993772342818204;-12.716806900231349076 -1.4144899545883069525 0.51449527346655510307 -2.5072648354343023414 -59.387618660042150509 -42.414894998700660267 -0.42219670084678806443 -6.9503451843851058456 9.4068247297694682629 1.2962255763865559999 0.88253151933612306035 2.8126494309658993664 58.267636256657723948 57.399044127977717267 -7.0265353357516175947 -9.3515277793937823247 5.1995187714316397631 0.25229212812854817649 -2.3944724612632177774 -0.40001675968386068982 2.8828678486954233406 -17.659624520826277205 8.6071088356382876583 20.690346810358725804;9.3374047532132600224 2.5121185894841477904 0.081809893763684776724 -42.152996552485667792 8.1678774611786124638 12.581505788205726404 0.55851769094199965604 -7.7216176535328324704 -13.668082762797189034 -0.53772279419691326741 5.9940339651332248394 53.875323190071014778 -2.0776121890774756906 -29.392122349057999031 12.830104227229021774 6.7609971873693597288 9.3643292729118456919 -0.17390510887480231661 -2.0853803686858576327 -17.029137576282185051 -11.328266329474734775 15.634014834618215062 -18.158189522618556566 -0.51695369570135230042;-6.461815721188784778 -2.2075466478126024583 -5.5893924436740256567 -9.8194888304317586858 -2.5713562124696602851 6.4820805748801761936 23.125107518246565519 26.741029004947936443 5.8016006642892925527 2.9180319787053723424 3.1392016335854417974 8.6714827338448206007 33.82600893694395694 -18.645979865979246171 -34.286176034429630022 -87.605655355163321474 2.110096824205368371 -1.414753005387798801 0.16605099829476793749 -0.0070416714438628902339 -31.466425918825454033 11.905054754308672216 14.815329501340508855 58.07322754359613981;0.088834372795246654975 0.18409639864172680501 3.2269273856678424295 -91.795477955304676243 -0.40632496127047368351 -0.3468166962337767556 -0.039371996333680298052 0.16427176974433099765 0.14093681763555301889 -0.050515958123274591618 -2.6673246652980431293 140.83282883014661024 0.12375728625472073863 0.71520971836970415048 -0.21147445480506482651 -1.1356228767815399472 -0.22670668406192184818 -0.17099984316792823935 -0.14090187986812235943 -59.049559612544854303 0.32795166516853002658 -0.34781570241617071337 0.23322999840098240787 1.0762393647785652995;-10.206344543118147428 -9.6921338386334436876 4.2113108248424815372 -25.511105258561212139 54.591895409655229798 8.037368411213277497 -2.2529944625011264492 -0.55743965652832483393 38.051015851574405247 23.393329584100339247 -20.741003484521769451 21.339126580176888126 -40.71742790027641945 11.765347442040193116 -21.237355627668240032 -24.753470151021769396 -23.569305061297569637 -17.625317937296962612 25.313152991336348663 4.2101027224588536413 10.879821247854707167 -29.048136380974511894 18.792466710528248797 36.32872545331984071;0.46923831475143085168 4.5880541597594834968 -167.06080791896386017 -20.819124986315927117 1.2203229422718118169 2.5862048794291787601 0.15775694683016167064 0.13995764770494795171 -0.74436219468683995082 -5.9783686926222818769 196.55824525473096287 37.416913761111914027 -1.0961458578029208422 -2.7171099817892221395 0.51973919342521768261 -1.2241469758188601169 0.52860534678866455405 1.1735167893306621689 -58.904601815010416033 -19.391287147701529392 0.57925015724215656032 0.10554977507346222088 -0.30713650347403192997 1.038284635482682905;-0.065998017452178286968 -0.4016792665921266603 -0.27554025825343270162 -0.57674959987229079683 0.78891505721304999721 0.59083393371770054348 4.4062407474495755011 -74.080612318003502992 -0.30676228612337202994 0.48023450623250107938 0.083790982682400191872 0.66310718727045536713 -0.70208703131077432325 -0.96181609324888861501 -3.0920166458648532526 141.59999900985258137 0.33570763738411751875 -0.068779947321249257364 0.16501394804849545128 -0.12566195704732338601 -0.10727460346665859681 0.49039961980343915737 -1.7091315856317974564 -60.455345578778690196;-17.081417395211762056 -10.739425650552561819 -20.785022501462972144 11.815537298627663887 7.3843475074288802418 -0.5460868159195594318 20.561727856035645345 15.411975093858316654 17.250499685995674071 14.96752175364018278 8.5680381443718562906 -15.78316717794197821 2.9223998597459464044 15.171789486401397795 -23.195187846045222102 35.759289470071223604 -5.8592850357391617067 -12.760729704621391889 15.032109431858943438 9.0452144560406892992 -7.9657002613649448008 -25.236746714023961857 1.5209787364164739643 -56.862620401108202373;49.891652399992153732 10.764460590001052154 16.261918691315788266 -52.750979217943609001 33.650596691967741947 17.699582777221895213 29.920483234874904355 15.713520560894611577 -21.069577495765482666 -11.96644902620054296 8.900407167906049466 21.268418573351016931 20.305723120973112827 -29.259331474027813869 1.7152715274853065353 5.2028219995175479795 -19.748418824683614758 -10.920853640853986022 -25.923340935904029436 21.526629786403315592 -14.024923073721078381 39.076477538631486652 -8.6923385043368828207 -1.3953937184512841263;5.0382617320049725151 -13.258568183141338892 -1.3577118362104094729 7.9138324278884324414 13.142847079661347465 4.2126589439025989847 3.1913045114872344854 10.648475487830125985 -23.911916543790450618 8.7646337609213631481 -0.50735362791892546497 -7.4969754339121950082 -26.055415111734181011 -10.064096098207157226 -1.6810874970296389996 -19.898423708275895905 22.442079588234065568 6.5783300236603325928 3.89407163521211519 -0.49206395420064535928 13.742071212947584158 6.300588392047420605 -0.65298335768750992436 6.6903895585022032932;0.53066025110510917084 -0.81337567958743628438 1.7283886881544152647 -0.77522009024485349915 0.16443963116337417807 1.0501007025040507425 -0.28082566051623719661 5.4246521439842521062 -0.53389052318935359409 1.1097752319529154974 -2.0368729168062493784 0.52888477294125524342 0.90476155662069646102 -2.1893865236716583134 4.3533325898316297398 -4.8945546704871052412 -0.028647131325620030229 -0.39562170194277090918 0.35890022605308530279 0.51432569420411178296 -1.5240316693426549932 1.3649773692601574471 -4.5940615994488442908 -1.1289155699060053895;-26.054439864969918261 2.9334828996565081027 2.2972592793244612785 -14.591402090841722128 -7.0160392779425428955 -0.039791505156368089935 6.5311322480766769161 8.0993851098417071199 -9.8522677767048705277 -22.619108649837823322 -19.256042661120165604 29.834266062609490433 24.966193576995557635 33.198064178273561708 -15.019837319024793132 -8.5513056725966176685 42.079220921676323997 19.192477262264404203 6.5175804858594883484 -11.409095249390178495 -18.383147690344706859 -32.657561566238541673 8.6440494125884317356 -6.2879675474765157617;0.56355826344994974786 4.2412117720423125888 -17.62648471586592791 -12.903422488376072863 10.693780768727433994 11.016545464356024553 -0.41974920934897513858 2.6642106353646242134 -26.150470137773179857 9.2392234353339883768 18.407637599869101308 26.359342967611613773 -3.2039380294893100576 -10.517845901839686817 16.697521853254404078 11.579652743695882933 34.854663724929494606 -20.670892826784054819 -4.9597852588865825041 -15.771467869213015689 -1.6965906220890101253 10.976363283610956145 -10.253863623921432691 -4.9181246994906189229;-7.0898812687571579616 9.3488682337042448012 34.967869488413555246 -11.597373381025422034 52.755077181647230589 -2.5842816444678788912 38.70704564962824179 4.2334346211317424036 -38.950946335612648852 2.6510973867549276761 -74.434023952398902679 18.040204840156423671 -23.843609049584788551 21.445320865208245209 -35.686946922781537239 -10.38033084434370501 6.7330989145005837315 -6.4484602508968462686 19.165970895652357342 -1.4557040680759074647 2.0717814848660616178 -20.097130147294809177 26.697785321447071283 -25.61943625837068339;-25.948187528192558915 -1.1135722660001095008 -41.22543455893209341 -6.3881872943101560836 -11.089141872887525508 0.40932970524028938764 3.1145229907910909617 -0.13995987967438100474 13.41414882790969898 3.9974440528135430917 49.730314622072683051 7.4876806855068531732 21.710104213449120891 1.2646971534983786345 -4.9510244862463572701 2.4319322358957520258 14.942331052729807439 -3.4451814964353215665 -15.875557477782468396 -1.113986488236277328 -10.288565915900527159 -1.7064889575391046783 2.6397909036691609153 -1.7440974996302394118;-0.11458028181602578077 -0.13728906319345179909 -3.368250486555368628 93.533350035750672191 0.46058704752606782762 0.41030720854210550597 0.13382026219984904936 -0.14823627494520541514 -0.11039852004963199295 0.0039293424673722751606 2.9057456194431927621 -143.27412112882399242 -0.21625185026313242798 -0.82712601243664241046 0.028023719843517279349 0.98520728880790187088 0.21348651240688623631 0.16937866880650803703 -0.0012665631088610435073 59.915200649691477963 -0.29622130090099729749 0.40597003242750118179 -0.13304252888945455879 -0.93886144132928439632;-42.811262512804979963 -1.7048830681191300407 0.98761720621313386914 0.61489789729593435919 -4.0163170801209497895 -1.0584755129283558439 0.47986321185768282538 0.33912195454310606335 40.102097667023549832 4.2713037019952624362 1.5667282612905590877 -2.6010997937423070425 4.7995215425662145492 -0.37189707275745553794 -2.1337770086061560448 -1.9076067997720778102 3.1925290617678339089 -2.7965174029545227796 -3.1576652993075771114 1.982723165491298678 -0.88675021819230814835 1.238600395985698821 1.4845345677167371967 1.5408715901039362617;0.10554148242254665635 -1.8124000157052435611 42.352738352379020625 -60.705335958262573115 -11.992051814972414903 0.76389213880163109316 -3.0653161684033598533 1.5174944234228213702 0.070754366914010630163 0.034575344285743367378 -38.368093187418359946 111.12753195284392405 1.6935558963859722592 -1.0480032770177940549 5.4457740846704574267 -1.3813167670841119961 -0.31256306215667406523 2.5746145667869257956 -1.1669187718718163627 -59.660905958175234787 12.742488747927492199 0.2044268192934291517 -2.554710277618570835 0.58415434148316836005;-10.914854599640930743 -14.997927535573561286 -28.68557356851145812 6.5842162842281535262 -64.814333104115732453 17.491236581018924312 -15.62359627785043692 -13.492512444072247035 -14.75270872053887139 35.912420539812558218 17.812793962789974955 -18.610420812565909188 9.304331308732043837 -15.732609956206138335 26.923270178011502907 -9.9599625962631925802 22.004340564330469476 -16.692744984540080821 0.26339551421823426125 2.7697861897203392978 73.048156172258259744 5.1080582258302618115 -23.075179410206750674 13.708248380919485498;6.75798767073101736 7.8929844752360605042 30.669991929847974177 -16.871779340146709103 -18.990165945482107901 -24.367837588521094716 24.866444080665839778 -8.696478788155863171 -16.069805714010353626 -12.396932633427139692 -2.7243669643506955858 33.712571172652360474 16.320234945333140786 55.076798533578028128 -49.02951899677054115 -14.290059347944776391 21.087585746490880467 3.3637798226660615697 -32.294748199294325275 -15.210887354871559296 5.9486954025110803101 -37.573361124810325862 17.864873825729162604 19.743686224806840102;39.315850236829277264 -7.3493330954564948243 5.8246703164567197319 0.085056252194302697789 -1.2109037965875342202 -3.6975035130383662185 -1.9195400110498261892 -18.161185990570565707 -34.33348122774732758 9.7317882107829323246 -3.7420451204741524975 1.3984105841151448502 5.7721809045055358922 6.287051068549592614 4.7322043989715281143 45.474631743102577275 -2.9843296008646502671 -1.6415060032149437763 -1.7541659985201112359 -0.062679794736840377389 -4.0352775040055304245 -2.9365422980570188294 -1.5408424851642839037 -26.998158897770942133;-103.99290565666984776 1.3256815624863707015 4.1913484566002745524 -0.2898479178861032568 -14.76501502248000719 -5.2904940014119876679 -1.895432959818060592 -0.46880474238086167205 84.424065859623425467 -1.906981014717845424 -5.0165615455013243817 4.0915122381114255035 18.093687905085037215 4.5547660392147513164 -0.55722121926275847148 3.2981052868416860235 23.379417396907559379 0.66558945446199835327 1.4650706331381717629 -3.4649910038792111067 -3.9955705266427514744 0.28047438973789995398 2.5974876654679959209 -3.4849159341847508742;-0.078913978118390321059 -0.36505287763375110499 -0.087369208543278301105 -0.63528207666476077531 0.8124743149606368231 0.7468078617918731954 3.9696228785888552082 -65.569609347611418571 -0.35970030791350193766 0.44205617660897522647 -0.10680838374548186354 0.69522796831415767382 -0.61000829970708703165 -1.1621572604697989473 -2.3383603942655035723 125.74128456960760047 0.43025735494150285643 -0.068335413441980477622 0.17216560528268076702 -0.088371871098085100216 -0.21322742953675175026 0.54336820951191744378 -2.0641015792108121651 -53.917128996380149886;6.5534635855707827901 -11.901735708411916193 9.4220847865035288748 40.221018513981093179 -10.680002348435829518 -9.689922882593114295 0.60217831115898401428 -30.231269780159916394 -25.951785671774501907 5.5905713578482441051 -26.383882763034858243 -12.276611835371316062 -26.060419135072159236 11.135525225322242093 14.96204956990938939 48.803554371686765023 2.6185755529676781883 -5.9066518239659178136 -3.1646249831495540938 -21.962692772379146078 35.248488597234910458 28.657352224462055545 -17.435808749595359757 -9.0509145564892534708];

% Layer 2
b2 = [-0.42009782175962068207;-0.54503144180758811288];
LW2_1 = [-0.018384558610593147721 -0.029910145094839715035 0.022772858352825289807 0.022102911932618568569 -0.12060170720490162588 -0.0025426014127060956628 -0.0086629789683314185195 -0.12971037255131340205 0.066433172192752854013 0.11530439503709508098 -0.0072047017753996481226 0.014779288435847174124 0.022868149763274704667 0.02542704198409646496 -0.011213026490003807564 -0.13106060366246471971 -0.0046523767224855060512 0.060324351011807664236 0.0396954344695622241 0.047039890216116507504 -0.040397084519061120245 0.024404521409253896597 -0.02589666891392875675 -0.0025698610098337792973 0.055345429802837700639 0.05131919516075937604 -0.027334869658047392105 0.038559521609321759095 -0.0025441275317585566526 8.2079075675210955154 -0.045620620155448918243 -0.1613919879855087447 -0.41121325957579912824 0.015999530631984584111 -0.0074029790257472720058 0.076295403748897205887 0.03773625690357240714 -0.0081298317950207199534 0.024966877564952083546 -0.046136644743453164574 0.12238226000554390527 8.2117743828696401209 -0.23382624445376848366 0.12745543052176938614 0.035662448038801669581 0.037172822627355009417 -0.052446450109806919126 0.11207360113510887734 0.41894389861379721651 0.027208582588882538472;0.15426914579448347542 -0.0044141605039082296852 -0.025855123761325142506 -0.0059187893402130875575 0.0063984653576927078 -0.010870789794083445326 -0.035546840162538478891 0.03441904393106609561 -0.024434747586367114303 -0.00090069618084922370947 0.018651006417528703807 -0.0098851372185562169648 -0.030308551195911071635 0.014332653540566838574 0.0074796576890051209852 0.0080060593394683313151 0.048766289468287857267 -0.384160611459874346 -0.028750199471703614257 -0.37682766679182122527 0.13030353889317092264 0.037711497156936529818 -0.013735543475849437342 0.0016784359100648540281 -0.013587199328395539386 -0.18098600048220864212 0.075107915732822078114 -0.038681932013769820822 -0.058275431024241250433 0.10603956844703371631 -0.0040108478036525764543 0.00030457845125463544819 -4.8718858662495687639 0.020932553021107146857 0.036226163388580541469 -0.0041154084085740939153 -0.7269740674066916819 0.026403421312375784796 -0.039203484724771468783 0.017053842670615129012 0.008985952052464756673 0.10893721528206810889 -0.00099453118577257906482 0.0036049932213440064044 0.018054645804491575162 -0.042635047061698114201 0.066046004166601238183 0.022356281331227106923 5.0062821134934463174 -0.015203742565642427986];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0580203972083526;0.0579930615306445];
y1_step1.xoffset = [0.0277036075441027;0.0018311594452593];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
