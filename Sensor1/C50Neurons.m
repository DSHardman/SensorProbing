function [Y,Xf,Af] = C50Neurons(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 14-Oct-2021 10:19:43.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx24 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx3 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [2.74324441590927;3.03736966914116;2.8601572641501;2.78667506560042;2.89204888768865;3.06120625025987;3.26343821056319;2.79045599681823;2.69543887744707;3.03671210738224;2.86501837331965;2.78683945309531;2.89254205894505;3.04829657148566;3.26529003242687;2.7905499625969;2.74261865957547;3.03687649805281;2.86952748281293;2.78683944843519;2.89270644930876;3.06252137104138;3.26718750947559;2.79045603066602];
x1_step1.gain = [5.33375508020093;6.68837265126621;4.43373473336413;4.6748474831961;4.72839658732671;4.30029600384873;5.43418862126463;4.09084581797461;4.88809854297538;6.88130687766081;4.49030611302868;4.91761683012387;4.78606031299686;4.21685683832427;5.61026674032536;4.19606033904922;4.61364776228668;5.82949014140829;4.24121907924902;4.31730961546303;4.10470086448161;3.75864760768;4.81253778935692;3.60799833921081];
x1_step1.ymin = -1;

% Layer 1
b1 = [-12.63546195491566948;-3.3200141009894852395;8.9172169068133548819;-0.95241428270720396299;1.2994181168484963962;17.327503020906512177;3.3877896664534352666;-0.27294529320675597894;2.2574380133300060436;-9.0889449360380911713;1.4546611049592543807;-12.698743251202165183;-14.69567776713052254;10.348486132058024367;4.8738136824094571153;8.9477698653289632347;10.071283603959527042;2.3844352165947619859;-0.10000297377128952725;3.2655536793436201748;-11.986582702613052476;-0.21258493159406693929;2.0168121242449190689;-5.4450042993211651421;11.80542616850173232;-5.747223673290444701;-16.993845146855342421;2.2130986158264334129;-23.223468503845062116;-1.0182421556948419994;5.5436631187908416152;22.884649617233201013;2.3442816898775449275;-8.0080546989931207236;8.1751636537473970634;-14.841271713178384672;0.66138217872816096321;-8.8841854174923238219;11.518958763496856434;1.7818939585604267606;1.2989495850787959874;9.7785402953190416753;15.087610571515146063;-7.8261243092206385086;-4.1217157877658179288;0.57355382268753885011;12.535843876157185761;9.3781084613967635732;1.4274309117004264635;17.797113809011715801];
IW1_1 = [-8.919583322784481183 9.7704070751703255837 -14.138664587405775919 6.1293359078602414058 23.657697566914201559 4.3960382381311315925 -4.0892508637340423405 -4.265130197210488916 24.412648837049896855 -12.692448797120825077 4.5984454363200271132 -1.5147156536849382125 -21.316368851566036113 -13.63584368637491373 12.11774927214031905 24.554471349324131779 -11.098671636546873387 2.2411683615089006416 6.3935594918084959204 1.3826978610059663666 3.8805195425954202015 4.6490525073473945028 -7.709148572452151349 -28.276660757685863956;-4.8897422144161888369 -6.1957343369771917807 18.169265158176230557 7.0440511423528038293 -8.2251604964049143121 -1.9150348140704549493 -12.828815506631832122 13.463353326870468152 -5.9521778944757528507 7.265413645081993721 1.6503077296407151486 7.3908408203377220502 -1.2347276491613699001 -19.509171731705112762 -6.2967918038526748958 4.2093340242515200345 8.9720937208835831456 3.324864644133482372 -33.522788465420504167 -21.3345804484325825 6.2309645666423270072 17.107423852713857571 7.6892159893148779304 -14.21320301481914683;-6.8598378309222098892 0.38404667151084459498 -7.360291370619253648 1.2219893706369759911 -16.059484476951602971 6.9463613825398127233 9.1835745997597797441 1.4142068098461044734 13.142232771254242607 1.2241195312538106776 8.293442096783605777 2.7991227999767755996 -21.968739423694199075 -25.278721145709958762 -24.896271191952244806 3.5188063946889887035 -7.4393287468850113342 -1.3879894542383093281 -0.42585787218333492898 -2.672135146411187101 46.341212585614201203 20.104360157136166976 19.073645000228641067 -7.5539747990903105546;-8.8362336921017501368 -1.03982746903770229 -14.792012721368626771 12.97676690559819157 -3.2480250133736232598 -13.18265200698230899 -0.89226622055209503515 -0.65786971280792361227 3.9076341258971365455 -6.9169823294272561043 7.1763102900374438065 -5.6790697089523449748 4.5946391826924060098 14.48478881186207623 5.6056002059848664132 10.464538887696283709 11.532275460774883413 -3.6750764227631451675 5.4423455168413941152 -0.53027605535090938105 2.5149436483079825599 -3.5674713281209342597 4.6286842672822903211 -5.1838336548749115451;-1.2171728202948175479 3.3261896267597954591 -17.079840288926995129 8.5140617319535358831 -6.0035870963307234049 1.1524285107885834378 3.2955389155078740338 10.776452738883248728 0.20031977043999549259 -5.1639242236392419727 17.613513822474146764 -5.0200838206488302973 -0.82145769601151141792 -6.2173505637468142737 -2.9626034104971763483 -1.1414335261976713554 2.7050157739017182124 -1.1400850357549277003 0.24935779103472843765 -1.1688656268208750255 8.215467635132073454 3.7978807376938221729 2.1672940410204146744 -13.161356958786646132;-0.44065038659695610068 -0.34279757221573492476 0.91860500066589745316 0.13565927206732619759 -0.72025046964967365248 -0.98858065552683560551 18.579563478705541257 101.3605703908062452 0.37449606225989157116 -0.016514174981895168859 -0.86113852846522731532 -0.013630965695639707391 -1.3248616869005420682 1.630421472180668907 -33.429469804244128284 -164.84085596732751355 0.036194138416895407784 0.36227208518449877106 -0.089963702757206887028 -0.15510964496911550103 2.5568341022820040287 -0.71546331504664084644 18.297836990639840593 77.191140867998484509;20.088222541731418858 0.36648912390925558746 -5.1100384211611515894 -8.8319038304537542672 1.4793356160118764642 -1.1094957077035529913 4.1918008543404798871 -2.2095917669548121864 -18.921634051338546811 1.7031658885745561971 7.8311930577087949246 -1.7718277810180738108 11.593795350942482258 -1.8075724614946002688 -13.971792385917597201 -5.9437827506410307876 -1.4786038401919237018 0.2043746722118984227 -2.5070826413630911134 12.207206952287844359 -16.553142395292457678 -1.5630866316799245652 7.9747185629724466338 11.802816622818600223;-2.4897078562822505532 8.1769051726649948364 -0.47302693654673544366 -17.756341699418918267 12.150289219364378113 0.1940421359241248922 1.8865116431289663534 -1.9996371365903742312 2.4651301659267277344 -10.079886544394994985 -5.2280031508548301389 6.687964939951278609 -7.025375067027519016 5.1809609775564178236 -8.3759404074055190392 -6.6337124336402784053 4.8936355881857114269 5.9482593042175011533 15.730100079116482448 4.8569940312251933534 3.8812077577889931845 -22.09816808702979074 -8.9246570953233259615 2.6806650943002252596;-4.1246858604022049732 3.7504276895954395954 4.2682007982017218239 2.2000684458721480041 4.4765103586315220241 11.714183154482309845 9.9600996871430425017 6.5570559370925822762 -12.952198115173775506 -4.6153592105112162258 3.3831039088083700861 -17.143522466108016999 -1.8389850727010808029 6.3856309396929304967 -16.932831865388280335 -18.683932211044545824 12.230565282975925712 7.9862571546541918366 -5.3426878199690923665 23.7570600359027857 -9.6651508825672358682 -7.3247476998714855512 8.8433037539790628756 17.08277120264705573;-19.675713547647713852 9.8193534112585272311 -2.3199098150580752531 10.854082541537632522 11.144814583853793977 11.186459914648210656 18.723481931979449655 -6.6064724500531344376 14.983351754663381428 -14.065305126111017131 -17.015022547200622682 -15.925883163734425807 -14.578534765036202714 -16.689040065891443732 -7.3533401366854249659 19.786419127660650474 7.8908844235826940405 -1.5242167058665652135 9.6873214806360223861 0.35505291943536509969 1.6495482406801427189 10.950734722690533829 -16.738119570226956512 -19.434884201209047916;-2.551675784498351085 1.8289944031847207295 -6.8708478422723606727 -8.7895508645185103092 -3.5877896164342404361 0.56677930217167316052 -15.784645662022386503 3.0178496814029429629 2.8108603941520842184 -3.2202678401335407266 21.442272915393555621 10.442192169974438443 1.3276058569919473307 -7.4895205698416216222 34.829115015257343657 0.18622716976849185144 -5.5288971805033515494 -3.857249673337232565 -4.9575400750466247501 7.9690228466242469807 -2.433379527736394099 7.2814275337101914687 -12.418413234962880409 -0.70199414311823682411;-9.6650515656288717992 9.3520181155035331244 -3.8133196088379870403 -3.1846238235943697958 -23.191458146086169734 -0.13886018708217751083 2.7137424611960274667 -9.1199985390098650129 1.4804296244767325419 -2.0246144431278247922 -2.1473517847166285755 11.444620165102167064 27.501770933860097301 -10.811278913841638527 9.7346533893297486628 9.0999829627378385766 5.4575497594181570093 -1.3489972057316228504 -3.3269253899706630051 -10.566508505798722695 -6.9580465456553231007 9.4645329365748640527 -15.336955683966213115 -13.472284793801218683;0.33349957972539889806 0.096745624626842705029 -8.3436689275901549934 -111.48098130298147623 0.46357075236930961326 -0.24589459980930417071 0.2722228465332160452 -0.55632266410275288404 -0.13822525135229163373 -0.11933864087147064148 19.041560265469879454 165.57631432965027329 -0.8518582495401758603 0.080258398213276627153 -0.3040680356479682489 1.2245307847492326037 -0.23157964016556109588 0.048480829597421587485 -11.534309907562118269 -68.146746873344923756 0.52118229079560274286 0.086504472073361121653 -0.051380426170397598684 -0.83909764698279387662;-22.531030548927397206 -10.537365921411968372 19.121697648157528704 9.6225398589270429994 3.1729388073766537914 11.775283453599815431 -26.965426445051125626 -24.42768829702542277 6.8621952602340900995 12.992712102752461689 -9.1082098021404593879 -13.791839530530641156 17.782325971663368591 -9.1996965859265245058 36.372232028210106591 17.547258066209206362 27.529335315613838731 0.9647963982632790092 3.1481023016366105338 1.3255914899989087452 -20.071263563309393874 -2.2441637900189421728 -2.0393695727052425504 19.449623027013757337;2.7342661298103774214 -3.889230532336385604 -19.765644254519493472 -2.1732310626084134775 16.634005641321195412 5.5394077279639537537 -2.4509651886598127213 14.927349299410183292 1.4857361606962729006 2.9370423466862991546 13.261011716200655997 2.6536090498617177502 -27.896763285023403967 -7.6995251801681536818 4.4735283430415044847 -29.50227335900201453 -4.1384083436217231622 -0.48519311852039770372 7.4530880205381428993 -1.4021137384543567173 11.907774369212351218 5.8650934311031548418 -0.65221218548779769097 17.118378493744362601;-0.66893781631344306771 -0.52900278114806509322 -0.69462878019209883806 1.0020560861698728505 53.642976666710467271 0.11018255165970326781 -1.3318615256436312499 -2.2207044428981075335 4.6639904861912091505 0.52981189876297096752 0.64070736520813065251 0.4358800038019870482 -101.68517882972328437 -1.6863358352253152717 0.75114234421561687505 -3.095462170360663734 -4.4393000023830335721 0.031961881634155940579 0.14101656433810424995 -1.5020853471324038253 57.695259158468978455 1.6274580695132108143 0.55607278547464933371 6.1993415521578700833;2.4815576131618417577 12.107520184849777323 -2.2320299304287658515 13.440224453891692846 -6.0712241561073350127 15.495879320193212791 11.964036913971991538 -16.555162545855644396 0.69845414075151301958 -9.5449822066269955911 11.814386289830105525 -15.482002862567920687 20.361602447203207333 -22.310329174201033453 -10.140713890492934368 22.988521815527697356 -0.75304518560106625813 7.2447953725543197123 -9.717982567926787496 5.7092913948069856644 -7.8201041348773436823 19.677375172659495206 -7.8032056678430876673 4.3985699593018789955;-8.840196287951512133 2.4598710380802808473 8.3067694005904080257 2.1292927806768418009 14.536383032380493674 -2.1268538676208925686 11.584931257106998004 -10.511366798699222969 14.902668978541671052 -2.8508960108439840297 -7.6784423182467786972 -5.572991025809675314 -9.9756717100659422215 -11.674642480990373272 -3.1552773878106057381 -1.1661459308775414812 1.5982273165590474839 -3.1194878597551283228 -5.0533110829268448327 7.1247595430680554784 -4.0704655327342456062 16.250864132251820138 -6.9247888371534989105 13.622363285769557351;6.3043266769092944912 -16.976482831883618729 -5.2564063307213491072 6.6700681347533485877 -5.2092419539475631751 -0.14455143601305242562 9.2029654561541356372 -3.6823429604613888699 -5.2983003712080005698 10.127714180025167323 5.27846175399871953 -6.3807433628070082676 -2.0272208937540030504 -5.0684978807188745265 -4.4811941113733055886 -6.6604594417881664015 5.1511630472414449144 4.2952530442328820115 -5.1408585068319512246 -1.1399298801727886232 1.9720800753001115346 1.337218298489686763 -4.1646617441317790309 8.8567332756500576352;-0.37030951267884648637 4.6869247746371511809 3.3866829719920858999 -3.7469173161936151217 -22.981846986677851419 4.7443498170118054702 -3.3982071685123789173 5.9644845634425340819 6.3781580489450995231 -9.6102278264044240785 0.0949879206796420128 7.1455729531751517314 14.087890204963144924 -10.321509459853409396 5.7260093911418854518 -19.599811193367798978 -4.9082456328753281127 4.0786376758753606353 0.50642057375344395886 -3.5241168697058942172 13.116674177489322517 4.0883726296299141012 -2.6496130177979306808 14.812117150693573819;-18.003037579159524739 2.7121255313813694698 14.710092838511307889 -5.4372030389502601366 1.0558890792774824341 6.138422723564621819 12.276373037695384127 1.2995362246644250881 12.921310801591275208 9.8655266853795584581 -8.8892860356499419083 9.3705535815259963783 -12.551184812653339407 -10.034387866071440953 -2.1515570403372072938 18.174981587727732091 6.7165226759263738643 -7.360192886044822913 -8.7887336343486666124 -8.5805412065734358862 10.770920392968839963 -2.6736623489368751549 -2.6217358153274195054 -30.819797669243094163;-0.84528631044069246769 -0.59448448742453918747 -5.134957300100049693 -57.125055884362701875 4.1115014322614387154 0.11105037261305103491 1.4702602012292820266 -2.1807798455723688136 2.6938133756147779607 -0.040560172456648668771 11.917186835214037544 17.911405578972004804 -2.9857853371421470001 -0.99813327878658297809 -2.2588592075898223932 3.7481239648208402038 -1.7362692066100744448 -0.15659109200416054808 -7.6179072464778068152 42.298114384763650264 -2.2108895481652153236 1.2550617012787759208 0.77101967733874121613 -2.0678163183244904211;-18.761902105727237711 12.595762288211901136 10.320941285626755501 11.019549796483307347 -4.2347618641473623313 -7.6866834074839305302 -0.92665788240685653676 -5.1327561077058030392 -1.7700309446099886657 -6.3708665101380841378 9.7027228618847107811 -5.3666960185304670716 -6.0371951014384368506 7.0496191229028619674 -2.5348670918905602534 -1.3324736310565348241 22.918113729705741122 -7.045810638985778418 -18.85214699740523514 -5.3144256359501156339 13.945994984939272143 1.9555328086086456452 2.7564412200761032601 3.4064588206230084211;-15.585063759314460086 2.2915139837082643126 -3.7342695007168158483 1.871003410798184774 0.31543913470310003255 -0.15695809515696479419 1.5037148553693708841 -0.20686281817636115177 28.070159730097227424 -0.30800654716922248877 8.6645868158113135138 -4.4841978180483597072 -2.787553753343745111 0.32351531017002316259 -1.3594199922805176861 -0.57786641406554617451 -11.853350805796271317 -2.0267334717693383794 -5.1997241457100056294 3.2637782506674541949 3.0877562493812176214 -0.89292105772098095962 -0.5139506796952963974 0.62149621717102632168;10.613613278695098074 13.66244171208744973 -15.012873614693472035 -1.2219025122196476296 11.210872032241368856 -9.2499896768125982049 -5.5035405933089993624 9.2162603038874415518 -12.635556946258047262 -22.519871848484495303 6.6557364083932846199 -2.239374849696022185 -36.464027513459797092 2.5434541601300870717 -6.3319033611841657461e-05 -28.593652164298134721 -1.3549522591729226129 11.39581304873819434 9.3715201033136157349 2.9361698375277511808 31.972715852169340423 6.8091020193854037146 2.9857449269191325136 21.187150189367727648;-0.96048697043478936664 -0.87802615933235028667 -5.9291008393190489656 0.9388031108387728807 0.32783842840185850598 2.0833933447642429826 -4.3485179131063462776 33.808329346322523179 -0.92475428105539858592 1.0155159375512290421 5.3480556471212414849 -1.2570189651864884794 -3.1455306847138242432 -0.93541335587192087075 8.529885248648563234 7.3387112532712377444 -0.78958073204276801871 0.55913109869810739827 0.69387818173847437553 0.049612109234373980016 2.7783532489274502808 -0.81423548015479818574 -4.7532933655264439921 -46.467622027930872264;0.54551371040339657892 0.39363951369777588907 -0.7582980290905341203 -0.16088878703850201246 0.79207636726054309051 0.99105031136526544611 -18.548943299521759798 -98.607975856241210977 -0.51891915294071755405 -0.031246663447444186779 0.72837791039022203865 0.051756782100388976087 1.4433396570473202569 -1.525015351643153716 33.476724598358536866 160.81838927735810785 0.011863483033951766066 -0.37390337161002329402 0.054520117181530269868 0.1380337723296504171 -2.7876299459271192127 0.58817672592433778433 -18.39796309627199733 -75.620790448512764215;0.10884332475202729285 -5.7663692593750468518 10.131198686740582104 -6.3068287481670770589 4.1019203381126496666 -1.4162708033843660616 7.6026490350015416553 -0.49399582172327916041 -2.3397605543384130122 6.543693482811728579 -7.343090702554222915 -4.3443836906678487964 -6.2542411666600568054 1.3174564500140675261 -11.499921748107455599 -5.9008045805143947149 2.4774201969575533333 -3.0441138754929073507 1.8159896696381179204 11.666584645330088321 4.0505254564085628743 -2.4627837423726472998 2.1842003323767693601 5.9414619132769059817;-49.851273378975925255 -4.3598664580083328346 3.3910943420525665459 0.52455397040024664967 -3.4830657218615823645 -5.4383315850372921929 -0.16317992436215572605 0.48144796753925034327 103.60554734751819694 9.5618466948680040929 -7.1965518807361306131 -1.4697773884135525435 6.0938025405409872448 9.1682982250253761691 1.1294759333685442382 -1.0578211292975048252 -51.656180680969335128 -7.2287254591103176082 3.9361203505253001822 0.8898392047524756876 -3.3829679297721098052 -3.346831581876586803 -0.43826389545479582655 0.89704224799693166315;8.1968768478092144392 6.6291107671433611159 -9.0971761536090234301 -18.229797974611663847 14.382040263155776216 -9.8603256178187024261 -4.1811612508428259716 3.843539833188564625 -5.7659531183137362476 -6.4305816462697897862 14.557711665479365237 23.358711544115887904 -9.2943021598453157139 12.703255492770543 9.3451461438265432946 1.741722340021582438 -5.2205589798852285455 3.8684705844893638726 12.747758707105273146 2.5383775517097895147 -8.9047650902820443264 -5.2924152536013071568 -5.0558250711371535147 -8.2739254595045288454;1.118303736427495032 -0.22024322739402668603 -0.81647127057618806845 3.0185889536987442483 2.642258247819695427 0.66760488947777774094 -0.47221626330551619288 -6.512045643399587469 -0.68884809566931615166 1.0201725835874690951 0.96809932792759134657 -2.1162284373570545704 -6.0317420641340504517 -3.3846936382835250967 1.8625543528168151397 -15.790297129041135804 -0.74438383297893528923 -0.31598013878303549129 -0.0041351834497515005395 -0.65073216637789821348 4.0309202685797718146 3.0020991040018474294 -2.2375595695254295592 25.931178629781385325;62.971903973816573341 0.3689673070672212507 4.8569839937471996905 3.9598521148033718475 4.4836632546567187774 0.72770313507856787538 -0.35548753277462208366 2.5495487100057259156 -100.68961080061045266 -1.9706169974020881774 -7.0366951880298689304 -6.0738071222555829465 -6.7627594426048052156 -0.82604922650623480163 0.22398861861142460583 -5.7998127398239658348 33.969831232586216174 1.9521646593736148301 2.1534845531373725258 2.9294808415133051227 2.7827301903880816702 0.66313390346901257555 0.49845534641224148453 3.9334425823139458345;6.3651604285384433268 -3.4863180576096555185 -19.989600656363851527 -12.308085242236648682 8.2409756392193607155 -1.2491272248449518667 -2.1034460564329959809 -3.5536476419453544295 -7.2667852499815168699 5.799394869749203707 9.8081650764996197722 0.39894099494984902599 -8.0898506443259599052 -8.6815434505106328089 -5.2795981991325060534 9.1514446162873852586 0.58922517228597914851 -4.8327491845980379281 6.8519891121168976511 10.646331031965537761 1.7140533402948427977 6.6740060135476682035 2.8425455300928859081 -1.5123043600662926522;16.295834901542331608 1.7965815686138819629 19.738297795683884317 -30.139425220723261134 -7.1346174657449772383 3.0369008473461600595 6.141803296801191081 9.4050010463638979985 -8.0751807978340544025 -3.4375616330229306072 -10.166943044781504568 40.961615928328832581 1.9202592260767508137 0.0084709769306390361732 -6.4739355902408544097 -1.4257741074391834246 -13.202582346045979023 -5.1203827315685011001 -15.325858904754348089 -12.510532768395169256 -3.9917934442673033146 -7.3262941474168590261 4.9538741075446450779 -4.8371731523626619875;7.4778805214994319428 4.6430029737636804299 -11.852311270560221601 16.200428788303351979 13.676914589856361104 -7.7410667588510886361 -7.8197275096356682056 13.682623860688464035 0.75569825185810435286 -8.7265429045389772966 3.205290250100086169 0.62981815642435012847 -5.1289122141963217061 0.45455852858312750797 11.99903292585539738 -30.313103308686443427 5.9598948027000435701 -2.5829392840560934097 16.092805255144337906 -0.62004023242094097323 -18.301237272160662428 2.9867829927789220079 7.7422944932118360484 15.977283390876706903;0.26938896271797013737 0.12419272568039048388 -8.6939246070648845688 -112.70688725216774628 0.46664734139816010927 -0.20370175117370392659 0.32336287700856825023 -0.56787857498600036177 -0.077340414819612471331 -0.11435258315798058071 19.712743768841580305 167.55531843254473756 -0.82682301612665964896 0.021870279590635116618 -0.37188262133250310493 1.2738039840148462911 -0.21644174795584025794 0.010821823964430153306 -11.891414241280260811 -69.080895170991510668 0.49259105280975401531 0.10367526986083654139 -0.04109572829775799685 -0.88416498320477188155;2.2479406398849874904 1.0647189250777080449 16.94062405461346188 -29.24405961266455023 0.34515086584220766586 -4.3913881086265114106 -3.0184950145792894816 -0.10847313647340106613 -2.1344485829342145777 -1.1004623047263955016 -9.1834866550472149527 15.080332565828367564 -4.534190843881739319 6.5965615389677560998 4.2250247280623902668 0.61673017995610968089 -0.48993312818708728562 -0.54769104220265363292 -7.3819922132750708244 16.442507191602235395 4.0054443121177261133 -2.8816805709171715577 -0.65192807227977567219 -1.2999368443879810719;0.6441708563386394637 0.55196148580858561683 0.6628803325873793284 -0.95446966887365403132 -53.112115769899013173 -0.12327894876243537803 1.3447276715360094723 2.3745137747187410326 -4.6397103482022279408 -0.55433822983061231682 -0.61810737447943420175 -0.48210517147894521583 100.81875126209541804 1.8546968892709474463 -0.69149765956386977095 3.0961305098675273584 4.4335350041058925186 -0.035218431733477495449 -0.1445769231308271785 1.5027018368984230712 -57.289854393342267258 -1.8076575194895139198 -0.63626549082253192058 -6.3750565764000652891;-8.7818699276070510962 13.726409674752007462 5.9247044183078685364 -29.816093741622417213 3.7436131315778871098 -0.75903355648268533429 23.604474106941097489 18.157824555789495946 -1.9858123865735159974 -19.517861664132372113 -18.468257535786285928 9.5293929693415666549 5.6692748577644849206 5.5219001969406367181 -31.957214469419433556 -7.6025277848003156578 0.2882962244139428698 13.068822073952894414 9.4316591249226160443 3.5165290311360068998 -9.4889437262254148209 -5.4977746492444214965 12.987435286970629988 19.060822043375960533;2.8675446990056392416 -0.59106522774945258192 -1.3099473003094761481 -0.25960075605533472487 2.8576685124037424224 -0.54022651788992759325 -1.0902761290321023591 -2.2190495029250616454 -3.9884422221050916946 0.6146719954053437851 1.0443331625578733401 1.2880947704298635337 0.52858500741329272898 -3.9385389051319763531 1.0809323642171075885 -7.8463994070473273013 0.089184494791574753236 -0.087871111871003271254 0.51430573501759013766 -0.39529195851127296724 -3.7922354258805173188 4.8578569233085282519 -0.20355623504686320979 10.356037487586336354;-0.57020847934857554762 1.9964929965838751347 -11.963914273470177108 8.7287292457550833547 -2.4325969414879407005 -10.467604322741673073 11.844789407092870093 -14.706627450615094688 1.7323686321656290854 -1.6702007675298824463 14.131962709039855852 -1.8638649798374684607 15.605149904003111416 8.8693909908232448913 -14.413671551262405401 7.1889627072337960456 1.7533595313343923738 -2.5378624384141867942 -3.3431231511370960163 -6.7678723989598204014 -10.58328347635506006 3.0508686873490251656 3.6475977412445992343 12.12111030894123509;13.411700422457471404 1.6706375850434875829 15.216673378443074327 -12.03630612626846208 -0.84537644486840068936 -8.5122116679789847637 7.7793057841361985538 -2.3808522533471991878 -32.374932846734367331 1.9281470058657150801 -15.108779576184767635 14.666369191457441445 -1.8152340652337044524 10.844706998186278923 3.7719957981093261701 19.131790789223675375 10.276002225356775099 -8.5500457824620905711 -5.2259675614089546869 6.772634942835563443 6.2839128037354399225 7.4908083343671343357 -0.0066371195730204890495 -14.595753538899034041;8.3660812730363876 -8.5442646114546612068 36.40070057458731867 0.034896416491474582799 1.4771422315935860414 9.0185543972588853023 -17.50123277473524297 -10.03643110245275416 14.763993026782156193 5.1275447029873886251 -0.2759935067954608634 2.0693493570064136478 -11.358762921257483214 2.502848575732557368 13.988369069023249835 19.713799297431158664 -5.769225540931148366 -9.089188238108091511 4.0079609993875173757 14.704802136764294929 8.5676558618722129523 -6.7128110480010860783 -1.3742896969790716621 8.8718904569246159753;18.012781309273790953 -14.862398691707584319 -22.845537573127412401 -14.83555606230058288 4.3850998068145408126 -5.5410738864856075026 -5.139135130619068903 -10.65174819528414929 -10.401515537835333447 -0.97393674898129223294 24.466935101330097524 0.15965759049768446509 -27.604181620632271432 14.183119748071055355 5.5858246833517268826 14.679733392298485839 18.431683066110451819 17.866996879989009983 11.473588298635046812 14.812340403040780146 11.654023893263888212 -32.190310971455303957 -8.432291842166723228 -21.160989133114814109;-20.931642508225237975 -13.325996933144313772 11.660736198391461471 -4.5204992193632209663 -4.1714004410306877446 -11.849855214704140494 -12.1854493030864095 -0.44198818812756102137 26.169205613637572583 12.017965136637426937 -13.209868648648090073 -8.3999389207657362277 1.3920892564903630806 -0.91989936332590271917 14.901902107353528493 0.70773938550654991175 2.9400315978615587653 2.5064374869610457353 -13.350628862289010357 7.291077200442193984 5.9291820321693817775 8.8624836666624808856 -8.7550829958081735072 -1.2747250675613304161;-2.1876944096382660021 -9.9062264841401166393 -9.5112175261010438732 -9.4645788447066490079 2.8422880677144553019 2.3773511063347125827 1.820301033518114675 5.2597318214961292782 0.87763877932299871887 12.463853094636755614 5.0223616270097792835 6.5960787834040726096 1.3592629292496654081 3.6853229652353030055 -1.070779939229790978 -17.626712424248754729 0.73606373190714458055 -2.6623328565057469142 4.0276065013376207702 -1.1385427249409849626 -0.24008808117923230441 -3.521740613793362229 -4.598435945627957544 15.597919366162432908;14.823328584917426554 10.175240693972106953 -5.4505988485045655523 -11.708826865042100351 -1.6635642222566442427 13.11594925786733512 31.02864069240584044 2.109833329247181144 -6.4171417575249343201 -10.967479593375394131 -2.4971713390163570168 19.841724394353448702 0.35565248844303098963 -3.3581177566698801051 -24.195068649846952269 -10.686487593162810938 1.9975655825534253118 16.224766711949914821 1.2616358453953577801 -7.2614131476387440145 5.1157161671900883704 10.237634427528810477 0.26891675194749592448 8.3739446668342285562;2.9691387504793151919 3.5763529976724934833 -14.024400946375566335 17.060684790000081534 24.027302574586204997 -8.3453494172218025682 7.8020614619196688722 2.8807203497336697495 -1.9963796466352854431 -5.168272338154479506 12.101620919703689694 -14.621355961679386226 -11.121019588372952569 -8.0769713302622978546 -5.0846778718624463522 -5.0567541021582824712 1.4930588871402561413 4.3985551744461997004 3.4844798785810038311 -2.2258088084713554267 -16.253526989348582532 20.303143571608291751 -6.6631207182716414295 8.9914410136745779312;-5.8242935668843589525 8.4089411461113847679 16.757684389632110822 -2.718871631385242793 -3.0457075380091094274 0.44811347106475118984 -13.222872322088997876 -7.0452559445791758108 9.3963463675476877057 -19.483014629659290762 -3.8378017693137405075 0.42763274835329601054 2.7401110142629865329 -3.0361172426998712659 3.4952215689205190507 13.714392934749639608 -2.52368700286642067 13.147809439735775427 -12.287638381614975458 1.1838728916319818385 -2.3186584448654565804 1.9029485824418297391 7.3415055077208553058 -6.5807778959865208535;4.864931909176071656 -8.9453341700368476097 10.792837928449495521 -16.93738838488118148 18.758284487078569214 -12.665991195034637329 -6.3159739679537780788 5.2947335222538960409 -8.3878668276654622105 10.456310087322084001 -9.39444428307287005 23.497906860024176723 -34.877865126776910643 21.620441115010681443 -11.744446949615914733 -4.8411966014598952768 0.91332029508778611593 6.7324136601531350266 -1.9882483530590593368 -15.076351129030339138 30.922871752099354126 9.8754974156973602817 25.469382853778796516 1.6321507452973456065];

% Layer 2
b2 = [-0.23539516756330264302;-0.19358373297540232283;1.2072079160521858032];
LW2_1 = [-0.0079429446868536351251 -0.031846948802502876574 -0.024014405102739149606 -0.031205760189289950823 -0.0014302204797777950257 -0.43399447628271986543 0.040811832538747747079 0.0013263343024848576676 0.024570703647252133128 -0.044122301411589785747 -0.04304397013110378839 0.055533518907252887864 -10.538552867655637257 -0.0080626310444920010201 0.059252025697794100112 1.6518400722708124206 -0.040673779764589884644 0.03561599872968957553 0.031053546876252290793 0.023226224812458534652 -0.027327526348100938253 -0.18826834194217278995 0.06346177601935501511 -0.2514478813811780733 -0.056821054043876280393 0.019302757148061878978 -0.42088750829149618182 -0.039557089385032093154 -0.20660203535010232545 -0.015760852636160904011 -0.0095318136670991295001 -0.361747793703481757 0.066270216966769296407 -0.039273052328781435372 -0.041568232068392010903 10.436135699988543735 0.13325041053813635461 1.6300612066226523034 0.047479449029441060659 0.047896260641433242855 0.026374484422657818589 0.043091316482469201044 0.044267006964059801843 0.046414926751651854053 -0.013403992996301891671 -0.05432758121138475671 -0.04127657835643743639 -0.015226431602619485903 -0.074413065012758697336 0.049297689802337348042;0.1139447123003805018 -0.037420798666008038558 0.13904253485843004468 0.0093017814898491597841 0.10475662472997029906 7.590434448317913585 -0.053266953921417406481 -0.039190660258534869287 -0.033995993438470338555 0.014284697603999333901 -0.0020320618803943797312 -0.018115194535815063587 -0.030648546021262552952 -0.044209350196439636815 -0.011873305722715329219 -8.6966992201768800186 0.013456973500994423576 -0.055767910396243035309 0.0061822951575876330249 -0.066158525333917389544 -0.027532519341799087387 -0.042916457722359739602 -0.02696897391934082594 -0.005712554825363152719 0.01926711410653244444 0.13359435032052524583 7.5361842912824359431 0.083658764892438314265 -0.013564208538464544995 0.064895152731247476852 0.30311178793851845104 -0.020628656966811619033 -0.016152288732004672911 -0.025823028848307547078 -0.034992337778119698977 0.037964366339741283107 0.034266696785799632963 -8.6605328314156455605 0.016242261956492472924 -0.29336966861402541396 -0.0032746057467271487418 0.028072038247906418162 -0.039435356319193981545 0.035829460319559101877 0.061393074790109060379 0.0095903247808105350491 0.04216380641968373727 -0.10407504935386607814 0.032027012864873041775 -0.02744329463095853891;0.013685381387743878606 0.023021085982655193486 0.088105219144371568762 0.031807084477672775691 0.058877231428877324637 -3.440666706317144552 -0.0017154621552120676541 -0.013099012629656516318 0.061181091196520917541 0.034254247590817930857 0.045548437832146355941 0.012809574284899614971 2.95775906989569215 0.030887669116927612967 -0.11376552801417041949 -6.4449683650483882147 0.01233379883460119196 0.037579847647573716429 0.030339088101672018194 -0.0051973298912419679113 -0.030982860619798595347 0.23301391475806706999 0.10438122448938842723 -0.27203241800080718571 0.074841653434325833283 -0.049646641034625280109 -3.4597085893792289824 -0.019833478919576420091 -0.12287675796938488104 0.020096076134277995884 -0.0081458796167579727854 -0.35935937938669337832 0.033241743636415244101 -0.024342383420498471536 0.0049084348730848714748 -2.922941008242135208 -0.23666033231279873239 -6.3664963349828500583 0.11633106336649032264 0.075815623732979287031 -0.072063299343842021627 0.029296200713532005722 0.033099343548099992296 0.043961000626071958242 0.024919941652565738566 -0.023557184856029013409 -0.0022673624875138576051 -0.11571805259886458472 -0.078372968471788928557 0.02614667588122128461];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0579753468433118;0.0579849454384164;2];
y1_step1.xoffset = [0.0013069296719323;0.00083532556752941;0.5];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
