function [Y,Xf,Af] = C60Neurons(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 03-Nov-2021 11:33:34.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx24 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx3 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [2.54239246658578;2.18550444128359;1.94204547319965;1.79080860024571;2.36958603121095;2.02654095395715;2.19076486885549;2.19898428448164;2.5249672225563;2.13750302987733;1.93415484823386;1.78110972220238;2.34019409754206;2.02407513209752;2.18182249332445;2.19980620039293;2.55505042855845;2.19536773980228;1.94228318848817;1.79245249569609;2.37159234682863;2.0268697338938;2.19750479890329;2.19881991386948];
x1_step1.gain = [4.01260413458139;4.35131393457881;3.92208367056218;4.61302101526207;3.83889427390421;4.12696538740204;3.68674748299721;3.39934672915106;4.0272159832528;4.07990542399807;3.94442221713384;4.624222386205;3.84278154498553;4.15515523936414;3.70088098282845;3.50108242029377;3.57304242671205;3.94458279874921;3.54167094985342;4.11024484216168;3.40409517033598;3.75734732061336;3.38117830712262;2.99590614132673];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.1611538601396276249;-9.0612097100463184773;5.0765771929387017991;-10.077177525555381266;-1.5817703731299483927;18.119579663728355712;4.2295321648273116466;-4.7389015917998404959;-7.7178332734599788267;-9.4324718338084245772;6.3604047868520305897;-6.6496012719188657414;-2.3516261391424122529;1.5420369294285576345;-0.97496596741555940913;1.4690064736886372376;0.064571357341639074034;1.1248528523049481365;-8.0197246092487119995;-11.750582861096276588;-12.695472527883064018;0.66993303412351201676;3.3483775861275799635;-4.7904504541639578719;-0.58215275694110169002;-1.5082362235952440077;-6.6121538189412483177;-0.91190800610843969487;-0.7320694980774462568;-3.1928840522472645702;4.99049982427465455;4.6727533023086174069;-1.651212873164056516;0.4694111923049503754;-3.5272042788081052755;5.8670890576407810357;11.80560151318229245;-0.91326242898637288725;9.9366158652796503503;0.39834583879767654357;1.1777309218489411258;-2.1120917758512058882;-0.98179295373451358486;1.2613482935323687695;-3.7808503249191613982;-1.9740013925585333521;-4.0908297354540472668;6.8780332280780740462;10.846788915950966725;-3.4736641016180644925;-1.202279856879881148;5.0466826819058479003;-3.561504451902314905;1.1403490193467287206;-1.2483109475965892265;-4.9146393323956107935;-10.32561517381648919;-3.1060478758098302166;0.75036201317878870043;-11.718887219456236792];
IW1_1 = [-4.8401440180366197552 1.5215348224993547888 -0.35903082873311481515 -0.12097293803907149812 -2.0840978419657805176 5.3291354243059076978 -7.5366984237928296153 -1.1127394036090771934 2.8188985097730689944 -4.1571094910968628966 -6.3158104859846568857 -2.7142950037634352434 2.6440035582763719013 1.468606865305615905 3.0769442476609096815 10.185366293568662854 1.9406202951416686719 -5.1116264307753498386 -0.53438558736812846739 0.3983564633529756982 3.1311995322160508515 -4.5666516992291734667 -0.26061958361340542556 0.26649302993957429964;4.8064145080063394033 8.43539839961678517 12.054098435040975446 6.741416378085251182 -3.8648283542129817647 4.5937427264240877633 3.4163572694631763049 -8.8547159593597335459 4.8414911639759399264 -8.2410316469639077752 1.9793368346738109409 7.8382268027602259863 0.013681407174178539243 1.0106348844342187832 0.18109619092200368584 8.4078627557760672317 -8.5384141932861616908 -12.996757129739165748 -4.5538090244883724367 -7.4286516621683329475 4.9656664796574458975 0.26882978629097664669 -3.0388305939421038637 3.0418268106008672369;-0.34185493000673783381 2.8169608029050632325 7.2172153601594821737 -1.134433602153650078 1.0889743188057798839 -9.7556424488742212731 -7.9736497955973693053 4.3619393432730406701 -3.663600140183878473 -8.9540093320392628584 -10.496578447102962173 -3.9563085358131244718 6.2712147748423543447 5.9593025203405654011 10.951368183258782807 -6.9881792940571889616 3.0498330860747708826 0.33323700811575374114 -0.038651852160880309506 6.019512276034360454 -8.0170567346734049607 1.0790664605095752204 -0.61424556791219797613 1.2487064682529924742;-0.42506703069324214272 -0.15632486945713322535 -0.11014030375925606964 -0.18542307329801277493 -1.1832756637046348835 0.65747639754373399246 -3.1595669356786864057 -48.208833157232689359 0.60318755995633255296 0.16390558240848596139 0.54231338945035345578 -0.080655564635800647277 1.2188785729656368417 0.92712978261251488554 12.652165762884573397 82.850388322177010991 -0.070969401777615917504 -0.087360346479184461388 -0.60359855765139669437 0.17716768292791310047 0.1989615582377119718 -1.8118487613995879482 -11.054750543986237687 -42.575038385195398405;0.45644648600870152411 0.94019633856705642216 1.4352622611392984453 2.9734664721176589097 -0.50101818329616598646 -1.3061289803358571149 1.2914119059331159445 -1.2070278308822675051 -0.66939120813795016662 -0.65293286698750774288 -0.60634588167599490216 -1.4874747066912283877 -0.09350683063623203839 0.71788575325869796728 -0.83832595588385139251 3.5389157468400820328 0.11497616822967679506 -0.60976549034313587416 -0.96844737448024931226 -2.0524763377327919223 0.4679889525636582448 0.28941541683381888372 -0.64803651362187530971 -2.9617446871036472444;0.24826727937416814829 0.98276924437470092322 -1.2528282144866473846 -0.45743175134207297861 58.159605624227360465 -1.6747250925897110285 -0.28321744990926628338 1.1044233610546601021 0.1051425970327891507 -0.76782463706490533539 0.73335577478261904094 0.98619012209683831749 -94.683137465439230596 -2.8126608636137953035 -2.2427843766035819861 -3.7518284789533828949 -0.61068381616724987104 -0.48149586476606653918 0.71135602378494700027 -0.83398350904930595995 41.579061901828040959 5.5340521076276871781 2.6226585466373135702 3.5306661385055617686;5.3802547596841874267 0.89296296411924147574 4.2861867335788126354 2.1090777387182053637 -2.3971257464596864573 -2.9819738379700968522 -2.1039151629376511288 -7.4361901001305081849 -6.2792588497740329245 -7.223010233674427738 -1.9245223584893864643 -1.853467881845213272 0.37136899072897155971 2.2320741837861275414 1.033586960655917375 2.6248978765272350522 1.7637725569762763289 5.5537277382666934145 -2.6294367285853974536 -0.026173057229749441266 2.3340341025668918107 3.5578777187400882909 0.66114490640116241327 3.5841198261922895263;0.33824538734311399013 -0.053553527146236790113 -1.5511588127869404552 0.31673189307299515205 -1.9270657024474613372 0.77454472669809648622 -0.4441566131409453444 1.6349993558038571351 3.4576696893011149569 3.4219037184968801313 2.6242771908690532001 -0.32155806938643899384 2.0994182350657517588 -0.6503497659900951966 0.47918532913665912165 -0.75725639369515829191 -4.4118558244908507859 -3.5277720357196851175 -1.2899923745839561029 -0.18782284603107163301 -0.085487411777323135675 -0.093060138447294230013 -0.072182177081442228106 -1.1482133749868692618;3.6123022071866701665 -0.89285406975805770013 -1.0595277662861828372 1.1022844818690551438 -1.9605782253256731629 -10.863593637189406849 -1.1659927122874582661 -3.5860446164966761629 5.4519748109716390516 -1.5503757038228040965 -5.2507853038121350409 -1.4678338480064794247 7.6435963149310079956 6.5363445537358746407 -5.8623334350916209701 4.4703527051595441932 -4.3194960883248461059 1.4392357475854138382 12.321366960822413006 2.3765443684825502402 -10.295637489498366435 1.6326444502061057129 -3.776327159039478687 -2.3998171029789658881;-4.3939125580901308155 0.64074382728556245059 -0.63925726133812654783 10.395095871316968328 2.6176196359719252627 1.1468180757278139126 2.7758482682821563614 13.201489675811275859 5.0246254431677437324 -2.9917048039672868853 4.1606507585138903238 -10.413731683311503673 -1.5607159130290828575 2.4188975475825271744 8.0270917410155124827 -1.1126417192446100835 -1.4386815677881925613 4.8858270113295310111 3.2081329501794400016 1.3564321915724464329 -8.0480333361658136226 -8.7809458959834856273 -8.849351763949572458 -0.014105844151092450378;-2.2649835744733581855 -4.280544789153743146 2.2868965150891864546 1.0053150846037599564 3.8980241052066353369 3.741574389177725557 -1.9615747316976053227 6.1996500009526958053 -2.2395684852409161181 0.29402853448265420244 1.6449818153349136107 -4.0792017333874666107 -0.047307877567605793878 -0.53344521736929739752 2.0154466723936041994 -5.0861401277833691026 2.7394789884685883941 4.6557169419463670934 0.60205273410396831224 9.0515510085340480373 -2.345744288055257698 -1.9620333187102350081 0.21561600141107725714 -5.5534739044997856183;4.3287835361813797874 13.780290471393321639 -4.6248463738628764474 -2.4544960221504532605 -5.5151651535434256246 -4.2304533213959087945 -2.6466952130781398189 4.9628124132885504949 1.7784870318113386034 -1.2946763393345555038 -0.37267010044165149729 0.77805814608138690325 -1.9670899361563982666 10.268071865854128788 4.978315113925050106 7.799697972019271397 2.7865785684769468489 -9.2724532460629891517 0.94051955203133053018 2.1859171153590928327 2.5377941342830121485 1.6748296807556721788 1.6951242830088895097 -9.7402466762415329526;-1.5456042751657670387 -0.73738350668641805541 3.9035504664414135689 -5.7539941029941052975 -0.41158954947126102919 -7.2067918890323525716 -1.1589316871613601911 -6.7254599657100841981 6.0747762724573011184 3.4266370511221859729 -4.2207614690852919281 4.0542363867832476032 2.8261233708730411074 10.16743633614829001 -0.27381354459441487048 4.2999691389610470438 -4.8259309592569410441 -1.1015356976160142199 -1.9591207241972377062 0.83161387620787741159 -1.6903535558425397678 -0.14539133874182688655 -0.61485137434045378235 6.004408112010430898;-0.20184074524438072595 1.3938384337399469803 -6.4145505404967622098 2.9506244069984122191 -4.3456059639859105914 0.48438225902092013619 1.2093109870598981459 1.673616416098168358 -0.036788655343686943455 -1.4485576516924727475 3.7703526994516374238 -2.0955548794427798498 -2.6610651726955474317 1.3545602481928040728 -1.2361107802159152502 -2.9477697934100031141 0.4456871364633108179 -0.76135423854517869646 3.259182506948619551 -0.99975518912543936967 7.076297837573573446 -2.0675194474613496354 -0.064900680546523759062 2.9965400936523418629;1.4870770379177258302 1.2449932528557003941 0.13851909828106551137 -0.75567616398329373606 -1.8930726262007353533 -1.0016887550979520771 -0.26819818913821735773 5.0599586354525154519 -1.1881059233853379364 -1.1621838479382544662 0.082525064296167863209 -0.13464906286638100852 2.1328043838632742002 0.74947428429442786157 0.36800817470144775445 -4.1258110480076988225 -0.85750822063155796027 -0.078354528363657943713 0.20690660996838028396 -0.015765893025003599459 -0.13803493131000202365 0.60173315155035711488 -0.26940036291609203989 -0.55758502100337725693;-0.3921971428176537211 4.6881035910528545685 -5.6707120650324460698 -1.624385030452415446 0.87431554872878991524 -7.4007609044913529317 -1.1104101896627676105 -2.1612821306078529027 2.1020872386297981826 -0.25355417548389930227 4.7398881325365023187 12.082095086391342775 -0.37225741611921281393 6.7464236876605010451 4.5858896373782220834 -0.99937599271036570148 -1.7574328932624758703 0.12602641196230171539 1.4710292720752953244 -8.8243457267924956255 -5.3197772519330150942 0.81134195872468406474 0.48827048509954734667 -4.1915781178005913077;0.81400497575360419855 1.7905416810759562374 0.30483627904191146207 -2.7734395573577597105 -3.4860850354097050463 1.0322961060048865267 7.3019455635179335573 1.8076482358286498631 1.1566953355195286335 -0.49295906105208286974 0.14769061045266312915 -0.65379605267936791169 2.8727131793530999992 -2.4436899434270418219 -6.6851315537319404569 -1.4629473311639273891 -0.91305777442996549631 -1.7753054857658570054 -0.70970383978472739717 3.8281504117925910791 0.03951342885753787032 0.48115588582224755321 -0.92317980909364405484 -1.2614903175119307477;-1.2261987559153064709 0.463535428476192779 -1.1789503963076550797 0.83219337053562170148 0.18431984992217759212 0.59076938399209066866 0.62842465541244207916 -8.0837256185841876999 1.0189483355605903903 -0.17157072697027536679 0.97949547087691291036 -0.91439996107852972163 -2.6688068565787279596 -1.6711068994174367308 -0.29530907832271330316 4.9779195174768871013 0.46880278618877324615 -0.30357510579559593422 0.44340482149116006161 0.093212756010877376167 2.6379297545708331185 1.0595088811234880666 -0.15847395262051078291 3.1437620498217100362;-2.4474618938723784467 -1.6465929358843567343 -3.8914203884696236813 -15.990780736763376524 -5.3263976336283267443 0.88077464756918022459 -4.9488018628074605942 5.9000200303652663436 5.2897767196558636016 -0.25941679658784533302 9.4103700996270589485 13.655990243760951941 1.4469464845381179163 -2.7588216078629983485 -5.2877688922913304026 -1.5342220926032503758 -7.6982723433698563298 -2.4446139568504392514 -4.8176312593482393254 12.683635475148516747 5.4008912766194869803 -1.0834745584504352767 0.85618925305744930654 -6.267922276688016936;-1.8962951106937744328 1.0540530227980071665 -2.5796897390620614487 -41.277328046879873114 -0.95926089235841893732 -0.42430898999846838882 -0.17853785563393897995 -0.75505276033370360977 4.204151065759127448 0.52537091845020644776 9.2838727843369781567 76.497233281255248016 0.68537414404252483546 0.16169868280244700798 -0.48747598190355023728 0.72323568294660955935 -2.4869021345853736804 -1.6916894166965541491 -8.096458389517176002 -40.51923379449637963 0.37620229423406775782 0.28069393471013481811 0.56097196607816823821 -0.32161271157014847955;1.6063211517569773168 -0.68049222165376910265 12.904216399729822484 -16.034086832341571949 -0.84337079489283417466 -6.1254287291236311219 5.1737096343887198913 6.9504588380595819785 8.3161851844186216454 15.52262079935667316 2.40603445344817235 10.603360371773629112 1.9780185598813431191 5.3605632344645064435 -0.78951704713292913951 -3.3066937806511274012 -10.924883589935815209 -15.835030712580449475 -19.334612530222848648 7.1394329219741061721 -3.1231467236279679689 0.18136107116261845906 -6.7034037709842877462 -5.5260029565630235382;-1.5700327403124165748 -1.6388503314351408058 -4.150790976609505023 0.48793304745769655595 -0.70453558615708500312 3.4153066569470342806 1.1934131569335413303 -2.2941881823436505172 0.84104369811812873525 3.1508035572294881277 -0.025749143620964046186 -2.0835458278453025116 2.7263499170027163387 -2.1220007452525808667 -0.30775245881868812381 0.1158408848927842405 0.92613344413368048347 -1.7495180869128454937 4.877611892143354666 2.3071890147571076923 -1.9900158049096352553 -1.0115475630809631635 -1.5983491566279346419 2.7140296917299431279;0.17965285540972608658 -3.2457621417095472438 -7.847157076134646303 7.0033014192900422401 0.47509643657960654028 -2.5265131783639320773 5.660857601529504457 0.44405549624162032885 3.7151196794320977546 5.215462230230857088 -4.4720081023297115763 1.8407133621449616179 -1.6237925961861030544 18.8926164995017416 1.4415266043458432321 -10.553809702105443336 7.4289201368950221749 -4.3423572167636681485 3.0360200462543041056 9.8003563243505755764 12.38283870671511977 -0.83933944798472692739 2.7541418933111430078 3.0615999431457963098;-3.241100301746575596 -12.772076823096023546 2.3577206569819009196 -7.1759391349650103464 0.72066035254227167606 0.42763469504546286482 0.44253193698611037465 1.8802455043075849694 7.9556834056142093914 14.369193553400631203 -1.0890529871842624665 4.5754433355889672086 0.26792944123382078647 0.053960371871240420116 1.0466444535711911801 -0.65024774487221814745 -5.5236411576908199805 -1.4138665131973313649 -2.4361546499451955938 4.1691774936324552669 -1.8722062594705775052 -0.21612196539512551485 -1.8657295623267775575 -1.3505949799587320115;1.26770547893829022 -1.8968984398892352328 -2.0881789174761875572 0.46155278814018635414 -0.62468913681788995618 0.57489062170611016089 -1.1970878553606649763 1.0378809028063820108 0.85749486792774576305 1.8569204445151710203 1.2488336283966003926 0.54552919540590594227 -2.1731550356741022867 -3.935083748265229886 1.558161324651630153 0.97116654454954232101 -1.1448257295824557644 1.8803359713124643271 2.3502982458397325694 -0.66489942914767419246 1.6547009113250614742 -0.17271676683609046843 1.0802014650330258316 -2.7541253119529285343;-0.96041988841649161834 0.53428458880141194154 0.69375734012013223762 -0.48086374280127680558 -0.42684488399890224697 -1.1827051249911300079 3.4757251279688428092 1.4174612514001871943 0.68886785940462158528 -0.29718633625848139834 0.020326159551247710566 0.47929790255875015514 2.1265414707613157219 2.7748931340864517736 -7.282290890793273519 3.9218120434970695776 0.50033418739235968609 -0.38533022717306963933 -0.67272623457653857315 0.3615279160257204305 -1.882513917304025286 -1.9736805383572235684 4.2516545668945111558 -6.525144560069834121;-7.6763518486908672855 2.0729809837459773902 3.7730660701378342381 6.3482349529583954606 1.7133914931048979113 1.660290705674613676 -6.5225483469669010006 5.6963324903940941724 6.6751089231523632606 0.48335618998963258974 -2.2334883097466589064 0.16636757965842347007 2.7856731899823294896 -0.16833237034486636663 6.8372944398712895975 3.0712082603080181897 1.8794477639068356556 -1.9219619414867104013 -2.3845651006955517204 -5.901139573785662229 -5.781017472292345083 -2.7941082677380264521 -0.28459591051186766686 -12.992739072206093809;-2.4829833182251950241 -2.9732382868661400011 3.8082540424532584922 -5.1632172288382758296 -4.2667190761647049158 5.19278360974406894 -6.4985708313661749713 -5.6696077599283070114 1.8814174059960362406 2.4820816456816090501 -4.3493683024926141911 3.0235484799945955281 6.2464374315291069095 -4.7846152430526158739 0.59390111794098998654 4.8774150693065880802 0.73775681218858768506 0.66291847227014977229 -1.2251056126427759541 1.9356173918698724723 -3.0944961769654075745 -1.0335263256565832002 6.7685989447046912559 2.1367129409925236239;2.0036461896458561682 2.1556005548124534954 0.91732781421529807631 3.938931638122316059 0.75473305993448802642 -0.74364111472148208826 0.67734919647709346258 1.4744007144373141305 -3.0337456700903895346 -2.1899235615157874868 -1.7438626705731519184 -3.8538875791672615456 -0.76843721953342691844 1.4941925864869054497 0.61595212361927031974 0.60628396156661723548 -0.42203616904110530239 -1.4194089853197779938 -0.11463227177924054101 -0.47819919117354636739 -0.53485154756504260654 0.35753213121833843369 -1.4644110287839389173 -1.6402918029674067313;-1.6520695297586565076 0.69391412196053758876 -3.7216334540863966751 -5.8330014330998070093 4.0003973266023162836 0.095252779316750538219 6.7528839154065662953 -10.718128786671847763 4.7293797404969675213 -11.038774005650235921 15.6323211135246396 1.9707004706281183726 -7.8340315351846268044 2.3130606013381176389 -10.617267185785152606 1.9609390560383159752 1.0587864843537087012 0.69098426396111589654 -2.1913417764134139887 -0.069364426194117978497 2.7184594187129640375 8.1215690455755602528 -8.3393417973496877238 6.7492159791583281603;-0.034593949329312478902 -0.77026610251887284164 2.9150154007362956143 -0.26331585612789187856 -4.4876417964783694714 3.7983436336230789188 1.2905686439837151802 -6.9976813091714475945 1.2607646833446286561 3.1805881951298897725 -1.6048806436326135128 -2.5910232649244102632 -6.0316637309390372934 -3.2610873178970885 -5.1922661650040611292 -2.1935692272077234044 -0.64822054028974063211 1.1771409146674860491 -1.2393232454511624585 0.80455799051907683772 10.867596483021975118 0.6224880536699319844 4.7895007626452397176 11.793855400013567802;-3.1223051419273550877 -1.6771275799115485938 2.4280354151268737084 18.25281392409286596 0.26134602823543978678 -0.14602282649471429177 -1.1516548667621540059 1.6646408774790628637 7.0006897691195231204 3.9267273736565946329 -9.6636147279141599853 -43.666812565672593394 -0.19657876408892310804 0.1912800972200717764 1.3269851810550692406 -0.94114573327373651779 -4.7970719320998425061 -2.565094101307526131 8.7379220054106845339 29.354730827811437166 -0.13662911942478939142 -0.066069290837222544033 0.28519329700862622312 -0.44523727926129663679;-8.2181985854241297318 1.677754450280704912 4.3842133680242643123 3.2738153165060088767 2.0472731039584424195 4.7526406571001338364 8.9146803787170920685 0.11321029119307610133 8.5612886157208478721 0.22920976908357776347 0.49636271181901003846 -5.7002911186022071632 -1.6202963414237225859 -2.7221451931921976097 -1.8241654984318005361 0.75600367457502182233 -1.7936720399063554865 0.98645422516741088081 -1.934922064608941783 2.973462659472846159 -0.99595505242591708672 0.59785670813279345737 -5.435066191582822448 -1.4413243389910601611;-1.5012133402897902545 -1.1475677556320618145 -3.1102503045504321655 -1.8105341293490821997 -1.2623923288276130972 2.119482148337678673 3.8656067795390174346 2.506279649910405638 1.1938676331164270739 3.970494483281889142 1.5856259540236812278 1.6470886634596391129 1.4762586489729911943 -2.1755575203214521096 -3.8555278529722198932 -2.0158799647045548831 0.98442572521307791789 -2.1748860635611073633 0.51615324964772546501 0.26091667862821021906 -0.45880323268138284432 0.063620227662432721205 -0.65514318598726173359 -1.3354976723725553445;4.7595275822006533062 -4.930314654132337715 -9.6571241436510302236 8.1249592522248423876 2.9383203376552753383 -12.514593146223617737 2.7391229000094936552 -11.346940905805722011 -6.1884910038929890064 6.9449319207550139765 -3.2881909398600539518 -7.9283004359653403981 -4.7079222583684545711 11.40720044704556102 3.1220849325949244779 10.731011074495082624 -4.9068820540398716545 -2.7146348887721485355 6.8728187892140670812 -0.41108971235524566223 3.9353565191383923505 2.4006647577026356544 -5.9401399312660050356 1.2265613143379645589;-3.3014567535006373866 -12.472587464138459978 10.118465336497223461 -3.5076289468268071481 11.251192200336722848 0.56825948554032068571 0.62926553054131495468 -1.9976935318087494231 1.0725698985015830189 8.7664013854018456584 -10.49951752917793435 -8.6221409816885685728 -14.241526615667627453 -2.5837054559120935515 -4.0583267874613175863 1.0517292362942547435 19.503859884159240323 2.1513313418704482771 -4.6576784433127738083 10.274780811781823786 1.3720454352465301096 5.1047106149289680488 2.0586008033034897124 10.553147069719820195;57.030754554060926864 -2.5766831003702481695 -1.3970041349253690122 0.24821883709204692336 -0.78198610870208895562 -0.21301701115560836564 0.5865063573996247559 -0.33169663119809345009 -93.710174785717754276 4.7284275024665998188 3.1730996331714922398 -0.24404541026180925911 1.0075145117975452536 0.13981503503418354906 -0.34625713125966078865 0.24062081989456451936 41.905773743196895964 -2.1841920558010099462 -1.9491393480785659253 -0.0021159340516679128741 -0.2229202954849028584 0.22753912335866727235 -0.19720941747414760803 0.11904080406480524457;-2.8265846338310498531 -1.4263087244185341795 3.0407510446312917551 -5.2278692274265825546 1.1078039508321193551 4.2440563555090911052 2.9684972871400843175 4.6287044120970399774 3.5490031991961612512 1.8716504757807650439 -0.78244683630033240451 3.0678333783725113548 -3.9570445569843539779 -7.1396560411859519846 -3.0731712859377089408 -5.1006960715890690139 -1.7939821161588445086 0.67390573846034751426 -2.0625928942675506583 3.187425571504109989 1.992399191529675484 0.54240886644868080424 0.02811493584100023535 -0.30755426776103744757;0.41696096030293927637 0.13709502675374321545 0.11403123278556345777 0.17403649766949416677 1.2774406787508905126 -0.71919532593386203967 3.1516076576153913003 46.800435990729901903 -0.62394038660954409536 -0.1614997746487942254 -0.54407263522416393631 0.080891759098249138571 -1.2797663821671678708 -0.99300533948089297898 -12.728665485617886688 -80.951843391020375407 0.10006491938538726594 0.10707133922478512256 0.61178994075324688584 -0.16332089683001127511 -0.23685074618967894011 1.9677042298406846044 11.160841600873688151 41.965172429159046885;-0.089917143998188980847 -0.18083615622449644711 -1.5792405919070129361 -0.099426346466373410893 0.84912743867226325722 0.30148392530692419422 1.0893687103572498032 -0.75279004608053678993 -0.35471160174553179045 -0.56368871331381953382 -0.063773421728232471128 -1.0588996636547722829 -0.39729487924480638705 0.2250695311349025507 -1.0075683255623979484 0.72657418813738683383 2.0238079709215219815 0.51909214027558336912 2.0240681521295127432 1.4539077196393705993 -0.78101349897093830243 -0.17433012272018644229 -0.45832294040008114688 -0.3180243628249162513;-2.9759591067186308422 -1.5643854851773224546 2.3006000155809922525 5.0616965827278539436 8.6225239659753150079 0.13001633241612520209 1.9918084681336929442 6.6516659908248865207 -1.2911943253948292565 0.45247567884592942988 0.25334867956932133337 -4.9542612219517065952 3.3774535420279683251 15.196405560967248149 -7.8927070282521354372 -12.842115578114395191 -0.94652389626435096126 -7.6946716560844938826 -10.17177508246433959 -6.3105500644381926634 -2.6279361301802199868 1.7551851688710988775 -0.58954988591368495676 7.3313776995604005293;0.6525103611182625496 -0.39649500632511752718 0.63808423389990376329 -2.1674410150015801513 0.42676895290124333693 6.502563990218239276 -6.0771084816658484939 19.448975136609281122 -1.0254486527586801348 -0.0061365259268518247693 -3.1015374145849285981 2.465422321778331316 1.4240615558743650038 -2.5891960944073266759 4.5625821516171676251 -12.808487111585606044 0.24852625956114254846 0.49386217616550498466 1.2543998418738135925 0.77976710331196263937 -3.3148411870464586926 -4.1565204927250398725 1.6572717056610801745 -6.7465305382489244579;1.6829340742907350492 3.1309343925069192949 3.0259606344974274705 -1.5633148700101129336 1.4961762567539795832 -6.2639518411614281135 -4.9099730309358529112 6.1487425726534779002 3.1813518766666981641 -0.37515026710829046941 -0.3534808768137817081 1.5003168431323028464 -3.4284691215995848346 0.12953383161505205301 3.5422033159546231218 -5.2364670333469129915 -3.5564362020901119088 -5.3450637173942947555 -5.4541982521607312862 -2.2867340242347111712 0.31691451097001072101 0.44447392994029255586 1.3868899209737473033 0.36924094869518264694;-1.6209262626913538696 0.50044366141965912487 0.68164720340984463753 -4.5237356349479425077 -1.5047415043539611457 -1.0351362702960267281 -1.9267443159807082775 -7.0009310128072392843 2.2935314430005062647 0.53326019863848961311 -1.7402245338606117109 5.3538156545110613393 -1.3699133933760205828 -2.0379671374808610018 -1.0692620578878777593 2.3390509487032145053 1.2672602939669193045 0.2697894314708614294 3.5631421291067240098 -2.0273897446808817335 1.7415879486503811346 2.007104209887903945 3.8084155929686320796 5.98312775515924411;-4.7417430258350776739 0.06991670269944505467 -7.5930382611832980544 -5.3292898011101303979 2.2395262804801756573 2.2615934277732669955 3.8114681635890681477 7.7916779390035166841 4.1859789934886846297 3.2124585477391871535 4.7867498838720647925 3.6521758282908853843 0.20055503161624821384 -0.59773335066534971638 -2.4336268457237504315 -0.18305181284554034038 -0.62569995742279371775 -2.6338452181294371712 4.8777969656323998393 0.27249068276198734617 -2.5678672352635705245 -3.8760724888770057284 -1.2353076721894402645 -5.9854300409106837577;-4.6589648082514472094 -0.090315073412037510936 0.99978568736355977187 1.1677346988612473666 0.42377421871401543818 -0.67529811220052105014 -0.18727029044277529457 -0.83998009334870493703 9.0454326809642733309 0.65963010492229423587 -0.67518602600176236272 -1.6272718678984479102 -0.77845616081144475285 0.42330604750018224758 -0.25012491113307089297 0.68355199061299987129 -4.9866145156596468624 -0.69215711223992426593 -0.23914825493065861028 0.20007231146831838675 0.46999121961527268176 0.33616992874214690623 0.54269904722105677397 0.097613426580942463939;7.3278694743635011122 8.4411430253501116283 1.3083088913554001831 -28.415023984382905553 -4.6315496140596188468 -5.4568848294623109041 3.4981600503112018075 2.5506332333002474932 2.168989287981744063 -0.73997695253468398491 1.6504627414386985329 5.781018646127723315 5.6116134803628083816 7.6165143540676911726 -1.3287335611926194279 -2.2805009265506024363 -9.1053327202361806769 -4.5219159972300992933 -1.9696843644628152514 22.558383629568979245 -3.7096490515449578318 -2.7534117665372490613 -5.6427426576125938595 -0.26612635454338051666;7.5702956264662955022 -2.1021267220221764305 -3.8050862106765732662 -5.9996501722142188129 -1.4117998083903537943 -1.4872833337185937808 6.9334299704598887359 -6.0978191149662395176 -6.5375472272479271396 -0.37287665081017873359 2.294007965709888186 -0.46398159798603988424 -3.310258591325336841 0.13691656212016933836 -7.1705163452273090741 -3.1906388600277022505 -1.8640293011456354755 1.8309834791767984896 2.4564815578634586757 5.8438451301407061678 6.0348756025400209779 2.6480488674023985318 0.23550396773473841749 13.664399374442163904;0.0069453886022535354927 0.74132004719780975055 -1.1730344325781887349 -1.1515108900515258483 38.728087613643801035 -1.0506882394606709141 1.4949856293803676088 0.61859165646803560001 0.14546079050438825986 -0.73540423680496769254 0.84534954710915577447 1.1583473249503508651 -63.722670320404560584 -2.9678614607841700135 -4.9662266346186134669 5.3387934399380476691 -0.32580656947462682815 -0.32782108603526105561 0.35954521684344764587 -0.15639506906933156594 28.413070208549527251 4.9103201560845119999 3.6154145663271095579 -6.9881583295362874608;28.20981647527945313 2.2580690060676928965 -3.3475784007825879485 -6.2516103173975245966 -0.04346815893594502267 -1.653566188386870639 -10.517857814164147001 4.2200915913756382736 0.44183597875616009709 -6.9111079296026156626 -11.51832755916717943 4.6410974845019854484 -0.79545245198467051662 -0.69602558257952229503 8.838423233164787618 8.0508147433709495999 -35.186868820979036343 1.9397196747429612529 13.288891386091425062 2.5495128957653041546 0.79415946491802291707 2.4625482508904887879 5.1365439737942066856 -14.923206042888374157;0.48221120506804210359 4.5974626897162238492 1.6853848575182310832 4.5182077496605286271 -1.3258748633328640842 1.6189586535495879005 -2.1351910164598622011 -5.3406086683890245936 -5.8575129431445276396 -3.1667636330794888266 -1.1737799124216605762 -7.4773004670108731418 4.8177605980056217305 -2.0016821826768951276 1.8668773365832651567 4.2021386238926146106 3.7353805024215991359 -3.3438129925383361929 -2.3841411299035875082 2.7644360890199362046 -0.45582102818493630547 -1.413894693098810551 -0.45562909192499290167 -3.3752557492622843327;-1.6411817719402537197 -8.1644657798772914958 -3.2326874932351916669 -3.8117820847978531873 5.4243598181178995787 12.22221870022000445 1.8109483832444521756 0.91471057745311989962 1.4903848075767003323 3.3345057517570828587 1.0462103163866689481 6.133845919103279698 -5.7633655809101203005 -8.8950677467920087338 -2.615396982030083084 -2.7812046756792039304 -1.2367146451063590895 3.4284460250192885233 -4.2187910791926164222 1.8617250873697033242 1.9004881945823943745 -2.0110784226484192949 -0.26474031846995538242 3.7084718898938238141;0.53495044529347757223 1.9396730895038309939 -2.688948151521288743 1.4916711444824690691 -3.3314965430680274494 -0.73891968906623273217 -0.87762913166764755513 3.7851247167483546008 0.68371463847224056565 -1.4680821143630218284 2.4637054825937050317 -2.0757543681737447017 2.819227229453502126 3.9450202249059613813 6.9325883844209261753 7.943640630060576413 -1.1507491246970686927 -0.998913211521415767 0.41399135297975186987 -0.20060857576419660608 0.65875581903450386445 -3.2252322814304248411 -7.5450123584233868002 -14.498498201969210797;0.44278755055187801748 -0.16059047751959837358 1.2274768154632913486 -4.0602309267593197362 2.1711256422469444871 -3.3703889542497207366 -0.31577066990929225643 -1.4171667682219875051 -1.7966905626398022022 -5.5527460297239530362 -1.5657879501969527158 3.3992065198049159491 -3.424757199436347932 2.0280679808475814419 -0.72902112219010073435 -0.58571320368472035156 1.9353087589681696734 6.1632632489795566855 0.11591467995561033355 0.41393119639619907479 1.0165843446036515463 1.3282593464658538629 1.2165256173573870679 1.7932846863409279692;-1.2316496641488694497 0.30489286051455311011 -1.5076234742960752389 2.8997239958953517913 0.77251766065915328241 2.7223787128417065162 -0.49640722791833535865 5.6654325189321372847 1.3853526343643516316 0.18515743363271819355 -0.46122573705192548843 0.62820974532824169767 0.19586977282155004776 0.31609333896800795305 -2.5005126438067546424 -10.071890817986410838 3.4834614097833465074 -0.76513602573116346051 -0.11935393456481874219 -5.9127673190765870359 -1.1600661895760631115 -0.52464655056661557708 2.8341371212563966075 1.42362569783290982;0.61439015758871873274 2.3725723295590817052 3.2092350511011851211 -10.754501111489741305 2.7531264710337328694 3.1953321620024643934 5.8838117967710568124 10.946120630449563293 4.3565346012257126773 -2.5638232518731438603 -7.7603267189600844134 8.3008403324495745323 -2.3001360887462705129 -3.1727086568277975687 -5.7031769017149107626 -6.4418278678465359377 -4.4095308495168499263 -4.1925800833114337252 2.4156454189620317763 0.18166675562537321076 2.0195117656247765225 -0.093344548057443299527 0.61117117196775694321 -5.8577348112997826846;-50.943891531151557217 2.2783939466996847578 1.5512127430003934681 -0.45223033139482915477 0.78423619371339314821 0.056042016176464093391 -0.60670729485235452838 0.13857964850253529088 83.123433281705743525 -4.6270352648943839924 -3.7188495239401233583 0.59356279832741365432 -0.97885867302566109682 0.0068174343705177803399 0.37929394186326143013 -0.12062788427326662233 -36.77655776331161519 2.4199543868770918564 2.4339285677897217752 -0.15558644326164788874 0.18404941237496405537 -0.19558030329616632459 0.18822853540134454331 -0.0097325567025157086465;-0.25882874300233554843 0.55485543117757496479 -3.1668325689528566969 1.9292798996463846883 -0.35395409011431672175 -5.6097882875101481304 0.73869100721046232483 6.9143755647672273668 0.3942479704627877557 -1.2737695002643301123 5.2240685426429589455 -0.71208290239536975452 2.1609752707713361097 5.0014355346960490678 1.3681078668505788354 1.0047502314334546547 -0.73897357049515732808 -1.4389274912870153589 -2.252042635065576448 -1.5115104411949813468 -0.84915675075379304371 0.48010393535798867592 -3.3971018123122691534 -9.3481529101157594397;0.84667414267761675895 -1.7978090334161589414 0.71767941394443468539 0.55376720294738046579 -1.3490668510331473851 -1.1982923892353480877 -1.3148674113186034074 -1.6931776529611117788 -2.0875827720743789229 1.0519397063232509559 -1.8488554458785408929 1.8667213945829568278 0.73834375627302417655 0.19056518459190860404 -0.23663256284406733454 1.6320295122591779169 1.2540529369106614421 -0.36227977841200892373 -0.37999026488114145961 -1.3623396604963884382 0.76646025464036549035 -0.3550853224267622732 1.0054837223444286209 0.14046345289632911069;0.14371716156201311265 0.26218822404328245845 -3.9383314382049561253 -2.5424537648271692269 -0.90893996798934517667 -9.8726499117926831417 2.8100004372561313559 -1.4845417302825965056 -10.264218823320774732 -0.44890289883787237724 4.214849607733034631 -2.5390236378343979951 5.5043578162215931471 5.4553503486945977841 -2.4001573436021601538 -5.0820658552701098998 3.7046280620745082324 0.21220645171732305245 -8.226910310611444288 4.35322952768904603 2.6919585599453572655 1.1404921672754277928 -3.0718711031445971038 -6.5638810177739381757];

% Layer 2
b2 = [8.0623473179045657133;-1.1597748285636646504;-1.6368731931072888486];
LW2_1 = [-0.022362855769740105916 -0.071227158783452676483 0.056098767970386737014 0.18620854339295656033 -0.053875253584390589423 -0.008276507129093198592 -0.21028288024957789148 8.0543836237340187267 -0.037692225322421571421 0.027785820838469237753 -0.030075000203167286117 -0.016163424681841863373 0.0058563061435829887394 0.0066519403913866265166 0.18651751964427190633 -0.0045874462516108755958 -0.1003171581969624776 0.10530794065838505746 0.030105471133671232037 -0.55322136374034780459 -0.12857130380679482329 -0.15967119709237242997 0.02189227409546738029 0.16758190614401161089 -0.095558608689944729564 0.050425441963147070445 -2.5247019991791503912 0.013978214078437533469 0.028684642601269540879 -0.031318609238404820916 -0.051034111792417548303 -0.59533340405330759104 0.085452679499569306198 0.164848655358790952 -0.021760712109421521954 -0.021260564784003996297 3.5146782858049325782 0.033708975661239801158 0.20029751547764390596 0.25464557275097199351 -0.041922706958340549832 -0.013300482005552028211 0.017156625616192168471 0.052805547429934610038 -0.17718431960852648599 0.5896952585029973104 -0.038643357762864573302 -2.6417588723331251188 -0.010850104529552598992 -0.081600484739571627069 0.021380340447202658 -0.0058223367387727816696 0.063310906005564868138 -0.16286359847119538657 -0.0091344124829468732046 -0.085311441688664155225 3.4066905994559260051 -0.00030644106052482144448 0.14942909970541154441 0.0042666199497306579735;-0.07056765425545270809 -0.01106566832248838568 -0.042886488307531070441 -9.4813377188985885624 -0.53206062650205732112 -0.90334077957647862522 -0.026691895844389957465 -0.68706946729499374094 0.024900472834903389363 -0.071125712148387323919 -0.08626281529479018495 -0.084831244525419860492 0.086273367437272457936 0.14854730819264355679 -0.31199569522312048386 -0.059518861105178427762 -0.078899218200788670541 -0.31554429309928949676 -0.032028160170750163971 0.0015363650658734809718 0.040256423987223621808 -0.088609509799807931185 0.032995190015480707624 -0.0085060166662800015813 0.013671857833134948984 -0.5016014180977640402 1.4061386003656863863 -0.094882528901224866269 0.19931884086635404119 -0.014365315928757414754 0.08859150279366274916 0.0192669969627304212 -0.03362487241974166513 -0.0061705922340238028578 -0.060104281300554188161 -0.033488256460533667724 -0.12117130991015663544 0.090538216557133857632 -9.3615495677817524012 0.038601653081562832537 0.0027179976401871782168 -0.14111236113934200187 0.044401484509687942637 0.12633370836109936164 -0.05930901367284192871 -0.081697880714262316459 -0.061249284323698596766 1.3963289990973772881 0.86545405931774266328 -0.004383359233295988297 0.067563302980770442718 -0.10166879557929574263 -0.24734841987043981737 -0.035126257377567110529 0.044330805730733217895 0.0046701688584003687305 -0.11390433617349421391 0.17006516828575299338 -0.15320878993006448177 0.066305362392280492445;-0.047943449382302265327 -0.054964018691409391448 -0.097311947070363696843 0.058193669798707506335 -0.44263254432069776279 -0.24486779886560494646 0.14445333075609012585 -2.5237968058574389296 0.0045078663466970383955 -0.024281744346618217706 0.059986301431695011888 -0.021396239897638599792 -0.0067716249555377361347 0.016185465178846822343 0.57681591779070306991 -0.085457200980119302214 0.0046610439349266345049 0.46051896302468836586 0.05728686592120547233 0.20869803887315241386 -0.082759657200076441885 0.021802062069472070982 0.015653881002319090798 0.032258533206876473243 0.029896804278112074083 -0.038733450897376217603 -1.1346252889719425916 0.042885682722950430046 -0.11640737324526218011 -0.054856709870664099871 -0.016753883947027679163 0.38440485067094221083 0.054930996068671265886 -0.2524840842008051478 0.12344122146498855142 -0.025074059107041472144 -0.20082375538946128923 0.020144649113114625888 0.142505682913578402 0.26079073865801905008 -0.021760545097781944929 0.15909466130492955216 -0.12499708386521085623 0.088679286414087885038 0.099503383369426823268 0.26849284806869899711 -0.0019900564460204901024 -1.1083357744410373691 0.20390021696511814731 0.015429099415572833029 -0.00091288072833453116905 0.037804382197228883489 -0.046018505018319749711 0.48813990842132676251 -0.018463783428770648432 -0.012291488892855119419 -0.55779889358240153374 -0.0011376735024401438134 0.23603733995258133205 0.072946871163971152563];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0579926088101154;0.0579822738756291;2];
y1_step1.xoffset = [0.0118312730742907;0.0061505913949057;0.5];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
